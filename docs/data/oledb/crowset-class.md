---
title: Classe CRowset
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: 2be4cb1936536b68aed1f8ea937f6f72904c766d
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/27/2020
ms.locfileid: "87221517"
---
# <a name="crowset-class"></a>Classe CRowset

Encapsula um objeto de conjunto de linhas OLE DB e várias interfaces relacionadas e fornece métodos de manipulação para dados de conjunto de linhas.

## <a name="syntax"></a>Sintaxe

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>parâmetros

*TAccessor*<br/>
Uma classe de acessador. O padrão é `CAccessorBase`.

## <a name="requirements"></a>Requisitos

**Cabeçalho:** atldbcli. h

## <a name="members"></a>Membros

### <a name="methods"></a>Métodos

|||
|-|-|
|[AddRefRows](#addrefrows)|Incrementa a contagem de referência associada à linha atual.|
|[Fechar](#close)|Libera linhas e a `IRowset` interface atual.|
|[Comparar](#compare)|Compara dois indicadores usando [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Cria um novo `CRowset` objeto e (opcionalmente) o associa a uma `IRowset` interface fornecida como um parâmetro.|
|[Delete (excluir)](#delete)|Exclui linhas do conjunto de linhas usando [IRowsetChange: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Localiza a próxima linha correspondente após o indicador especificado.|
|[GetApproximatePosition](#getapproximateposition)|Retorna a posição aproximada de uma linha correspondente a um indicador.|
|[GetData](#getdata)|Recupera dados da cópia do conjunto de linhas da linha.|
|[GetDataHere](#getdatahere)|Recupera dados do buffer especificado.|
|[GetOriginalData](#getoriginaldata)|Recupera os dados buscados mais recentemente ou transmitidos para a fonte de dados, ignorando as alterações pendentes.|
|[GetRowStatus](#getrowstatus)|Retorna o status de todas as linhas.|
|[Inserção](#insert)|Cria e insere uma nova linha usando [IRowsetChange: InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85)).|
|[IsSameRow](#issamerow)|Compara a linha especificada com a linha atual.|
|[MoveFirst](#movefirst)|Reposiciona o local de próxima busca para a posição inicial.|
|[Velas](#movelast)|Move para o último registro.|
|[MoveNext](#movenext)|Busca dados da próxima linha sequencial ou um número especificado de posições além da próxima linha.|
|[MovePrev](#moveprev)|Move para o registro anterior.|
|[MoveToBookmark](#movetobookmark)|Busca a linha marcada por um indicador ou a linha em um deslocamento especificado a partir desse indicador.|
|[MoveToRatio](#movetoratio)|Busca linhas começando com base em uma posição fracionária no conjunto de linhas.|
|[ReleaseRows](#releaserows)|Chama [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) para liberar o identificador de linha atual.|
|[SetData](#setdata)|Define valores de dados em uma ou mais colunas de uma linha usando [IRowsetChange: SetData](/previous-versions/windows/desktop/ms721232(v=vs.85)).|
|[Desfazer](#undo)|Desfaz as alterações feitas em uma linha desde a última busca ou [atualização](../../data/oledb/crowset-update.md).|
|[Atualização](#update)|Transmite todas as alterações pendentes feitas na linha atual desde a última busca ou atualização.|
|[UpdateAll](#updateall)|Transmite todas as alterações pendentes feitas a todas as linhas desde a última busca ou atualização.|

## <a name="remarks"></a>Comentários

No OLE DB, um conjunto de linhas é o objeto por meio do qual um programa define e recupera dados.

Essa classe não deve ser instanciada, mas, em vez disso, passada como um parâmetro de modelo para `CTable` ou `CCommand` ( `CRowset` é o padrão).

## <a name="crowsetaddrefrows"></a><a name="addrefrows"></a>CRowset::AddRefRows

Chama [IRowset:: AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) para incrementar (por um) a contagem de referência associada ao identificador de linha atual.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método incrementa a contagem de referência para o identificador de linha atual. Chame [ReleaseRows](../../data/oledb/crowset-releaserows.md) para decrementar a contagem. As linhas retornadas pelos métodos de movimentação têm uma contagem de referência de um.

## <a name="crowsetclose"></a><a name="close"></a>CRowset:: fechar

Libera linhas e a interface [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) atual.

### <a name="syntax"></a>Sintaxe

```cpp
void Close() throw();
```

### <a name="remarks"></a>Comentários

Esse método libera Todas as linhas atualmente no conjunto de linhas.

## <a name="crowsetcompare"></a><a name="compare"></a>CRowset:: Compare

Compara dois indicadores usando [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>parâmetros

*Bookmark1*<br/>
no O primeiro indicador a ser comparado.

*Bookmark2*<br/>
no O segundo indicador a ser comparado.

*pComparison*<br/>
fora Um ponteiro para o resultado da comparação.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer a interface opcional `IRowsetLocate` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetLocate` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

Para obter informações sobre como usar indicadores em consumidores, consulte [usando indicadores](../../data/oledb/using-bookmarks.md).

## <a name="crowsetcrowset"></a><a name="crowset"></a>CRowset::CRowset

Cria um novo `CRowset` objeto e (opcionalmente) o associa a uma interface [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) fornecida como um parâmetro.

### <a name="syntax"></a>Sintaxe

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>parâmetros

*pRowset*<br/>
no Um ponteiro para uma `IRowset` interface a ser associado a essa classe.

## <a name="crowsetdelete"></a><a name="delete"></a>CRowset::D excluir

Chama [IRowsetChange::D eleterows](/previous-versions/windows/desktop/ms724362(v=vs.85)) para excluir a linha atual do conjunto de linhas.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

## <a name="crowsetfindnextrow"></a><a name="findnextrow"></a>CRowset::FindNextRow

Localiza a próxima linha correspondente após o indicador especificado.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>parâmetros

*parar*<br/>
no A operação a ser usada na comparação de valores de linha. Para obter valores, consulte [IRowsetFind:: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
no Um ponteiro para o valor a ser correspondido.

*wType*<br/>
no Indica o tipo de dados da parte de valor do buffer. Para obter informações sobre indicadores de tipo, consulte [tipos de dados](/previous-versions/windows/desktop/ms723969(v=vs.85)) na *referência do programador de OLE DB* no SDK do Windows.

*nLength*<br/>
no O comprimento, em bytes, da estrutura de dados do consumidor alocada para o valor de dados. Para obter detalhes, consulte a descrição de `cbMaxLen` em [estruturas DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) na *referência do programador de OLE DB.*

*bPrecision*<br/>
no A precisão máxima usada ao obter dados. Usado somente se *wType* for DBTYPE_NUMERIC. Para obter mais informações, consulte [conversões envolvendo DBTYPE_NUMERIC ou DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) na *referência do programador do OLE DB*.

*bScale*<br/>
no A escala usada ao obter dados. Usado somente se *wType* for DBTYPE_NUMERIC ou DBTYPE_DECIMAL. Para obter mais informações, consulte [conversões envolvendo DBTYPE_NUMERIC ou DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) na *referência do programador do OLE DB*.

*bSkipCurrent*<br/>
no O número de linhas do indicador no qual iniciar uma pesquisa.

*pBookmark*<br/>
no O indicador para a posição na qual iniciar uma pesquisa.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer a interface opcional `IRowsetFind` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetFind` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

Para obter informações sobre como usar indicadores em consumidores, consulte [usando indicadores](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetapproximateposition"></a><a name="getapproximateposition"></a>CRowset::GetApproximatePosition

Retorna a posição aproximada de uma linha correspondente a um indicador.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>parâmetros

*pBookmark*<br/>
no Um ponteiro para um indicador que identifica a linha cuja posição deve ser encontrada. NULL se apenas a contagem de linhas for necessária.

*pPosition*<br/>
fora Um ponteiro para o local onde `GetApproximatePosition` retorna a posição da linha. NULL se a posição não for necessária.

*pcRows*<br/>
fora Um ponteiro para o local em que `GetApproximatePosition` retorna o número total de linhas. NULL se a contagem de linhas não for necessária.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer a interface opcional `IRowsetScroll` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetScroll` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

Para obter informações sobre como usar indicadores em consumidores, consulte [usando indicadores](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetdata"></a><a name="getdata"></a>CRowset:: GetData

Recupera dados da cópia do conjunto de linhas da linha.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>parâmetros

*nAccessor*<br/>
no O número de índice (deslocamento zero) do acessador a ser usado para acessar os dados.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Se você especificar um acessador que não seja um autoacesso no [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), use esse método para obter explicitamente os dados, passando o número do acessador.

## <a name="crowsetgetdatahere"></a><a name="getdatahere"></a>CRowset::GetDataHere

Recupera dados da linha atual e os coloca no buffer especificado.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>parâmetros

*nAccessor*<br/>
no O número de índice do acessador a ser usado para acessar os dados.

*pBuffer*<br/>
fora Um buffer no qual posicionar os dados para o registro atual.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Para obter um exemplo de como usar essa função, consulte o [exemplo de MultiRead](../../overview/visual-cpp-samples.md).

## <a name="crowsetgetoriginaldata"></a><a name="getoriginaldata"></a>CRowset::GetOriginalData

Chamadas `IRowsetUpdate::GetOriginalData` para recuperar os dados buscados mais recentemente ou transmitidos para a fonte de dados.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método recupera os dados buscados mais recentemente ou transmitidos para a fonte de dados; Ele não recupera valores com base em alterações pendentes.

Esse método requer a interface opcional `IRowsetUpdate` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetUpdate` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

## <a name="crowsetgetrowstatus"></a><a name="getrowstatus"></a>CRowset::GetRowStatus

Retorna o status de todas as linhas.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>parâmetros

*pStatus*<br/>
fora Um ponteiro para um local em que `GetRowStatus` retorna o valor de status. Consulte DBPENDINGSTATUS na referência do programador de OLE DB.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer a interface opcional `IRowsetUpdate` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetUpdate` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

## <a name="crowsetinsert"></a><a name="insert"></a>CRowset:: Insert

Cria e Inicializa uma nova linha usando dados do acessador.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>parâmetros

*nAccessor*<br/>
no O número do acessador a ser usado para inserir os dados.

*bGetHRow*<br/>
no Indica se o identificador da linha inserida é recuperado.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer a interface opcional `IRowsetChange` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetChange` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

A inserção poderá falhar se uma ou mais colunas não forem graváveis. Modifique o mapa do cursor para corrigir isso.

### <a name="example"></a>Exemplo

O exemplo a seguir mostra como acessar uma fonte de dados por meio de um conjunto de linhas e, em seguida, inserir uma cadeia de caracteres usando uma tabela nesse conjunto de linhas.

Primeiro, crie uma classe de tabela inserindo um novo objeto ATL em seu projeto. Por exemplo, clique com o botão direito do mouse no projeto no painel espaço de trabalho e selecione **novo objeto ATL**. Na categoria **acesso a dados** , selecione **consumidor**. Criar um objeto de consumidor do tipo **tabela**. (Selecionar **tabela** cria um conjunto de linhas diretamente da tabela; Selecionar **comando** cria um conjunto de linhas por meio de um comando SQL.) Selecione uma fonte de dados, especificando uma tabela por meio da qual acessar essa fonte de dados. Se você chamar o objeto de consumidor **CCustomerTable**, você implementaria o código de inserção da seguinte maneira:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="crowsetissamerow"></a><a name="issamerow"></a>CRowset::IsSameRow

Compara a linha especificada com a linha atual.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>parâmetros

*hRow*<br/>
no Um identificador para a linha a ser comparado com a linha atual.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão. S_OK indica que as linhas são as mesmas. Para outros valores, consulte [IRowsetIndentity:: IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) na *referência do programador de OLE DB* no SDK do Windows.

## <a name="crowsetmovefirst"></a><a name="movefirst"></a>CRowset:: MoveFirst

Move o cursor para a posição inicial e recupera a linha inicial.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Chama [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) para reposicionar o próximo local de busca na posição inicial (a posição que foi o próximo local de busca quando o conjunto de linhas foi criado) e recupera a linha inicial.

## <a name="crowsetmovelast"></a><a name="movelast"></a>CRowset:: MoveLast

Move o cursor para a última linha.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Chama [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) para reposicionar o próximo local de busca na última posição e recupera a última linha.

Esse método requer que você defina `DBPROP_CANSCROLLBACKWARDS` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas. (Para obter um melhor desempenho, você também pode definir `DBPROP_QUICKRESTART` como VARIANT_TRUE.)

## <a name="crowsetmovenext"></a><a name="movenext"></a>CRowset:: MoveNext

Move o cursor para o próximo registro.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>parâmetros

*lSkip*<br/>
no O número de linhas a serem ignoradas antes da busca.

*bForward*<br/>
no Passe **`true`** para avançar para o próximo registro, **`false`** para retroceder.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão. Quando o final do conjunto de linhas for atingido, retornará DB_S_ENDOFROWSET.

### <a name="remarks"></a>Comentários

Busca a próxima linha sequencial do `CRowset` objeto, lembrando a posição anterior. Opcionalmente, você pode optar por ignorar as linhas *lSkip* ou retroceder.

Esse método requer que você defina as propriedades a seguir antes de chamar `Open` a tabela ou o comando que contém o conjunto de linhas:

- `DBPROP_CANSCROLLBACKWARDS`deve ser VARIANT_TRUE se *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS`deve ser VARIANT_TRUE se *bForward* = false

Caso contrário (se *lSkip* >= 0 e *bForward* = true), você não precisará definir nenhuma propriedade adicional.

## <a name="crowsetmoveprev"></a><a name="moveprev"></a>CRowset::MovePrev

Move o cursor para o registro anterior.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer que você defina `DBPROP_CANFETCHBACKWARDS` ou `DBPROP_CANSCROLLBACKWARDS` para VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

## <a name="crowsetmovetobookmark"></a><a name="movetobookmark"></a>CRowset::MoveToBookmark

Busca a linha marcada por um indicador ou a linha em um deslocamento especificado (*lSkip*) desse indicador.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>parâmetros

*bookmark*<br/>
no Um indicador que marca o local do qual você deseja buscar dados.

*lSkip*<br/>
no A contagem de números de linhas do indicador até a linha de destino. Se *lSkip* for zero, a primeira linha buscada será a linha marcada. Se *lSkip* for 1, a primeira linha buscada será a linha após a linha marcada. Se *lSkip* for-1, a primeira linha buscada será a linha antes da linha marcada.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer a interface opcional `IRowsetLocate` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetLocate` como VARIANT_TRUE e definir `DBPROP_CANFETCHBACKWARDS` como VARIANT_TRUE antes de chamar `Open` a tabela ou o comando que contém o conjunto de linhas.

Para obter informações sobre como usar indicadores em consumidores, consulte [usando indicadores](../../data/oledb/using-bookmarks.md).

## <a name="crowsetmovetoratio"></a><a name="movetoratio"></a>CRowset::MoveToRatio

Busca linhas começando com base em uma posição fracionária no conjunto de linhas.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>parâmetros

*nNumerator*<br/>
no O numerador usado para determinar a posição fracionária da qual buscar dados.

*nDenominator*<br/>
no O denominador usado para determinar a posição fracionária da qual buscar dados.

*bForward*<br/>
no Indica se deve mover para frente ou para trás. O padrão é encaminhar.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

`MoveToRatio`busca linhas de acordo com a seguinte fórmula:

`(nNumerator *  RowsetSize ) / nDenominator`

em que `RowsetSize` é o tamanho do conjunto de linhas, medido em linhas. A precisão dessa fórmula depende do provedor específico. Para obter detalhes, consulte [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Esse método requer a interface opcional `IRowsetScroll` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetScroll` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

## <a name="crowsetreleaserows"></a><a name="releaserows"></a>CRowset:: ReleaseRows

Chama [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) para liberar o identificador de linha atual.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

## <a name="crowsetsetdata"></a><a name="setdata"></a>CRowset:: SetData

Define valores de dados em uma ou mais colunas de uma linha.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>parâmetros

*nAccessor*<br/>
no O número do acessador a ser usado para acessar os dados.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Para o `SetData` formulário que não aceita nenhum argumento, todos os acessadores são usados para atualização. Normalmente, você chama `SetData` para definir valores de dados em colunas em uma linha e, em seguida, chamar [Update](../../data/oledb/crowset-update.md) para transmitir essas alterações.

Esse método requer a interface opcional `IRowsetChange` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetChange` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

A operação de configuração poderá falhar se uma ou mais colunas não forem graváveis. Modifique o mapa do cursor para corrigir isso.

## <a name="crowsetundo"></a><a name="undo"></a>CRowset:: desfazer

Desfaz as alterações feitas em uma linha desde a última busca ou [atualização](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>parâmetros

*pcRows*<br/>
fora Um ponteiro para o local em que `Undo` retorna o número de linhas que tentou desfazer, se necessário.

*phRow*<br/>
fora Um ponteiro para o local em que `Undo` retorna uma matriz de identificadores para todas as linhas que tentou desfazer, se necessário.

*pStatus*<br/>
fora Um ponteiro para o local em que `Undo` retorna o valor de status da linha. Nenhum status será retornado se *pStatus* for nulo.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer a interface opcional `IRowsetUpdate` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetUpdate` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

## <a name="crowsetupdate"></a><a name="update"></a>CRowset:: atualizar

Transmite todas as alterações pendentes feitas na linha atual desde a última busca ou `Update` chamada.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>parâmetros

*pcRows*<br/>
fora Um ponteiro para o local em que `Update` retorna o número de linhas que tentou atualizar, se necessário.

*phRow*<br/>
fora Um ponteiro para o local em que `Update` retorna o identificador da linha que tentou atualizar. Nenhum identificador será retornado se *phRow* for nulo.

*pStatus*<br/>
fora Um ponteiro para o local em que `Update` retorna o valor de status da linha. Nenhum status será retornado se *pStatus* for nulo.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Transmite todas as alterações pendentes feitas na linha atual desde que essa linha foi obtida pela última vez ou atualizada (usando `Update` ou [UpdateAll](../../data/oledb/crowset-updateall.md)). Normalmente, você chama [SetData](../../data/oledb/crowset-setdata.md) para definir valores de dados em colunas em uma linha e, em seguida, chamar `Update` para transmitir essas alterações.

Esse método requer a interface opcional `IRowsetUpdate` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetUpdate` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

## <a name="crowsetupdateall"></a><a name="updateall"></a>CRowset:: UpdateAll

Transmite todas as alterações pendentes feitas a todas as linhas desde a última busca ou `Update` chamada.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>parâmetros

*pcRows*<br/>
fora Um ponteiro para o local em que `UpdateAll` retorna o número de linhas que tentou atualizar, se necessário.

*pphRow*<br/>
fora Um ponteiro para a memória que `UpdateAll` retorna o identificador da linha que tentou atualizar. Nenhum identificador será retornado se *pphRow* for nulo.

*ppStatus*<br/>
fora Um ponteiro para o local em que `Update` retorna o valor de status da linha. Nenhum status será retornado se *ppStatus* for nulo.

### <a name="remarks"></a>Comentários

Transmite todas as alterações pendentes feitas a todas as linhas desde que essas linhas foram buscadas pela última vez ou atualizadas usando [Update](../../data/oledb/crowset-update.md) ou `UpdateAll` . `UpdateAll`o atualizará todas as linhas que foram modificadas, independentemente de você ainda ter o identificador para elas (consulte *pphRow*) ou não.

Por exemplo, se você tiver usado `Insert` para inserir cinco linhas em um conjunto de linhas, poderá chamar `Update` cinco vezes ou chamar `UpdateAll` uma vez para atualizar todas elas.

Esse método requer a interface opcional `IRowsetUpdate` , que pode não ter suporte em todos os provedores; se esse for o caso, o método retornará E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetUpdate` como VARIANT_TRUE antes de chamar `Open` na tabela ou comando que contém o conjunto de linhas.

### <a name="return-value"></a>Valor retornado

Um HRESULT padrão.

## <a name="see-also"></a>Confira também

[Exemplo de DBViewer](../../overview/visual-cpp-samples.md)<br/>
[Exemplo de MultiRead](../../overview/visual-cpp-samples.md)<br/>
[Exemplo de atributos de MultiRead](../../overview/visual-cpp-samples.md)<br/>
[Modelos de consumidor OLE DB](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Referência de modelos de consumidor OLE DB](../../data/oledb/ole-db-consumer-templates-reference.md)
