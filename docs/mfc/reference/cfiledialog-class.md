---
title: Classe CFileDialog
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: 247072d815b660fcd2cc6c2a1291b618aa6ce2ab
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753145"
---
# <a name="cfiledialog-class"></a>Classe CFileDialog

Encapsula a caixa de diálogo comum usada para operações de abertura de arquivo ou de salvamento de arquivos.

## <a name="syntax"></a>Sintaxe

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Membros

### <a name="public-constructors"></a>Construtores públicos

|Nome|Descrição|
|----------|-----------------|
|[cfiledialog::CfileDialog](#cfiledialog)|Constrói um objeto `CFileDialog`.|

### <a name="public-methods"></a>Métodos públicos

|Nome|Descrição|
|----------|-----------------|
|[cfiledialog::AddCheckbutton](#addcheckbutton)|Adiciona um botão de verificação à caixa de diálogo.|
|[CFileDialog::AddComboBox](#addcombobox)|Adiciona uma caixa de combinação à caixa de diálogo.|
|[cfiledialog::AddControlItem](#addcontrolitem)|Adiciona um item a um controle de contêiner na caixa de diálogo.|
|[cfiledialog::AddEditBox](#addeditbox)|Adiciona uma caixa de edição à caixa de diálogo.|
|[cfiledialog::Addmenu](#addmenu)|Adiciona um menu ao diálogo.|
|[cfiledialog::addplace](#addplace)|Sobrecarregado. Adiciona uma pasta à lista de lugares disponíveis para o usuário abrir ou salvar itens.|
|[cfiledialog::AddPushButton](#addpushbutton)|Adiciona um botão à caixa de diálogo.|
|[cfiledialog::Addradiobuttonlist](#addradiobuttonlist)|Adiciona um botão de opção (também conhecido como botão de rádio) à caixa de diálogo.|
|[cfiledialog::AddSeparator](#addseparator)|Adiciona um separador ao diálogo.|
|[cfiledialog::AddText](#addtext)|Adiciona conteúdo de texto à caixa de diálogo.|
|[cfiledialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Atualiza o estado `CFileDialog` do para corresponder aos parâmetros e sinalizadores armazenados na `m_ofn` variável membro.|
|[CFileDialog::DoModal](#domodal)|Exibe a caixa de diálogo e permite que o usuário faça uma seleção.|
|[cfileDialog::HabilitarOpenDropDown](#enableopendropdown)|Habilita uma lista de parada no botão **Abrir** ou **Salvar** na caixa de diálogo.|
|[cfiledialog::EndvisualGroup](#endvisualgroup)|Impede a adição de elementos a um grupo visual no diálogo.|
|[cfiledialog::getCheckbuttonstate](#getcheckbuttonstate)|Obtém o estado atual de um botão de seleção (caixa de seleção) na caixa de diálogo.|
|[cfiledialog::GetControlItemState](#getcontrolitemstate)|Obtém o estado atual de um item em um controle de contêiner encontrado na caixa de diálogo.|
|[cfiledialog::getcontrolstate](#getcontrolstate)|Obtém a visibilidade atual e estados habilitados de um determinado controle.|
|[cfiledialog::getEditBoxText](#geteditboxtext)|Obtém o texto atual em um controle de caixa de edição.|
|[CFileDialog::GetFileExt](#getfileext)|Retorna a extensão do arquivo selecionado.|
|[cfiledialog::getFileName](#getfilename)|Retorna o nome do arquivo do arquivo selecionado.|
|[cfiledialog::getFileTitle](#getfiletitle)|Retorna o título do arquivo selecionado.|
|[cfiledialog::getfolderpathPath](#getfolderpath)|Recupera o caminho da pasta ou diretório atualmente aberto para uma caixa de diálogo **aberta** no estilo Explorer ou **Save As** comum.|
|[cfiledialog::getiFileDialogCustom](#getifiledialogcustomize)|Recupera o objeto COM interno `CFileDialog` para um objeto personalizado.|
|[cfiledialog::getifileopendialog](#getifileopendialog)|Recupera o objeto COM `CFileDialog` interno para um que é usado como uma caixa de diálogo de arquivo **Aberto.**|
|[cfiledialog::getiFileSavedialog](#getifilesavedialog)|Recupera o objeto COM `CFileDialog` interno para um que é usado como uma caixa de diálogo **Salvar** arquivo.|
|[cfiledialog::getNextPathName](#getnextpathname)|Retorna o caminho completo do próximo arquivo selecionado.|
|[cfiledialog::getOFN](#getofn)|Recupera a `OPENFILENAME` estrutura `CFileDialog` do objeto.|
|[cfiledialog::getPathName](#getpathname)|Retorna o caminho completo do arquivo selecionado.|
|[cfiledialog::GetReadOnlyPref](#getreadonlypref)|Retorna o status somente leitura do arquivo selecionado.|
|[cfiledialog::getResult](#getresult)|Obtém-se a escolha que o usuário fez na caixa de diálogo.|
|[cfiledialog::getResults](#getresults)|Obtém as escolhas do usuário em uma caixa de diálogo que permite a seleção múltipla.|
|[cfiledialog::GetSelectedControlItem](#getselectedcontrolitem)|Obtém um item específico de controles de contêiner especificados na caixa de diálogo.|
|[cfiledialog::getStartPosition](#getstartposition)|Retorna a posição do primeiro elemento da lista de nomes do arquivo.|
|[cfiledialog::Ocultar controle](#hidecontrol)|Oculta o controle especificado em uma caixa de diálogo estilo Explorer **Open** ou **Save As** comum.|
|[CFileDialog::IsPickPastsMode](#ispickfoldersmode)|Determina se a caixa de diálogo atual no modo seletor de pastas.|
|[cfiledialog::MakeProminent](#makeprominent)|Coloca um controle no diálogo para que ele se destaque em comparação com outros controles adicionados.|
|[cfilediálogo::RemoveControlItem](#removecontrolitem)|Remove um item de um controle de contêiner na caixa de diálogo.|
|[cfiledialog::setCheckButtonstate](#setcheckbuttonstate)|Define o estado atual de um botão de seleção (caixa de seleção) na caixa de diálogo.|
|[cfileDiálogo::SetControlItemState](#setcontrolitemstate)|Define o estado atual de um item em um controle de contêiner encontrado na caixa de diálogo.|
|[cfileDiálogo::SetControlItemText](#setcontrolitemtext)|Define o texto de um item de controle. Por exemplo, o texto que acompanha um botão de rádio ou um item em um menu.|
|[cfile 'Diálogo':'SetControl'](#setcontrollabel)|Define o texto associado a um controle, como texto de botão ou um rótulo de caixa de edição.|
|[cfiledialog::setControlState](#setcontrolstate)|Define a visibilidade atual e os estados habilitados de um determinado controle.|
|[cfileDialog::SetControlText](#setcontroltext)|Define o texto para o controle especificado em uma caixa de diálogo **aberto** ou **salvo como** um ponto de diálogo comum no estilo Explorer.|
|[cfiledialog::SetDefExt](#setdefext)|Define a extensão de nome de arquivo padrão para uma caixa de diálogo **'Abrir'** estilo Explorer ou **Salvar como** uma caixa de diálogo comum.|
|[cfileDialog::SetEditBoxText](#seteditboxtext)|Define o texto atual em um controle de caixa de edição.|
|[cfileDialog::SetPropriedades](#setproperties)|Fornece um repositório de propriedades que define os valores padrão a serem usados para o item que está sendo salvo.|
|[cfileDiálogo::ConjuntoConjuntoControledecontroleItem](#setselectedcontrolitem)|Define o estado selecionado de um item específico em um grupo de botões de opção ou em uma caixa de combinação encontrada na caixa de diálogo.|
|[cfileDialog::SetTemplate](#settemplate)|Define o modelo da `CFileDialog` caixa de diálogo para o objeto.|
|[cfiledialog::StartVisualGroup](#startvisualgroup)|Declara um grupo visual na caixa de diálogo. Chamadas subseqüentes a qualquer método de "adicionar" adicionam esses elementos a este grupo.|
|[cfiledialog::updateOFnFromShellDialog](#updateofnfromshelldialog)|Atualiza os dados armazenados na variável `m_ofn` membro para corresponder ao estado atual da caixa de diálogo de arquivo.|

### <a name="protected-methods"></a>Métodos Protegidos

|Nome|Descrição|
|----------|-----------------|
|[cfiledialog::OnButtonClicked](#onbuttonclicked)|Chamado quando o botão é clicado.|
|[cfiledialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Chamado quando a caixa de seleção é verificada/desmarcada.|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Chamado quando o controle está ativo.|
|[cfiledialog::OnFileNameChange](#onfilenamechange)|Lida com a mensagem CDN_SELCHANGE WM_NOTIFY.|
|[cfiledialog::OnFilenameOK](#onfilenameok)|Valida o nome do arquivo inserido na caixa de diálogo.|
|[cfiledialog::OnFolderChange](#onfolderchange)|Lida com a mensagem CDN_FOLDERCHANGE WM_NOTIFY.|
|[cfiledialog::OnInitDone](#oninitdone)|Lida com a mensagem WM_NOTIFY CDN_INITDONE.|
|[cfiledialog::OnItemSelecionado](#onitemselected)|Chamado quando o item do contêiner está sendo selecionado.|
|[cfiledialog::OnLBSelChangedNotificar](#onlbselchangednotify)|Permite que você execute ações personalizadas quando a seleção de arquivos for mudada.|
|[cfiledialog::onShareViolation](#onshareviolation)|Lida com violações de compartilhamento.|
|[cfiledialog::OnTypeChange](#ontypechange)|Lida com a mensagem WM_NOTIFY CDN_TYPECHANGE.|

### <a name="public-data-members"></a>Membros de Dados Públicos

|Nome|Descrição|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|A `OPENFILENAME` estrutura do Windows. Fornece acesso aos parâmetros básicos da caixa de diálogo de arquivos.|

## <a name="remarks"></a>Comentários

Caixas de diálogo de arquivo comuns permitem que você implemente caixas de diálogo de seleção de arquivos, por exemplo, **Abrir arquivo** e **salvar como**, de uma maneira consistente com os padrões do Windows.

Você pode `CFileDialog` usar como está com o construtor fornecido, ou você `CFileDialog` pode derivar sua própria classe caixa de diálogo e escrever um construtor para atender às suas necessidades. Em ambos os casos, essas caixas de diálogo se comportarão como caixas de diálogo MFC padrão porque são derivadas da [Classe CCommonDialog](../../mfc/reference/ccommondialog-class.md). `CFileDialog`conta com o COMMDLG. Arquivo DLL que está incluído no Windows.

Tanto a aparência quanto a `CFileDialog` funcionalidade do com o Windows Vista ou posterior diferem das versões anteriores do Windows. O `CFileDialog` padrão usa automaticamente o novo estilo Windows Vista ou posterior sem alterações de código se um programa for compilado e executado no Windows Vista ou posteriormente. Use o parâmetro *bVistaStyle* no construtor para substituir manualmente esta atualização automática. A exceção à atualização automática são as caixas de diálogo personalizadas. Eles não serão convertidos para o novo estilo. Para obter mais informações sobre o construtor, consulte [CFileDialog::CFileDialog](#cfiledialog).

> [!NOTE]
> O sistema de ID de controle difere no Windows Vista `CFileDialog`ou mais tarde das versões anteriores do Windows quando você usa um . Você deve atualizar todas `CFileDialog` as referências aos controles em código antes de poder portar seu projeto a partir de uma versão anterior do Windows.

Alguns `CFileDialog` métodos não são suportados no Windows Vista ou posteriormente. Verifique o tópico do método individual para obter informações sobre se o método é suportado. Além disso, as seguintes funções herdadas não são suportadas no Windows Vista ou posteriormente:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [diálogo::Fonte de início](../../mfc/reference/cdialog-class.md#onsetfont)

As mensagens do `CFileDialog` Windows para a classe variam de acordo com o sistema operacional que você está usando. Por exemplo, o Windows XP não suporta [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) e `CFileDialog` [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) para a classe. No entanto, o Windows Vista e os sistemas operacionais posteriores os suportam. Para obter mais informações sobre as diferentes mensagens geradas e a ordem em que são recebidas, consulte [CFileDialog Sample: Logging Event Order](../../overview/visual-cpp-samples.md).

Para usar `CFileDialog` um objeto, primeiro crie `CFileDialog` o objeto usando o construtor. Depois que a caixa de diálogo for construída, você pode definir ou modificar quaisquer valores na estrutura [CFileDialog::m_ofn](#m_ofn) para inicializar os valores ou estados dos controles da caixa de diálogo. A `m_ofn` estrutura é `OPENFILENAME`do tipo. Para obter mais informações, consulte a estrutura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) no SDK do Windows.

Depois de inicializar os controles da caixa de diálogo, ligue para o método [CFileDialog::DoModal](#domodal) para exibir a caixa de diálogo para que o usuário possa digitar o caminho e o nome do arquivo. `DoModal`retorna se o usuário clicou no botão OK (IDOK) ou no botão Cancelar (IDCANCEL). Se `DoModal` retornar o IDOK, você `CFileDialog` pode usar uma das funções do membro público para recuperar as informações colocadas pelo usuário.

> [!NOTE]
> No Windows Vista ou posterior, várias chamadas para [IFileDialog::SetFileTypes](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) causa um erro. A segunda `SetFileTypes` chamada para qualquer `CFileDialog` instância de um retornará E_UNEXPECTED no Windows Vista ou posterior. Algumas `CFileDialog` funções `SetFileTypes`do método chamam . Por exemplo, duas `CFileDialog::DoModal` chamadas para a `CFileDialog` mesma instância de um [gera ASSERT](diagnostic-services.md#assert).

`CFileDialog`inclui vários membros protegidos que permitem que você faça o tratamento personalizado de violações de compartilhamento, validação de nome de arquivo e notificação de alteração de caixa de lista. Esses membros protegidos são funções de retorno de chamada que a maioria dos aplicativos não precisa usar porque o manuseio padrão é realizado automaticamente. As entradas de mapa de mensagens para essas funções não são necessárias porque são funções virtuais padrão.

Você pode usar a função Windows [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) para determinar se ocorreu um erro durante a inicialização da caixa de diálogo e para saber mais sobre o erro.

A destruição de `CFileDialog` objetos é tratada automaticamente. Você não precisa ligar para [CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Para permitir que o usuário selecione vários `DoModal`arquivos, defina o sinalizador OFN_ALLOWMULTISELECT antes de chamar . Você deve fornecer seu próprio buffer de nome de arquivo para acomodar a lista retornada de vários nomes de arquivo. Faça isso substituindo `m_ofn.lpstrFile` por um ponteiro para um buffer que `CFileDialog`você alocou, depois de construir o , mas antes de chamar `DoModal`.

Além disso, você `m_ofn.nMaxFile` deve definir usando o número de `m_ofn.lpstrFile`caracteres no buffer apontado por . Se você definir o número máximo `n`de arquivos a `n * (_MAX_PATH + 1) + 1`serem selecionados, o tamanho de buffer necessário será . O primeiro item devolvido no buffer é o caminho para a pasta onde os arquivos foram selecionados. Para o Windows Vista ou caixas de diálogo de estilo posterior, as seqüências de nome de diretório e arquivo são anuladas por nulidade, com um caractere nulo extra após o nome do último arquivo. Esse formato permite que as caixas de diálogo estilo Explorer retornem nomes de arquivos longos que incluem espaços. Para caixas de diálogo de estilo antigo, as seqüências de diretório e nome do arquivo são separadas por espaços e a função usa nomes de arquivos curtos para nomes de arquivos com espaços.

O exemplo a seguir demonstra como usar um buffer para recuperar e listar vários nomes de arquivos.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Para alterar o tamanho do buffer em resposta ao usuário que seleciona vários nomes de `CFileDialog` arquivo, você deve derivar uma nova classe e substituir o método [CFileDialog::OnFileNameChange.](#onfilenamechange)

Se você derivar `CFileDialog`uma nova classe de , você pode usar um mapa de mensagem para lidar com quaisquer mensagens. Para estender o tratamento padrão da `CFileDialog`mensagem, obtenha uma classe de , adicione um mapa de mensagem à nova classe e forneça funções de membro para as novas mensagens. Você não precisa fornecer uma função de gancho para personalizar a caixa de diálogo.

Para personalizar a caixa de `CFileDialog`diálogo, obtenha uma classe, forneça um modelo de caixa de diálogo personalizado e adicione um mapa de mensagem para processar as mensagens de notificação dos controles estendidos. Passe qualquer mensagem não processada para a classe base. Você não precisa personalizar a função do gancho.

Quando você estiver usando o Windows `CFileDialog`Vista ou o estilo posterior do , você não pode usar mapas de mensagem e modelos de caixa de diálogo. Em vez disso, você deve usar as interfaces COM para funcionalidadesemelhante.

Para obter mais informações `CFileDialog`sobre como usar, consulte [Common Dialog Classes](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Hierarquia de herança

[Cobject](../../mfc/reference/cobject-class.md)

[Ccmdtarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[Cdialog](../../mfc/reference/cdialog-class.md)

[Ccommondialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Requisitos

**Cabeçalho:** afxdlgs.h

## <a name="cfiledialogaddcheckbutton"></a><a name="addcheckbutton"></a>cfiledialog::AddCheckbutton

Adiciona um botão de verificação à caixa de diálogo.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID do botão de seleção para adicionar.

*strRótulo*<br/>
O nome do botão de verificação.

*bChecked*<br/>
Um booleano indicando o estado atual do botão de verificação. VERDADEIRO se verificado; FALSO de outra forma

### <a name="remarks"></a>Comentários

## <a name="cfiledialogaddcombobox"></a><a name="addcombobox"></a>CFileDialog::AddComboBox

Adiciona uma caixa de combinação à caixa de diálogo.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID da caixa de combinação para adicionar.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogaddcontrolitem"></a><a name="addcontrolitem"></a>cfiledialog::AddControlItem

Adiciona um item a um controle de contêiner na caixa de diálogo.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID do controle do contêiner para adicionar o item.

*dwIDItem*<br/>
O ID do item.

*strRótulo*<br/>
O texto do item.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogaddeditbox"></a><a name="addeditbox"></a>cfiledialog::AddEditBox

Adiciona uma caixa de edição à caixa de diálogo.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID da caixa de edição para adicionar.

*strText*<br/>
O nome da caixa de edição.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogaddmenu"></a><a name="addmenu"></a>cfiledialog::Addmenu

Adiciona um menu ao diálogo.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID do menu para adicionar.

*strRótulo*<br/>
O nome do menu.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogaddplace"></a><a name="addplace"></a>cfiledialog::addplace

Adiciona uma pasta à lista de lugares disponíveis para o usuário abrir ou salvar itens.

```cpp
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Parâmetros

*lpszFolder*<br/>
Um caminho para a pasta a ser disponibilizada ao usuário. Isso só pode ser uma pasta.

*fdap*<br/>
Especifica onde a pasta é colocada dentro da lista.

*psi*<br/>
Um ponteiro para um IShellItem que representa a pasta a ser disponibilizada ao usuário. Isso só pode ser uma pasta.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogaddpushbutton"></a><a name="addpushbutton"></a>cfiledialog::AddPushButton

Adiciona um botão à caixa de diálogo.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID do botão para adicionar.

*strRótulo*<br/>
O nome do botão.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogaddradiobuttonlist"></a><a name="addradiobuttonlist"></a>cfiledialog::Addradiobuttonlist

Adiciona um botão de opção (também conhecido como botão de rádio) à caixa de diálogo.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID do grupo de botões de opção para adicionar.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogaddseparator"></a><a name="addseparator"></a>cfiledialog::AddSeparator

Adiciona um separador ao diálogo.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID do separador adicionar.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogaddtext"></a><a name="addtext"></a>cfiledialog::AddText

Adiciona texto à caixa de diálogo.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID do texto para adicionar.

*strText*<br/>
O nome do texto.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogapplyofntoshelldialog"></a><a name="applyofntoshelldialog"></a>cfiledialog::ApplyOFNToShellDialog

Atualiza o estado atual do [CFileDialog](../../mfc/reference/cfiledialog-class.md) com base `m_ofn` nos valores armazenados na estrutura de dados.

```cpp
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Comentários

Nas versões do Windows antes do Windows Vista, a estrutura de `CFileDialog`dados DO MEMBRO [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) foi continuamente sincronizada com o estado do . Quaisquer alterações na variável [membro m_ofn](#m_ofn) foram imediatamente refletidas no estado da caixa de diálogo. Além disso, quaisquer alterações no estado da `m_ofn` caixa de diálogo atualizem imediatamente a variável membro.

No Windows Vista ou posterior, `m_ofn` os valores `CFileDialog` na variável membro e no estado do não são garantidos para serem sincronizados. Esta função força o `CFileDialog` estado do ser `m_ofn` atualizado para corresponder à estrutura. O Windows chama essa função automaticamente durante [CFileDialog::DoModal](#domodal).

Para obter mais informações `CFileDialog` sobre como usar a classe no Windows Vista ou posterior, consulte [CFileDialog Class](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Exemplo

  Veja o exemplo de [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog).

## <a name="cfiledialogcfiledialog"></a><a name="cfiledialog"></a>cfiledialog::CfileDialog

Chame esta função para construir uma caixa de diálogo de arquivo padrão do Windows.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Parâmetros

*bOpenFileDialog*<br/>
[em] O parâmetro que especifica que tipo de caixa de diálogo criar. Defina-o como TRUE para construir uma caixa de diálogo **Abrir arquivos.** Defina-o como FALSE para construir uma caixa de diálogo **Salvar arquivo como** caixa de diálogo.

*lpszDefExt*<br/>
[em] A extensão padrão do nome do arquivo. Se o usuário não incluir uma extensão conhecida (uma que tenha uma associação no computador do usuário) na caixa Nome de Arquivo, a extensão especificada pelo *lpszDefExt* será automaticamente anexada ao nome do arquivo. Se este parâmetro for NULO, nenhuma extensão será anexada.

*lpszFileName*<br/>
[em] O nome inicial do arquivo que aparece na caixa Nome de Arquivo. Se NULO, nenhum nome de arquivo inicial será exibido.

*dwFlags*<br/>
[em] Uma combinação de um ou mais sinalizadores que você pode usar para personalizar a caixa de diálogo. Para obter uma descrição desses sinalizadores, consulte a estrutura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) no SDK do Windows. Se você `m_ofn.Flags` modificar o membro da estrutura, use um operador bitwise-OR em suas alterações para manter o comportamento padrão intacto.

*lpszFilter*<br/>
[em] Uma série de pares de strings que especificam filtros que você pode aplicar no arquivo. Se você especificar filtros de arquivo, somente arquivos que correspondam aos critérios do filtro aparecerão na lista Arquivos. Consulte a seção Observações para obter mais informações sobre como trabalhar com filtros de arquivos.

*Pparentwnd*<br/>
[em] Um ponteiro para a janela pai ou proprietário da caixa de diálogo de arquivo.

*Dwsize*<br/>
[em] O tamanho `OPENFILENAME` da estrutura. Esse valor depende da versão do sistema operacional. O MFC usou este parâmetro para determinar o tipo apropriado de caixa de diálogo para criar. O tamanho padrão de 0 significa que o código MFC determinará o tamanho correto da caixa de diálogo a ser usada com base na versão do sistema operacional em que o programa é executado.

*Bvistastyle*<br/>
[em] **Nota** Este parâmetro está disponível no Visual Studio 2008 e posteriormente e faz com que a caixa de diálogo de novo estilo seja usada apenas se você estiver sendo executado no Windows Vista ou posteriormente.

O parâmetro que especifica o estilo da caixa de diálogo do arquivo. Defina-o como TRUE para usar as novas diálogos de arquivo de estilo do Vista. Caso contrário, o antigo estilo das caixas de diálogo será usado. Consulte a seção Observações para obter mais informações sobre a execução sob o Vista.

### <a name="remarks"></a>Comentários

Uma **caixa de diálogo Abrir arquivo** ou salvar arquivos **como** é construída, dependendo do valor do *bOpenFileDialog*.

Especificar uma extensão padrão usando *lpszDefExt* pode não produzir o comportamento que você espera, porque raramente é previsível quais extensões têm associações de arquivos no computador do usuário. Se você precisar de mais controle sobre a anexação de `CFileDialog`uma extensão `CFileDialog::OnFileNameOK` padrão, você pode derivar sua própria classe e substituir o método para executar seu próprio tratamento de extensão.

Para habilitar o usuário a selecionar vários arquivos, defina o sinalizador OFN_ALLOWMULTISELECT antes de chamar [DoModal](#domodal). Você deve fornecer seu próprio buffer de nome de arquivo para armazenar a lista retornada de vários nomes de arquivo. Faça isso substituindo `m_ofn.lpstrFile` por um ponteiro para um buffer que você alocou, depois de construir o [CFileDialog,](../../mfc/reference/cfiledialog-class.md)mas antes de chamar `DoModal`. Além disso, você `m_ofn.nMaxFile` deve definir com o número `m_ofn.lpstrFile`de caracteres no buffer apontado por . Se você definir o número máximo de arquivos a serem `n`selecionados para *n,* o tamanho de buffer necessário é *(_MAX_PATH + 1) + 1. Por exemplo:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Para permitir que o usuário redimensione uma caixa de diálogo estilo Explorer usando o mouse ou o teclado, defina o sinalizador OFN_ENABLESIZING. Definir este sinalizador só é necessário se você fornecer um procedimento de gancho ou modelo personalizado. O sinalizador funciona apenas com uma caixa de diálogo estilo Explorer; As caixas de diálogo de estilo antigo não podem ser redimensionadas.

O parâmetro *lpszFilter* é usado para determinar o tipo de nome do arquivo que um arquivo deve ter que ser exibido na lista de arquivos. A primeira seqüência do par de cordas descreve o filtro; a segunda seqüência indica a extensão do nome do arquivo a ser usada. Várias extensões podem ser especificadas usando um ponto e vírgula (o caractere ';') como delimitador. A seqüência termina com dois caracteres '&#124;', seguido por um caractere NULL. Você também pode usar um objeto [CString](../../atl-mfc-shared/using-cstring.md) para este parâmetro.

Por exemplo, o Microsoft Excel permite que os usuários abram arquivos que tenham extensões .xlc (gráfico) ou .xls (planilha), entre outros. O filtro para Excel pode ser escrito como:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

No entanto, se você planeja usar `OPENFILENAME` essa string para atualizar diretamente a estrutura, você deve delimitar suas strings com o caractere nulo, '\0', em vez das barras verticais ('&#124;').

O parâmetro *bVistaStyle* só é aplicável ao ser executado no Windows Vista ou posteriormente. Em versões anteriores do Windows, este parâmetro é ignorado. Se *bVistaStyle* estiver definido como TRUE, ao compilar um programa com o Visual Studio 2008 ou posterior, o novo estilo **Decaixa de Arquivo do** Vista será usado. Caso contrário, o diálogo **de arquivo de** estilo mfc anterior será usado.

Os modelos de diálogo não são suportados em diálogos com base no *bVistaStyle*

### <a name="example"></a>Exemplo

  Veja o exemplo de [CFileDialog::DoModal](#domodal).

## <a name="cfiledialogdomodal"></a><a name="domodal"></a>CFileDialog::DoModal

Chame esta função para exibir a caixa de diálogo de arquivo comum do Windows e permitir que o usuário navegue por arquivos e diretórios e digite um nome de arquivo.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Valor retornado

IDOK ou IDCANCEL. Se o IDCANCEL for retornado, ligue para a função [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) do Windows para determinar se ocorreu um erro.

IDOK e IDCANCEL são constantes que indicam se o usuário selecionou o botão OK ou Cancel.

### <a name="remarks"></a>Comentários

Se você quiser inicializar as várias opções de `m_ofn` caixa de diálogo de `DoModal`arquivo definindo membros da estrutura, você deve fazer isso antes de chamar, mas depois que o objeto de diálogo for construído.

Por exemplo, se você quiser permitir que o usuário selecione `DoModal`vários arquivos, defina o OFN_ALLOWMULTISELECT sinalizador antes de chamar, como mostrado no exemplo de código neste tópico.

Quando o usuário clica nos botões OK ou Cancel da caixa de diálogo ou seleciona a opção Fechar no menu de controle da caixa de diálogo, o controle é retornado ao seu aplicativo. Em seguida, você pode chamar outras funções de membro para recuperar as configurações ou informações que o usuário insere na caixa de diálogo.

`DoModal`é uma função virtual substituída `CDialog`da classe.

### <a name="example"></a>Exemplo

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

## <a name="cfiledialogenableopendropdown"></a><a name="enableopendropdown"></a>cfileDialog::HabilitarOpenDropDown

Habilita uma lista de parada no botão Abrir ou Salvar na caixa de diálogo.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A id da lista de paradas.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogendvisualgroup"></a><a name="endvisualgroup"></a>cfiledialog::EndvisualGroup

Impede a adição de elementos a um grupo visual no diálogo.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Valor retornado

Os retornos S_OK se forem bem sucedidos; um valor de erro de outra forma.

### <a name="remarks"></a>Comentários

## <a name="cfiledialoggetcheckbuttonstate"></a><a name="getcheckbuttonstate"></a>cfiledialog::getCheckbuttonstate

Recupera o estado atual de um botão de seleção (caixa de seleção) na caixa de diálogo.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A id da caixa de seleção.

*bChecked*<br/>
O estado da caixa de seleção. TRUE indica verificado; FALSO indica descontrolado.

### <a name="remarks"></a>Comentários

## <a name="cfiledialoggetcontrolitemstate"></a><a name="getcontrolitemstate"></a>cfiledialog::GetControlItemState

Recupera o estado atual de um item em um controle de contêiner encontrado na caixa de diálogo.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
O ID do item.

*Dwstate*<br/>
Uma referência a uma variável que recebe um dos valores a mais da enumeração CDCONTROLSTATE que indica o estado atual do controle.

### <a name="remarks"></a>Comentários

## <a name="cfiledialoggetcontrolstate"></a><a name="getcontrolstate"></a>cfiledialog::getcontrolstate

Recupera a visibilidade atual e os estados habilitados de um determinado controle.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A id do controle.

*Dwstate*<br/>
Uma referência a uma variável que recebe um ou mais valores da enumeração CDCONTROLSTATE que indica o estado atual do controle.

### <a name="remarks"></a>Comentários

## <a name="cfiledialoggeteditboxtext"></a><a name="geteditboxtext"></a>cfiledialog::getEditBoxText

Recupera o texto atual em um controle de caixa de edição.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID da caixa de edição.

*strText*<br/>
O valor do texto.

### <a name="remarks"></a>Comentários

## <a name="cfiledialoggetfileext"></a><a name="getfileext"></a>CFileDialog::GetFileExt

Chame esta função para recuperar a extensão do nome do arquivo inserido na caixa de diálogo.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Valor retornado

A extensão do nome do arquivo.

### <a name="remarks"></a>Comentários

Por exemplo, se o nome do arquivo inserido for DATA. TXT, `GetFileExt` retorna "TXT".

Se `m_ofn.Flags` tiver o OFN_ALLOWMULTISELECT conjunto de bandeiras, esta seqüência contém uma seqüência de strings terminadas por nulo, com a primeira seqüência sendo o caminho do diretório do grupo de arquivos selecionado, seguido pelos nomes de todos os arquivos selecionados pelo usuário. Para recuperar nomes de caminhos de arquivo, use as funções de membro [GetStartPosition](#getstartposition) e [GetNextPathName.](#getnextpathname)

## <a name="cfiledialoggetfilename"></a><a name="getfilename"></a>cfiledialog::getFileName

Chame esta função para recuperar o nome do arquivo inserido na caixa de diálogo.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Valor retornado

O nome do arquivo.

### <a name="remarks"></a>Comentários

O nome do arquivo inclui tanto o prefixo quanto a extensão. Por exemplo, `GetFileName` retornará "Texto. DAT" para o arquivo C:\FILES\TEXT.DAT.

Se `m_ofn.Flags` tiver `OFN_ALLOWMULTISELECT` o conjunto de sinalizadores, você deve chamar [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) para recuperar um nome de caminho do arquivo.

## <a name="cfiledialoggetfiletitle"></a><a name="getfiletitle"></a>cfiledialog::getFileTitle

Chame esta função para recuperar o título do arquivo inserido na caixa de diálogo.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Valor retornado

O título do arquivo.

### <a name="remarks"></a>Comentários

O título do arquivo inclui apenas o seu prefixo, sem o caminho ou a extensão. Por exemplo, `GetFileTitle` retornará "TEXTO" para o arquivo C:\FILES\TEXT.DAT.

Se `m_ofn.Flags` tiver o OFN_ALLOWMULTISELECT conjunto de bandeiras, esta seqüência contém uma seqüência de strings terminadas por nulo, com a primeira seqüência sendo o caminho do diretório do grupo de arquivos selecionado, seguido pelos nomes de todos os arquivos selecionados pelo usuário. Por essa razão, use as funções [getstartposition](#getstartposition) e [getnextpathname](#getnextpathname) para recuperar o próximo nome do arquivo na lista.

### <a name="example"></a>Exemplo

  Veja o exemplo de [CFileDialog::DoModal](#domodal).

## <a name="cfiledialoggetfolderpath"></a><a name="getfolderpath"></a>cfiledialog::getfolderpathPath

Chame esta função de membro para recuperar o caminho da pasta ou diretório atualmente aberto para uma caixa de diálogo aberta no estilo Explorer ou Save As comum.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Valor retornado

Um objeto [CString](../../atl-mfc-shared/reference/cstringt-class.md) contendo a pasta ou diretório atualmente aberto.

### <a name="remarks"></a>Comentários

A caixa de diálogo deve ter sido criada com o estilo OFN_EXPLORER; caso contrário, o método falhará com uma afirmação.

Você só pode chamar esse método enquanto a caixa de diálogo estiver sendo exibida. Depois que a caixa de diálogo for fechada, essa função não funcionará mais e o método falhará com uma afirmação.

## <a name="cfiledialoggetifiledialogcustomize"></a><a name="getifiledialogcustomize"></a>cfiledialog::getiFileDialogCustom

Recupera um ponteiro para o objeto COM interno para um determinado [CFileDialog](../../mfc/reference/cfiledialog-class.md).

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Valor retornado

O ponteiro para o objeto `CFileDialog`COM interno para o . É sua responsabilidade liberar este ponteiro apropriadamente.

### <a name="remarks"></a>Comentários

Use esta função apenas no Windows Vista ou posteriormente com um objeto que tenha *bVistaStyle* definido como TRUE. Se você usar esta função quando *bVistaStyle* for FALSE, ele retornará NULL no modo de liberação e lançará uma afirmação no modo de depuração.

Para obter mais `IFileDialogCustomize` informações sobre a interface, consulte [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Exemplo

Este exemplo recupera o objeto COM interno. Para executar este exemplo de código, você deve compilá-lo no Windows Vista ou mais tarde.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

## <a name="cfiledialoggetifileopendialog"></a><a name="getifileopendialog"></a>cfiledialog::getifileopendialog

Recupera um ponteiro para o objeto `CFileDialog`COM interno para um dado .

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Valor retornado

O ponteiro para o objeto `CFileDialog`COM interno para o . É sua responsabilidade liberar este ponteiro apropriadamente.

### <a name="remarks"></a>Comentários

Use esta função apenas no Windows Vista ou posteriormente com um objeto que tenha *bVistaStyle* definido como TRUE. Esta função retorna `CFileDialog` NULL se não for uma caixa de diálogo **Abrir** ou se *bVistaStyle* estiver definido como FALSE. Neste caso final, a função só retorna NULL no modo de liberação - no modo de depuração ele vai lançar uma afirmação.

Para obter mais `IFileOpenDialog` informações sobre a interface, consulte [IFileOpenDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Exemplo

Este exemplo recupera o objeto COM interno. Para executar este código, você deve compilá-lo no Windows Vista ou mais tarde.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

## <a name="cfiledialoggetifilesavedialog"></a><a name="getifilesavedialog"></a>cfiledialog::getiFileSavedialog

Recupera um ponteiro para o objeto `CFileDialog`COM interno para um dado .

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Valor retornado

O ponteiro para o objeto `CFileDialog`COM interno para o . É sua responsabilidade liberar este ponteiro apropriadamente.

### <a name="remarks"></a>Comentários

Use esta função apenas no Windows Vista ou posteriormente com um objeto que tenha *bVistaStyle* definido como TRUE. Esta função retornará `CFileDialog` NULL se não for uma caixa de diálogo **Salvar** ou se *bVistaStyle* estiver definido como FALSE. Neste caso final, a função só retorna NULL no modo de liberação - no modo de depuração ele vai lançar uma afirmação.

Para obter mais `IFileSaveDialog` informações sobre a interface, consulte [IFileSaveDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Exemplo

Este exemplo recupera o objeto COM interno. Para executar este exemplo de código, você deve compilá-lo no Windows Vista ou mais tarde.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

## <a name="cfiledialoggetnextpathname"></a><a name="getnextpathname"></a>cfiledialog::getNextPathName

Chame esta função para recuperar o próximo nome de arquivo do grupo selecionado na caixa de diálogo.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Parâmetros

*Pos*<br/>
Uma referência a um valor DE `GetNextPathName` `GetStartPosition` POSIÇÃO retornado por uma chamada anterior ou de função. NULL se o fim da lista tiver sido alcançado.

### <a name="return-value"></a>Valor retornado

O caminho completo do arquivo.

### <a name="remarks"></a>Comentários

O caminho do nome do arquivo inclui o título do arquivo mais todo o caminho do diretório. Por exemplo, `GetNextPathName` retornará "C:\FILES\TEXT. DAT" para o arquivo C:\FILES\TEXT.DAT. Você pode `GetNextPathName` usar em um loop de iteração para `GetStartPosition`frente se estabelecer a posição inicial com uma chamada para .

Se a seleção consistir em apenas um arquivo, esse nome do arquivo será devolvido.

## <a name="cfiledialoggetofn"></a><a name="getofn"></a>cfiledialog::getOFN

Recupera a `OPENFILENAME` estrutura associada.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Valor retornado

Uma estrutura [OPENFILENAME.](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)

### <a name="remarks"></a>Comentários

Use a segunda versão desta função para inicializar a aparência de uma caixa de diálogo **Abrir ou** Salvar **arquivos como** caixa de diálogo depois de construída, mas antes de ser exibida com a `DoModal` função de membro. Por exemplo, você `lpstrTitle` pode `m_ofn` definir o membro da legenda que deseja que a caixa de diálogo tenha.

## <a name="cfiledialoggetpathname"></a><a name="getpathname"></a>cfiledialog::getPathName

Chame esta função para recuperar o caminho completo do arquivo inserido na caixa de diálogo.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Valor retornado

O caminho completo do arquivo.

### <a name="remarks"></a>Comentários

O caminho do nome do arquivo inclui o título do arquivo mais todo o caminho do diretório. Por exemplo, `GetPathName` retornará "C:\FILES\TEXT. DAT" para o arquivo C:\FILES\TEXT.DAT.

Se `m_ofn.Flags` tiver o OFN_ALLOWMULTISELECT conjunto de bandeiras, esta seqüência contém uma seqüência de strings anuladas, com a primeira seqüência sendo o caminho de diretório do grupo de arquivos selecionado, seguido pelos nomes de todos os arquivos selecionados pelo usuário. Por essa razão, use as funções [getstartposition](#getstartposition) e [getnextpathname](#getnextpathname) para recuperar o próximo nome do arquivo na lista.

### <a name="example"></a>Exemplo

  Veja o exemplo de [CFileDialog::DoModal](#domodal).

## <a name="cfiledialoggetreadonlypref"></a><a name="getreadonlypref"></a>cfiledialog::GetReadOnlyPref

Chame esta função para determinar se a caixa de seleção Somente leitura foi selecionada nas caixas de diálogo Abrir e Salvar arquivos como caixa de diálogo Do windows standard File Open and File Save As.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Valor retornado

Não-zero se a caixa de seleção Somente leitura na caixa de diálogo estiver selecionada; caso contrário, 0.

### <a name="remarks"></a>Comentários

Você pode ocultar a caixa de seleção Somente leitura definindo o estilo OFN_HIDEREADONLY no `CFileDialog` construtor.

> [!NOTE]
> Os objetos `CFileDialog` de estilo Windows Vista ou posteriores não suportam essa função. Tentar usar essa função em um estilo `CFileDialog` do Windows Vista ou posterior jogará [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

## <a name="cfiledialoggetresult"></a><a name="getresult"></a>cfiledialog::getResult

Recupera a escolha que o usuário fez na caixa de diálogo.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para um IShellItem que representa a escolha do usuário.

### <a name="remarks"></a>Comentários

## <a name="cfiledialoggetresults"></a><a name="getresults"></a>cfiledialog::getResults

Recupera as escolhas do usuário em uma caixa de diálogo que permite a seleção múltipla.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para um IShellItemArray através do qual os itens selecionados na caixa de diálogo podem ser acessados.

### <a name="remarks"></a>Comentários

## <a name="cfiledialoggetselectedcontrolitem"></a><a name="getselectedcontrolitem"></a>cfiledialog::GetSelectedControlItem

Recupera um item específico do controle de contêiner especificado na caixa de diálogo.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
O ID do item que o usuário selecionou no controle.

### <a name="remarks"></a>Comentários

## <a name="cfiledialoggetstartposition"></a><a name="getstartposition"></a>cfiledialog::getStartPosition

Chame esta função de membro para recuperar a posição do `m_ofn.Flags` primeiro nome de caminho do arquivo na lista, se tiver o OFN_ALLOWMULTISELECT marca de bandeira.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Valor retornado

Um valor de POSIÇÃO que pode ser usado para iteração; NULO se a lista estiver vazia.

## <a name="cfiledialoghidecontrol"></a><a name="hidecontrol"></a>cfiledialog::Ocultar controle

Chame esta função de membro para ocultar o controle especificado em uma caixa de diálogo aberta ou save as comum no estilo Explorer.

```cpp
void HideControl(int nID);
```

### <a name="parameters"></a>Parâmetros

*nID*<br/>
A id do controle para esconder.

### <a name="remarks"></a>Comentários

A caixa de diálogo deve ter sido criada com o estilo OFN_EXPLORER; caso contrário, a função falhará com uma afirmação.

## <a name="cfiledialogispickfoldersmode"></a><a name="ispickfoldersmode"></a>CFileDialog::IsPickPastsMode

Determina se a caixa de diálogo atual está no modo seletor de pastas.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Valor retornado

TRUE se a caixa de diálogo estiver no modo seletor de pastas; caso contrário, FALSO.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogm_ofn"></a><a name="m_ofn"></a>CFileDialog::m_ofn

`m_ofn`é uma estrutura `OPENFILENAME`de tipo. Os dados nesta estrutura representam o `CFileDialog`estado atual do .

### <a name="remarks"></a>Comentários

Use esta estrutura para inicializar a aparência de uma caixa de diálogo **Abrir** ou **Salvar arquivos como** caixa de diálogo depois de construí-la, mas antes de exibi-la com o método [DoModal.](#domodal) Por exemplo, você pode definir o `m_ofn` membro *lpstrTitle* da legenda que deseja que a caixa de diálogo tenha.

Com o Windows Vista ou o `m_ofn` estilo posterior do [CFileDialog,](../../mfc/reference/cfiledialog-class.md)não é garantido que sempre corresponda ao estado da caixa de diálogo. Ele é sincronizado com a caixa de diálogo em versões anteriores do Windows. Veja [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) e [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog) para obter `m_ofn` mais `CFileDialog` informações sobre a sincronização da estrutura e do estado no Windows Vista ou posteriormente.

As diálogos de arquivo de estilo do Windows `CFileDialog`Vista ou posteriores não suportam certos membros e bandeiras do . Como resultado, isso não terá efeito.

A seguir está uma lista dos membros que não são suportados pelo Windows Vista ou posteriormente:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

As seguintes bandeiras não são suportadas e, portanto, não `CFileDialog`têm efeito quando você usa o Windows Vista ou o estilo posterior de :

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- Ofn_explorer

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES - efetivamente sempre ligado no Windows Vista ou posterior

- OFN_NOLONGNAMES - efetivamente sempre desligado no Windows Vista ou mais tarde

- OFN_NONETWORKBUTTON - efetivamente sempre ligado no Windows Vista ou posterior

- OFN_READONLY

- OFN_SHOWHELP

Para obter mais informações sobre essa estrutura, consulte a estrutura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) no SDK do Windows.

## <a name="cfiledialogmakeprominent"></a><a name="makeprominent"></a>cfiledialog::MakeProminent

Coloca um controle no diálogo para que ele se destaque em comparação com outros controles.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A id do controle.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogonbuttonclicked"></a><a name="onbuttonclicked"></a>cfiledialog::OnButtonClicked

Chamado quando o botão é clicado.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A id do botão.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogoncheckbuttontoggled"></a><a name="oncheckbuttontoggled"></a>cfiledialog::OnCheckButtonToggled

Chamado quando a caixa de seleção é verificada ou desmarcada.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A id da caixa de seleção.

*bChecked*<br/>
Verificado ou desmarcado.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogoncontrolactivating"></a><a name="oncontrolactivating"></a>CFileDialog::OnControlActivating

Chamado quando o controle é ativado.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A id do controle.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogonfilenamechange"></a><a name="onfilenamechange"></a>cfiledialog::OnFileNameChange

Anule este método se quiser lidar com a mensagem CDN_SELCHANGE WM_NOTIFY.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Comentários

O sistema envia a mensagem CDN_SELCHANGE quando o usuário seleciona um novo arquivo ou pasta na lista de arquivos da caixa de diálogo **Abrir** ou **Salvar como.** Anular este método se você quiser executar quaisquer ações em resposta a esta mensagem.

O sistema envia esta mensagem somente se a caixa de diálogo foi criada com a bandeira OFN_EXPLORER ligada. Para obter mais informações sobre a notificação, consulte [CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange). Para obter informações sobre o OFN_EXPLORER bandeira, consulte a estrutura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e [Abrir e Salvar como caixas de diálogo](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

## <a name="cfiledialogonfilenameok"></a><a name="onfilenameok"></a>cfiledialog::OnFilenameOK

Anular esta função somente se você quiser fornecer validação personalizada de nomes de arquivos inseridos em uma caixa de diálogo de arquivo comum.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Valor retornado

1 se o nome do arquivo não for um nome de arquivo válido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Esta função permite que você rejeite um nome de arquivo por qualquer razão específica do aplicativo. Normalmente, você não precisa usar essa função porque a estrutura fornece validação padrão de nomes de arquivos e exibe uma caixa de mensagem se um nome de arquivo inválido for inserido.

Se 1 for retornado, a caixa de diálogo permanecerá exibida para que o usuário digite outro nome de arquivo. O procedimento de diálogo descarta o diálogo se a devolução for 0. Outros valores de retorno não zero estão atualmente reservados e não devem ser usados.

## <a name="cfiledialogonfolderchange"></a><a name="onfolderchange"></a>cfiledialog::OnFolderChange

Anular esta função para lidar com a mensagem WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Comentários

A mensagem de notificação é enviada quando uma nova pasta é aberta na caixa de diálogo Abrir ou Salvar como.

A notificação só é enviada se a caixa de diálogo foi criada com o estilo OFN_EXPLORER. Para obter mais informações sobre a notificação, consulte [CDN_FOLDERCHANGE](/windows/win32/dlgbox/cdn-folderchange). Para obter informações sobre o estilo OFN_EXPLORER, consulte a estrutura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e [Abrir e Salvar como caixas de diálogo](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

## <a name="cfiledialogoninitdone"></a><a name="oninitdone"></a>cfiledialog::OnInitDone

Anular esta função para lidar com a mensagem CDN_INITDONE WM_NOTIFY.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Comentários

O sistema envia esta mensagem de notificação quando o sistema tiver terminado de organizar controles na caixa de diálogo **Abrir** ou **Salvar como** para abrir espaço para os controles da caixa de diálogo filho.

O sistema envia isso somente se a caixa de diálogo foi criada com o estilo OFN_EXPLORER. Para obter mais informações sobre a notificação, consulte [CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone). Para obter informações sobre o estilo OFN_EXPLORER, consulte a estrutura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e [Abrir e Salvar como caixas de diálogo](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

> [!NOTE]
> As diálogos de arquivo de estilo do Windows Vista ou posteriores não suportam essa função. Tentar usar essa função em uma caixa de diálogo de arquivo de estilo do Windows Vista ou posterior jogará [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

## <a name="cfiledialogonitemselected"></a><a name="onitemselected"></a>cfiledialog::OnItemSelecionado

Chamado quando o item do contêiner for selecionado.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
O ID do item.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogonlbselchangednotify"></a><a name="onlbselchangednotify"></a>cfiledialog::OnLBSelChangedNotificar

Esta função é chamada sempre que a seleção atual em uma caixa de lista está prestes a mudar.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Parâmetros

*nIDBox*<br/>
O ID da caixa de lista ou caixa de combinação em que a seleção ocorreu.

*Icursel*<br/>
O índice da seleção atual.

*Ncode*<br/>
O código de notificação de controle. Este parâmetro deve ter um dos seguintes valores:

- CD_LBSELCHANGE Especifica *iCurSel* é o item selecionado em uma caixa de lista de seleção única.

- CD_LBSELSUB Especifica que *o iCurSel* não está mais selecionado em uma caixa de lista de multiseleção.

- CD_LBSELADD Especifica que *o iCurSel* está selecionado em uma caixa de lista de multiseleção.

- CD_LBSELNOITEMS Especifica que não existe seleção em uma caixa de lista de multiseleção.

### <a name="remarks"></a>Comentários

Substituir esta função para fornecer o manuseio personalizado de alterações de seleção na caixa de lista. Por exemplo, você pode usar essa função para exibir os direitos de acesso ou a última alteração de data de cada arquivo que o usuário seleciona.

## <a name="cfiledialogonshareviolation"></a><a name="onshareviolation"></a>cfiledialog::onShareViolation

Anular esta função para fornecer o manuseio personalizado de violações de compartilhamento.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parâmetros

*Lpszpathname*<br/>
O caminho do arquivo em que a violação de compartilhamento ocorreu.

### <a name="return-value"></a>Valor retornado

Um dos seguintes valores:

- OFN_SHAREFALLTHROUGH O nome do arquivo é devolvido da caixa de diálogo.

- OFN_SHARENOWARN Nenhuma ação adicional precisa ser tomada.

- OFN_SHAREWARNO usuário recebe a mensagem de aviso padrão para este erro.

### <a name="remarks"></a>Comentários

Normalmente, você não precisa usar essa função porque o framework fornece verificação padrão de violações de compartilhamento e exibe uma caixa de mensagem se ocorrer uma violação de compartilhamento.

Se você quiser desativar a verificação de violação de compartilhamento, use `m_ofn.Flags`o operador bitwise OR para combinar o OFN_SHAREAWARE de bandeira com .

## <a name="cfiledialogontypechange"></a><a name="ontypechange"></a>cfiledialog::OnTypeChange

Anular esta função para lidar com a mensagem WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Comentários

A mensagem de notificação é enviada quando o usuário seleciona um novo tipo de arquivo da lista de tipos de arquivo na caixa de diálogo Abrir ou Salvar como.

A notificação só é enviada se a caixa de diálogo foi criada com o estilo OFN_EXPLORER. Para obter mais informações sobre a notificação, consulte [CDN_TYPECHANGE](/windows/win32/dlgbox/cdn-typechange). Para obter informações sobre o estilo OFN_EXPLORER, consulte a estrutura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e [Abrir e Salvar como caixas de diálogo](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

## <a name="cfiledialogremovecontrolitem"></a><a name="removecontrolitem"></a>cfilediálogo::RemoveControlItem

Remove um item de um controle de contêiner na caixa de diálogo.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID do controle do recipiente para remover o item.

*dwIDItem*<br/>
O ID do item.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogsetcheckbuttonstate"></a><a name="setcheckbuttonstate"></a>cfiledialog::setCheckButtonstate

Define o estado atual de um botão de seleção (caixa de seleção) na caixa de diálogo.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A id da caixa de seleção.

*bChecked*<br/>
O estado da caixa de seleção. TRUE indica verificado; FALSO indica descontrolado.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogsetcontrolitemstate"></a><a name="setcontrolitemstate"></a>cfileDiálogo::SetControlItemState

Define o estado atual de um item em um controle de contêiner encontrado na caixa de diálogo.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
O ID do item.

*Dwstate*<br/>
Um ou mais valores da enumeração CDCONTROLSTATE que indicam o novo estado do controle.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogsetcontrolitemtext"></a><a name="setcontrolitemtext"></a>cfileDiálogo::SetControlItemText

Define o texto de um item de controle. Por exemplo, o texto que acompanha um botão de rádio ou um item em um menu.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
O ID do item.

*strRótulo*<br/>
O texto do item.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogsetcontrollabel"></a><a name="setcontrollabel"></a>cfile 'Diálogo':'SetControl'

Define o texto associado a um controle, como texto de botão ou um rótulo de caixa de edição.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A id do controle.

*strRótulo*<br/>
O nome do controle.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogsetcontrolstate"></a><a name="setcontrolstate"></a>cfiledialog::setControlState

Define a visibilidade atual e os estados habilitados de um determinado controle.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A id do controle.

*Dwstate*<br/>
Um ou mais valores da enumeração CDCONTROLSTATE que indicam o estado atual do controle.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogsetcontroltext"></a><a name="setcontroltext"></a>cfileDialog::SetControlText

Chame este método para definir o texto para o controle especificado em uma caixa de diálogo **Abrir** ou **Salvar como** no estilo Explorer.

```cpp
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Parâmetros

*nID*<br/>
[em] O ID do controle para o qual definir o texto.

*Lpsz*<br/>
[em] Um ponteiro para a seqüência que contém o texto a definir para o controle.

### <a name="remarks"></a>Comentários

Ambas as versões desta função são válidas para aplicativos que usam Unicode. No entanto, apenas a versão com o tipo LPCSTR é válida para aplicações que usam ANSI.

Para usar este método, você deve criar a caixa de diálogo com o estilo OFN_EXPLORER. Caso contrário, a função falhará com uma afirmação.

## <a name="cfiledialogsetdefext"></a><a name="setdefext"></a>cfiledialog::SetDefExt

Chame esta função para definir a extensão de nome de arquivo padrão para uma caixa de diálogo aberta ou save as comum no estilo Explorer.

```cpp
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Parâmetros

*Lpsz*<br/>
Um ponteiro para uma seqüência contendo a extensão padrão a ser usada para o objeto da caixa de diálogo. Esta seqüência não deve conter um período (.).

### <a name="remarks"></a>Comentários

A caixa de diálogo deve ter sido criada com o estilo OFN_EXPLORER; caso contrário, a função falhará com uma afirmação.

## <a name="cfiledialogseteditboxtext"></a><a name="seteditboxtext"></a>cfileDialog::SetEditBoxText

Define o texto atual em um controle de caixa de edição.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
O ID da caixa de edição.

*strText*<br/>
O valor do texto.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogsetproperties"></a><a name="setproperties"></a>cfileDialog::SetPropriedades

Fornece um repositório de propriedades que define os valores padrão a serem usados para o item que está sendo salvo.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Parâmetros

*lpszPropList*<br/>
Uma lista de propriedades predefinidas separadas por ";". Para obter uma lista das bandeiras, consulte a seção **Sinalizadores** de [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew).

### <a name="remarks"></a>Comentários

## <a name="cfiledialogsetselectedcontrolitem"></a><a name="setselectedcontrolitem"></a>cfileDiálogo::ConjuntoConjuntoControledecontroleItem

Define o estado selecionado de um item específico em um grupo de botões de opção ou em uma caixa de combinação encontrada na caixa de diálogo.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
O ID do item que o usuário selecionou no controle.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogsettemplate"></a><a name="settemplate"></a>cfileDialog::SetTemplate

Define o modelo da caixa de diálogo para o objeto [CFileDialog.](../../mfc/reference/cfiledialog-class.md)

```cpp
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Parâmetros

*nWin3ID*<br/>
[em] Contém o número de ID do recurso `CFileDialog` de modelo para o objeto não-Explorer. Este modelo só é usado no Windows NT 3.51 ou quando o estilo OFN_EXPLORER não está presente.

*nWin4ID*<br/>
[em] Contém o número de ID do `CFileDialog` recurso de modelo para o objeto Explorer. Este modelo é usado apenas em versões Windows NT 4.0 e posteriores, Windows 95 e versões posteriores, ou quando o estilo OFN_EXPLORER está presente.

*lpWin3ID*<br/>
[em] Contém o nome do recurso de `CFileDialog` modelo para o objeto não-Explorer. Este modelo só é usado no Windows NT 3.51 ou quando o estilo OFN_EXPLORER não está presente.

*lpWin4ID*<br/>
[em] Contém o nome do recurso `CFileDialog` de modelo do objeto Explorer. Este modelo é usado apenas em versões Windows NT 4.0 e posteriores, Windows 95 e versões posteriores, ou quando o estilo OFN_EXPLORER está presente.

### <a name="remarks"></a>Comentários

O sistema usará apenas um dos modelos especificados. O sistema determina qual modelo usar com base na presença do estilo OFN_EXPLORER e do sistema operacional em que o aplicativo está sendo executado. Ao especificar um modelo não-Explorer e estilo Explorer, é fácil suportar windows NT 3.51, Windows NT 4.0 e versões posteriores do Windows NT, e Windows 95 e versões posteriores.

> [!NOTE]
> As caixas de diálogo de arquivo de estilo do Windows Vista ou posteriores não suportam essa função. Tentar usar essa função em uma caixa de diálogo de arquivo de estilo do Windows Vista ou posterior jogará [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Uma alternativa é usar um diálogo personalizado. Para obter mais informações `CFileDialog`sobre como usar um personalizado, consulte [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

## <a name="cfiledialogstartvisualgroup"></a><a name="startvisualgroup"></a>cfiledialog::StartVisualGroup

Declara um grupo visual na caixa de diálogo. Chamadas subseqüentes a qualquer método de "adicionar" adicionam esses elementos a este grupo.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A identidade do grupo visual.

*strRótulo*<br/>
O nome do grupo.

### <a name="remarks"></a>Comentários

## <a name="cfiledialogupdateofnfromshelldialog"></a><a name="updateofnfromshelldialog"></a>cfiledialog::updateOFnFromShellDialog

Atualiza a `m_ofn` estrutura de dados do [CFileDialog](../../mfc/reference/cfiledialog-class.md) com base no estado atual do objeto interno.

```cpp
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Comentários

Nas versões do Windows antes do Windows Vista, a estrutura de `CFileDialog`dados DO MEMBRO [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) foi continuamente sincronizada com o estado do . Quaisquer alterações na variável [membro m_ofn](#m_ofn) afetaram diretamente o estado da caixa de diálogo. Além disso, qualquer alteração no estado da caixa de diálogo atualizou imediatamente a variável membro m_ofn.

No Windows Vista ou `m_ofn` posterior, a estrutura de dados não é atualizada automaticamente. Para garantir a exatidão dos `m_ofn` dados na variável `UpdateOFNFromShellDialog` membro, você deve ligar para a função antes de acessar os dados. O Windows chama essa função automaticamente durante o processamento do [IFileDialog::OnFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Para obter mais informações `CFileDialog` sobre como usar a classe no Windows Vista ou posterior, consulte [CFileDialog Class](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Exemplo

Este exemplo atualiza `CFileDialog` o antes de exibi-lo. Antes de `m_ofn` atualizar a variável membro, precisamos sincronizá-la ao estado atual da caixa de diálogo.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Confira também

[Classe CCommonDialog](../../mfc/reference/ccommondialog-class.md)<br/>
[Gráfico da hierarquia](../../mfc/hierarchy-chart.md)
