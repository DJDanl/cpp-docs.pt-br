---
title: Classe CWinAppEx
ms.date: 11/04/2016
f1_keywords:
- CWinAppEx
- AFXWINAPPEX/CWinAppEx
- AFXWINAPPEX/CWinAppEx::CWinAppEx
- AFXWINAPPEX/CWinAppEx::CleanState
- AFXWINAPPEX/CWinAppEx::EnableLoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::EnableTearOffMenus
- AFXWINAPPEX/CWinAppEx::EnableUserTools
- AFXWINAPPEX/CWinAppEx::ExitInstance
- AFXWINAPPEX/CWinAppEx::GetBinary
- AFXWINAPPEX/CWinAppEx::GetContextMenuManager
- AFXWINAPPEX/CWinAppEx::GetDataVersion
- AFXWINAPPEX/CWinAppEx::GetDataVersionMajor
- AFXWINAPPEX/CWinAppEx::GetDataVersionMinor
- AFXWINAPPEX/CWinAppEx::GetInt
- AFXWINAPPEX/CWinAppEx::GetKeyboardManager
- AFXWINAPPEX/CWinAppEx::GetMouseManager
- AFXWINAPPEX/CWinAppEx::GetObject
- AFXWINAPPEX/CWinAppEx::GetRegSectionPath
- AFXWINAPPEX/CWinAppEx::GetRegistryBase
- AFXWINAPPEX/CWinAppEx::GetSectionBinary
- AFXWINAPPEX/CWinAppEx::GetSectionInt
- AFXWINAPPEX/CWinAppEx::GetSectionObject
- AFXWINAPPEX/CWinAppEx::GetSectionString
- AFXWINAPPEX/CWinAppEx::GetShellManager
- AFXWINAPPEX/CWinAppEx::GetString
- AFXWINAPPEX/CWinAppEx::GetTooltipManager
- AFXWINAPPEX/CWinAppEx::GetUserToolsManager
- AFXWINAPPEX/CWinAppEx::InitContextMenuManager
- AFXWINAPPEX/CWinAppEx::InitKeyboardManager
- AFXWINAPPEX/CWinAppEx::InitMouseManager
- AFXWINAPPEX/CWinAppEx::InitShellManager
- AFXWINAPPEX/CWinAppEx::InitTooltipManager
- AFXWINAPPEX/CWinAppEx::IsResourceSmartUpdate
- AFXWINAPPEX/CWinAppEx::IsStateExists
- AFXWINAPPEX/CWinAppEx::LoadState
- AFXWINAPPEX/CWinAppEx::OnAppContextHelp
- AFXWINAPPEX/CWinAppEx::OnViewDoubleClick
- AFXWINAPPEX/CWinAppEx::OnWorkspaceIdle
- AFXWINAPPEX/CWinAppEx::SaveState
- AFXWINAPPEX/CWinAppEx::SetRegistryBase
- AFXWINAPPEX/CWinAppEx::ShowPopupMenu
- AFXWINAPPEX/CWinAppEx::WriteBinary
- AFXWINAPPEX/CWinAppEx::WriteInt
- AFXWINAPPEX/CWinAppEx::WriteObject
- AFXWINAPPEX/CWinAppEx::WriteSectionBinary
- AFXWINAPPEX/CWinAppEx::WriteSectionInt
- AFXWINAPPEX/CWinAppEx::WriteSectionObject
- AFXWINAPPEX/CWinAppEx::WriteSectionString
- AFXWINAPPEX/CWinAppEx::WriteString
- AFXWINAPPEX/CWinAppEx::LoadCustomState
- AFXWINAPPEX/CWinAppEx::LoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::OnClosingMainFrame
- AFXWINAPPEX/CWinAppEx::PreLoadState
- AFXWINAPPEX/CWinAppEx::PreSaveState
- AFXWINAPPEX/CWinAppEx::ReloadWindowPlacement
- AFXWINAPPEX/CWinAppEx::SaveCustomState
- AFXWINAPPEX/CWinAppEx::StoreWindowPlacement
- AFXWINAPPEX/CWinAppEx::m_bForceImageReset
helpviewer_keywords:
- CWinAppEx [MFC], CWinAppEx
- CWinAppEx [MFC], CleanState
- CWinAppEx [MFC], EnableLoadWindowPlacement
- CWinAppEx [MFC], EnableTearOffMenus
- CWinAppEx [MFC], EnableUserTools
- CWinAppEx [MFC], ExitInstance
- CWinAppEx [MFC], GetBinary
- CWinAppEx [MFC], GetContextMenuManager
- CWinAppEx [MFC], GetDataVersion
- CWinAppEx [MFC], GetDataVersionMajor
- CWinAppEx [MFC], GetDataVersionMinor
- CWinAppEx [MFC], GetInt
- CWinAppEx [MFC], GetKeyboardManager
- CWinAppEx [MFC], GetMouseManager
- CWinAppEx [MFC], GetObject
- CWinAppEx [MFC], GetRegSectionPath
- CWinAppEx [MFC], GetRegistryBase
- CWinAppEx [MFC], GetSectionBinary
- CWinAppEx [MFC], GetSectionInt
- CWinAppEx [MFC], GetSectionObject
- CWinAppEx [MFC], GetSectionString
- CWinAppEx [MFC], GetShellManager
- CWinAppEx [MFC], GetString
- CWinAppEx [MFC], GetTooltipManager
- CWinAppEx [MFC], GetUserToolsManager
- CWinAppEx [MFC], InitContextMenuManager
- CWinAppEx [MFC], InitKeyboardManager
- CWinAppEx [MFC], InitMouseManager
- CWinAppEx [MFC], InitShellManager
- CWinAppEx [MFC], InitTooltipManager
- CWinAppEx [MFC], IsResourceSmartUpdate
- CWinAppEx [MFC], IsStateExists
- CWinAppEx [MFC], LoadState
- CWinAppEx [MFC], OnAppContextHelp
- CWinAppEx [MFC], OnViewDoubleClick
- CWinAppEx [MFC], OnWorkspaceIdle
- CWinAppEx [MFC], SaveState
- CWinAppEx [MFC], SetRegistryBase
- CWinAppEx [MFC], ShowPopupMenu
- CWinAppEx [MFC], WriteBinary
- CWinAppEx [MFC], WriteInt
- CWinAppEx [MFC], WriteObject
- CWinAppEx [MFC], WriteSectionBinary
- CWinAppEx [MFC], WriteSectionInt
- CWinAppEx [MFC], WriteSectionObject
- CWinAppEx [MFC], WriteSectionString
- CWinAppEx [MFC], WriteString
- CWinAppEx [MFC], LoadCustomState
- CWinAppEx [MFC], LoadWindowPlacement
- CWinAppEx [MFC], OnClosingMainFrame
- CWinAppEx [MFC], PreLoadState
- CWinAppEx [MFC], PreSaveState
- CWinAppEx [MFC], ReloadWindowPlacement
- CWinAppEx [MFC], SaveCustomState
- CWinAppEx [MFC], StoreWindowPlacement
- CWinAppEx [MFC], m_bForceImageReset
ms.assetid: a3d3e053-3e22-463f-9444-c73abb1bb9d7
ms.openlocfilehash: c222567703d0e57480c00f6f2bf9e78f16979150
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/16/2020
ms.locfileid: "79420879"
---
# <a name="cwinappex-class"></a>Classe CWinAppEx

`CWinAppEx` manipula o estado do aplicativo, salva o estado no registro, carrega o estado do registro, inicializa os gerenciadores de aplicativos e fornece links para esses mesmos gerenciadores de aplicativos.

   Para obter mais detalhes, consulte o código-fonte localizado no **VC\\atlmfc\\src\\pasta MFC** da sua instalação do Visual Studio.
## <a name="syntax"></a>Sintaxe

```
class CWinAppEx : public CWinApp
```

## <a name="members"></a>Membros

### <a name="public-constructors"></a>Construtores públicos

|Nome|DESCRIÇÃO|
|----------|-----------------|
|[CWinAppEx::CWinAppEx](#cwinappex)|Constrói um objeto `CWinAppEx`.|

### <a name="public-methods"></a>Métodos públicos

|Nome|DESCRIÇÃO|
|----------|-----------------|
|[CWinAppEx:: Cleanstate](#cleanstate)|Remove informações sobre o aplicativo do registro do Windows.|
|[CWinAppEx::EnableLoadWindowPlacement](#enableloadwindowplacement)|Especifica se o aplicativo carregará o tamanho inicial e o local da janela do quadro principal do registro.|
|[CWinAppEx::EnableTearOffMenus](#enabletearoffmenus)|Habilita menus suspensos para o aplicativo.|
|[CWinAppEx::EnableUserTools](#enableusertools)|Permite que o usuário crie comandos de menu personalizados no aplicativo.|
|[CWinAppEx:: ExitInstance](#exitinstance)|Chamado pelo Framework de dentro da função de membro `Run` para sair desta instância do aplicativo. (Substitui [CWinApp:: ExitInstance](../../mfc/reference/cwinapp-class.md#exitinstance).)|
|[CWinAppEx:: getbinary](#getbinary)|Lê dados binários associados ao valor de registro especificado.|
|[CWinAppEx:: GetContextMenuManager](#getcontextmenumanager)|Retorna um ponteiro para o objeto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) global.|
|[CWinAppEx::GetDataVersion](#getdataversion)||
|[CWinAppEx::GetDataVersionMajor](#getdataversionmajor)|Retorna a versão principal do aplicativo salvo no registro do Windows.|
|[CWinAppEx::GetDataVersionMinor](#getdataversionminor)|Retorna a versão secundária do aplicativo salvo no registro do Windows.|
|[CWinAppEx:: GetInt](#getint)|Lê dados numéricos associados ao valor especificado do registro.|
|[CWinAppEx:: GetKeyboardManager](#getkeyboardmanager)|Retorna um ponteiro para o objeto [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) global.|
|[CWinAppEx:: getratomanager](#getmousemanager)|Retorna um ponteiro para o objeto [CMouseManager](../../mfc/reference/cmousemanager-class.md) global.|
|[CWinAppEx:: GetObject](#getobject)|Lê `CObject`dados derivados associados ao valor especificado do registro.|
|[CWinAppEx::GetRegSectionPath](#getregsectionpath)|Retorna uma cadeia de caracteres que é o caminho de uma chave do registro. Esse caminho concatena o caminho relativo fornecido com o caminho do aplicativo.|
|[CWinAppEx::GetRegistryBase](#getregistrybase)|Retorna o caminho do registro para o aplicativo.|
|[CWinAppEx::GetSectionBinary](#getsectionbinary)|Lê dados binários associados à chave e ao valor especificados do registro.|
|[CWinAppEx::GetSectionInt](#getsectionint)|Lê dados numéricos do registro associado à chave e ao valor especificados.|
|[CWinAppEx:: getsectionobject](#getsectionobject)|Lê `CObject` dados associados à chave e ao valor especificados do registro.|
|[CWinAppEx:: getseçãostring](#getsectionstring)|Lê dados de cadeia de caracteres associados à chave e ao valor especificados do registro.|
|[CWinAppEx:: GetShellManager](#getshellmanager)|Retorna um ponteiro para o objeto [CShellManager](../../mfc/reference/cshellmanager-class.md) global.|
|[CWinAppEx:: GetString](#getstring)|Lê dados de cadeia de caracteres associados ao valor especificado do registro.|
|[CWinAppEx:: GetTooltipManager](#gettooltipmanager)|Retorna um ponteiro para o objeto [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) global.|
|[CWinAppEx::GetUserToolsManager](#getusertoolsmanager)|Retorna um ponteiro para o objeto [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) global.|
|[CWinAppEx::InitContextMenuManager](#initcontextmenumanager)|Inicializa o objeto `CContextMenuManager`.|
|[CWinAppEx::InitKeyboardManager](#initkeyboardmanager)|Inicializa o objeto `CKeyboardManager`.|
|[CWinAppEx::InitMouseManager](#initmousemanager)|Inicializa o objeto `CMouseManager`.|
|[CWinAppEx::InitShellManager](#initshellmanager)|Inicializa a classe de `CShellManager`|
|[CWinAppEx::InitTooltipManager](#inittooltipmanager)|Inicializa a classe `CTooltipManager`.|
|[CWinAppEx::IsResourceSmartUpdate](#isresourcesmartupdate)||
|[CWinAppEx::IsStateExists](#isstateexists)|Indica se a chave especificada está no registro.|
|[CWinAppEx:: LoadState](#loadstate)|Carrega o estado do aplicativo do registro.|
|[CWinAppEx::OnAppContextHelp](#onappcontexthelp)|Chamado pelo Framework quando o usuário solicita ajuda de contexto para a caixa de diálogo de **personalização** .|
|[CWinAppEx::OnViewDoubleClick](#onviewdoubleclick)|Chama o comando definido pelo usuário quando o usuário clica duas vezes em qualquer lugar no aplicativo.|
|[CWinAppEx::OnWorkspaceIdle](#onworkspaceidle)||
|[CWinAppEx:: SaveState](#savestate)|Grava o estado da estrutura do aplicativo no registro do Windows.|
|[CWinAppEx::SetRegistryBase](#setregistrybase)|Define o caminho da chave do registro padrão. Essa chave servirá como uma raiz para todas as chamadas de registro subsequentes.|
|[CWinAppEx::ShowPopupMenu](#showpopupmenu)|Exibe um menu pop-up.|
|[CWinAppEx::WriteBinary](#writebinary)|Grava os dados binários no valor do registro especificado.|
|[CWinAppEx::WriteInt](#writeint)|Grava os dados numéricos no valor do registro especificado.|
|[CWinAppEx:: WriteObject](#writeobject)|Grava os dados que são derivados da [classe CObject](../../mfc/reference/cobject-class.md) para o valor de registro especificado.|
|[CWinAppEx::WriteSectionBinary](#writesectionbinary)|Grava os dados binários em um valor da chave do Registro especificada.|
|[CWinAppEx::WriteSectionInt](#writesectionint)|Grava os dados numéricos em um valor da chave do Registro especificada.|
|[CWinAppEx::WriteSectionObject](#writesectionobject)|Grava dados derivados da classe `CObject` para um valor da chave do Registro especificada.|
|[CWinAppEx::WriteSectionString](#writesectionstring)|Grava os dados da cadeia de caracteres em um valor da chave do Registro especificada.|
|[CWinAppEx:: WriteString](#writestring)|Grava os dados de cadeia de caracteres no valor de registro especificado.|

### <a name="protected-methods"></a>Métodos protegidos

|Nome|DESCRIÇÃO|
|----------|-----------------|
|[CWinAppEx:: loadcustomstate](#loadcustomstate)|Chamado pelo Framework quando o estado do aplicativo é carregado.|
|[CWinAppEx::LoadWindowPlacement](#loadwindowplacement)|Chamado pelo Framework quando ele carrega o tamanho e o local do seu aplicativo do registro. Os dados carregados incluem o tamanho e o local do quadro principal no momento em que o aplicativo foi fechado pela última vez.|
|[CWinAppEx::OnClosingMainFrame](#onclosingmainframe)|Chamado pelo Framework quando uma janela do quadro principal está processando WM_CLOSE.|
|[CWinAppEx::P reloadstate](#preloadstate)|Chamado pelo Framework imediatamente antes de o estado do aplicativo ser carregado.|
|[CWinAppEx::P salvar novamente](#presavestate)|Chamado pelo Framework imediatamente antes de o estado do aplicativo ser salvo.|
|[CWinAppEx::ReloadWindowPlacement](#reloadwindowplacement)|Recarrega o tamanho e o local da janela fornecida a partir do registro|
|[CWinAppEx::SaveCustomState](#savecustomstate)|Chamado pelo Framework depois de gravar o estado do aplicativo no registro.|
|[CWinAppEx::StoreWindowPlacement](#storewindowplacement)|Chamado pelo Framework para gravar o tamanho e o local do quadro principal no registro.|

### <a name="data-members"></a>Membros de dados

|Nome|DESCRIÇÃO|
|----------|-----------------|
|[CWinAppEx:: m_bForceImageReset](#m_bforceimagereset)|Especifica se a estrutura redefinirá todas as imagens da barra de ferramentas quando a janela do quadro que contém a barra de ferramentas for carregada.|

## <a name="remarks"></a>Comentários

Grande parte da funcionalidade fornecida pela estrutura MFC depende da classe `CWinAppEx`. Você pode incorporar a classe `CWinAppEx` em seu aplicativo de uma das duas maneiras:

- Construa uma classe de `CWinAppEx` no thread principal.

- Derive a classe de aplicativo principal de `CWinAppEx`.

Depois de incorporar `CWinAppEx` ao seu aplicativo, você pode inicializar qualquer um dos gerenciadores de aplicativos. Antes de usar um Gerenciador de aplicativos, você deve inicializá-lo chamando o método Initialize apropriado. Para obter um ponteiro para um gerente específico, chame o método Get associado. A classe `CWinAppEx` gerencia os seguintes gerenciadores de aplicativos: classe [CMouseManager](../../mfc/reference/cmousemanager-class.md), classe [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), classe [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md), classe [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)e [classe CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md).

## <a name="inheritance-hierarchy"></a>Hierarquia de herança

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

[CWinApp](../../mfc/reference/cwinapp-class.md)

[CWinAppEx](../../mfc/reference/cwinappex-class.md)

## <a name="requirements"></a>Requisitos

**Cabeçalho:** afxwinappex. h

##  <a name="cleanstate"></a>CWinAppEx:: Cleanstate

Remove todas as informações sobre o aplicativo do registro do Windows.

```
virtual BOOL CleanState(LPCTSTR lpszSectionName=NULL);
```

### <a name="parameters"></a>parâmetros

*lpszSectionName*<br/>
no Uma cadeia de caracteres que contém um caminho de uma chave do registro.

### <a name="return-value"></a>Valor retornado

Diferente de zero se o método foi bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Esse método limpa os dados do aplicativo de uma seção específica do registro. Você pode especificar a seção a ser desmarcada usando o parâmetro *lpszSectionName*. Se *lpszSectionName* for NULL, esse método usará o caminho de registro padrão armazenado no objeto `CWinAppEx`. Para obter o caminho de registro padrão, use [CWinAppEx:: GetRegistryBase](#getregistrybase).

##  <a name="cwinappex"></a>CWinAppEx::CWinAppEx

Constrói um objeto `CWinAppEx`.

```
CWinAppEx(BOOL bResourceSmartUpdate = FALSE);
```

### <a name="parameters"></a>parâmetros

*bResourceSmartUpdate*<br/>
no Um parâmetro booliano que especifica se o objeto de espaço de trabalho deve detectar e manipular atualizações de recursos.

### <a name="remarks"></a>Comentários

A classe `CWinAppEx` tem métodos de inicialização, fornece funcionalidade para salvar e carregar informações do aplicativo no registro e controla as configurações globais do aplicativo. Ele também permite que você use gerentes globais, como a [Classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) e a [classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md). Cada aplicativo pode ter apenas uma instância da classe `CWinAppEx`.

##  <a name="enableloadwindowplacement"></a>CWinAppEx::EnableLoadWindowPlacement

Especifica se o aplicativo carregará o tamanho inicial e o local da janela do quadro principal do registro.

```
void EnableLoadWindowPlacement(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>parâmetros

*bEnable*<br/>
no Especifica se o aplicativo carrega o tamanho inicial e o local da janela do quadro principal do registro.

### <a name="remarks"></a>Comentários

Por padrão, o tamanho e o local do quadro principal são carregados do registro junto com outras configurações de aplicativo. Isso ocorre durante [CWinAppEx:: LoadState](#loadstate). Se você não quiser carregar o posicionamento inicial da janela do registro, chame esse método com *bEnable* definido como false.

##  <a name="enabletearoffmenus"></a>CWinAppEx::EnableTearOffMenus

Cria e inicializa um objeto [CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md) .

```
BOOL EnableTearOffMenus(
    LPCTSTR lpszRegEntry,
    const UINT uiCmdFirst,
    const UINT uiCmdLast);
```

### <a name="parameters"></a>parâmetros

*lpszRegEntry*<br/>
no Uma cadeia de caracteres que contém o caminho de uma chave do registro. O aplicativo usa essa chave do registro para armazenar informações para os menus destacáveis.

*uiCmdFirst*<br/>
no A ID do menu do primeiro desmontar.

*uiCmdLast*<br/>
no A ID do menu de última desmontagem.

### <a name="return-value"></a>Valor retornado

TRUE se o `CMenuTearOffManager` for criado e inicializado com êxito; FALSE se ocorrer um erro ou se o `CMenuTearOffManager` já existir.

### <a name="remarks"></a>Comentários

Use essa função para habilitar menus retirados em seu aplicativo. Você deve chamar essa função de `InitInstance`.

##  <a name="enableusertools"></a>CWinAppEx::EnableUserTools

Permite que o usuário crie comandos de menu personalizados que reduzem pressionamentos de teclas em seu aplicativo. Esse método cria um objeto [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) .

```
BOOL EnableUserTools(
    const UINT uiCmdToolsDummy,
    const UINT uiCmdFirst,
    const UINT uiCmdLast,
    CRuntimeClass* pToolRTC = RUNTIME_CLASS(CUserTool),
    UINT uArgMenuID = 0,
    UINT uInitDirMenuID = 0);
```

### <a name="parameters"></a>parâmetros

*uiCmdToolsDummy*<br/>
no Um inteiro sem sinal que a estrutura usa como um espaço reservado para a ID de comando do menu de ferramentas do usuário.

*uiCmdFirst*<br/>
no A ID de comando para o primeiro comando da ferramenta de usuário.

*uiCmdLast*<br/>
no A ID de comando para o último comando da ferramenta de usuário.

*pToolRTC*<br/>
no Uma classe que o objeto `CUserToolsManager` usa para criar novas ferramentas de usuário.

*uArgMenuID*<br/>
no A ID do menu de argumento.

*uInitDirMenuID*<br/>
no A ID do menu para o diretório de ferramentas inicial.

### <a name="return-value"></a>Valor retornado

TRUE se o método criar e inicializar um objeto `CUserToolsManager`; FALSE se o método falhar ou se um objeto de `CUserToolsManager` já existir.

### <a name="remarks"></a>Comentários

Quando você habilita ferramentas definidas pelo usuário, a estrutura oferece suporte automaticamente a um menu dinâmico que pode ser estendido durante a personalização. A estrutura associa cada novo item a um comando externo. A estrutura invoca esses comandos quando o usuário seleciona o item apropriado no menu **ferramentas** .

Toda vez que o usuário adiciona um novo item, a estrutura cria um novo objeto. O tipo de classe para o novo objeto é definido por *pToolRTC*. O tipo de classe *pToolRTC* deve ser derivado da [Classe CUserTool](../../mfc/reference/cusertool-class.md).

Para obter mais informações sobre as ferramentas de usuário e como incorporá-las a seu aplicativo, consulte [ferramentas definidas pelo usuário](../../mfc/user-defined-tools.md).

##  <a name="exitinstance"></a>CWinAppEx:: ExitInstance

```
virtual int ExitInstance();
```

### <a name="return-value"></a>Valor retornado

### <a name="remarks"></a>Comentários

##  <a name="getbinary"></a>CWinAppEx:: getbinary

Lê dados binários de uma chave do Registro especificada.

```
BOOL GetBinary(
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>parâmetros

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o nome de uma chave do registro.

*ppData*<br/>
fora Um ponteiro para o buffer que o método preenche com os dados binários.

*pBytes*<br/>
fora Um ponteiro para um inteiro sem sinal que o método usa para gravar o número de bytes lidos.

### <a name="return-value"></a>Valor retornado

Verdadeiro se for bem-sucedido; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Esse método lê dados binários gravados no registro. Para gravar dados no registro, use os métodos [CWinAppEx:: WriteBinary](#writebinary) e [CWinAppEx:: WriteSectionBinary](#writesectionbinary).

O parâmetro *lpszEntry* é o nome de uma entrada de registro localizada sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getcontextmenumanager"></a>CWinAppEx:: GetContextMenuManager

Retorna um ponteiro para o objeto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) global.

```
CContextMenuManager* GetContextMenuManager();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para o objeto de `CContextMenuManager` global.

### <a name="remarks"></a>Comentários

Se o objeto CContextMenuManager não for inicializado, essa função chamará [CWinAppEx:: InitContextMenuManager](#initcontextmenumanager) antes de retornar um ponteiro.

##  <a name="getdataversion"></a>CWinAppEx::GetDataVersion

```
int GetDataVersion() const;
```

### <a name="return-value"></a>Valor retornado

### <a name="remarks"></a>Comentários

##  <a name="getdataversionmajor"></a>CWinAppEx::GetDataVersionMajor

Retorna a versão principal do aplicativo que é salvo no registro do Windows quando você chama [CWinAppEx:: SaveState](#savestate).

```
int GetDataVersionMajor() const;
```

### <a name="return-value"></a>Valor retornado

Um valor inteiro que contém o número de versão principal.

##  <a name="getdataversionminor"></a>CWinAppEx::GetDataVersionMinor

Retorna a versão secundária do aplicativo que é salvo no registro do Windows quando você chama [CWinAppEx:: SaveState](#savestate).

```
int GetDataVersionMinor() const;
```

### <a name="return-value"></a>Valor retornado

Um valor inteiro que contém o número de versão secundária.

##  <a name="getint"></a>CWinAppEx:: GetInt

Lê dados inteiros de uma chave do Registro especificada.

```
int GetInt(
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>parâmetros

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o nome de uma entrada de registro.

*nDefault*<br/>
no O valor padrão que o método retorna se a entrada do Registro especificada não existir.

### <a name="return-value"></a>Valor retornado

Os dados do registro se o método foi bem-sucedido; caso contrário, *nDefault*.

### <a name="remarks"></a>Comentários

Esse método lê os dados inteiros do registro. Se não houver dados inteiros associados à chave do Registro indicada por *lpszEntry*, esse método retornará *nDefault*. Para gravar dados no registro, use os métodos [CWinAppEx:: WriteSectionInt](#writesectionint) e [CWinAppEx:: WriteInt](#writeint).

O parâmetro *lpszEntry* é o nome de uma entrada de registro localizada sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getkeyboardmanager"></a>CWinAppEx:: GetKeyboardManager

Retorna um ponteiro para o objeto [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) global.

```
CKeyboardManager* GetKeyboardManager();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para o objeto de `CKeyboardManager` global.

### <a name="remarks"></a>Comentários

Se o Gerenciador de teclado não for inicializado, essa função chamará [CWinAppEx:: InitKeyboardManager](#initkeyboardmanager) antes de retornar um ponteiro.

##  <a name="getmousemanager"></a>CWinAppEx:: getratomanager

Retorna um ponteiro para o objeto [CMouseManager](../../mfc/reference/cmousemanager-class.md) global.

```
CMouseManager* GetMouseManager();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para o objeto de `CMouseManager` global.

### <a name="remarks"></a>Comentários

Se o Gerenciador do mouse não for inicializado, essa função chamará [CWinAppEx:: InitMouseManager](#initmousemanager) antes de retornar um ponteiro.

##  <a name="getobject"></a>CWinAppEx:: GetObject

Lê os dados de [CObject](../../mfc/reference/cobject-class.md)-derivado do registro.

```
BOOL GetObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>parâmetros

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o caminho relativo de uma entrada de registro.

*obj*<br/>
fora Uma referência a um `CObject`. O método usa essa referência para armazenar os dados do registro.

### <a name="return-value"></a>Valor retornado

Diferente de zero se o método foi bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Esse método lê dados do registro que é derivado de `CObject`. Para gravar dados de `CObject` no registro, use [CWinAppEx:: WriteObject](#writeobject) ou [CWinAppEx:: WriteSectionObject](#writesectionobject).

O parâmetro *lpszEntry* é o nome de uma entrada de registro que está localizada sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getregistrybase"></a>CWinAppEx::GetRegistryBase

Recupera o caminho do registro padrão para o aplicativo.

```
LPCTSTR GetRegistryBase();
```

### <a name="return-value"></a>Valor retornado

Uma cadeia de caracteres que contém o caminho do local do registro padrão.

### <a name="remarks"></a>Comentários

Todos os métodos da [classe CWinAppEx](../../mfc/reference/cwinappex-class.md) que acessam o registro são iniciados em um local padrão. Use este método para recuperar um caminho do local do registro padrão. Use [CWinAppEx:: SetRegistryBase](#setregistrybase) para alterar o local do registro padrão.

##  <a name="getregsectionpath"></a>CWinAppEx::GetRegSectionPath

Cria e retorna o caminho absoluto de uma chave do registro.

```
CString GetRegSectionPath(LPCTSTR szSectionAdd = _T(""));
```

### <a name="parameters"></a>parâmetros

*szSectionAdd*<br/>
no Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

### <a name="return-value"></a>Valor retornado

Um `CString` que contém o caminho absoluto de uma chave do registro.

### <a name="remarks"></a>Comentários

Esse método define o caminho absoluto da chave do registro acrescentando o caminho relativo em *szSectionAdd* ao local do registro padrão para seu aplicativo. Para obter a chave do registro padrão, use o método [CWinAppEx:: GetRegistryBase](#getregistrybase).

##  <a name="getsectionbinary"></a>CWinAppEx::GetSectionBinary

Lê dados binários do registro.

```
BOOL GetSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>parâmetros

*lpszSubSection*<br/>
no Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o valor a ser lido.

*ppData*<br/>
fora Um ponteiro para o buffer em que o método armazena os dados.

*pBytes*<br/>
fora Um ponteiro para um inteiro sem sinal. O método grava o tamanho de *ppData* para esse parâmetro.

### <a name="return-value"></a>Valor retornado

Verdadeiro se for bem-sucedido; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Esse método lê dados binários que são gravados no registro usando os métodos [CWinAppEx:: WriteBinary](#writebinary) e [CWinAppEx:: WriteSectionBinary](#writesectionbinary).

O parâmetro *lpszSubSection* não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é anexado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getsectionint"></a>CWinAppEx::GetSectionInt

Lê dados inteiros do registro.

```
int GetSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>parâmetros

*lpszSubSection*<br/>
no Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o valor a ser lido.

*nDefault*<br/>
no O valor padrão a ser retornado se o valor especificado não existir.

### <a name="return-value"></a>Valor retornado

Os dados inteiros que são armazenados no valor do registro especificado; *nDefault* se os dados não existirem.

### <a name="remarks"></a>Comentários

Use os métodos [CWinAppEx:: WriteInt](#writeint) e [CWinAppEx:: WriteSectionInt](#writesectionint) para gravar dados inteiros no registro.

O parâmetro *lpszSubSection* não é um caminho absoluto de uma entrada de registro. É um caminho relativo que é adicionado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getsectionobject"></a>CWinAppEx:: getsectionobject

Lê os dados do registro [CObject](../../mfc/reference/cobject-class.md) do registro.

```
BOOL GetSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>parâmetros

*lpszSubSection*<br/>
no Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o valor a ser lido.

*obj*<br/>
fora Uma referência a um `CObject`. O método usa esse `CObject` para armazenar os dados do registro.

### <a name="return-value"></a>Valor retornado

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Esse método lê dados do registro. Os dados lidos são `CObject` dados ou dados para uma classe derivada de `CObject`. Para gravar dados de `CObject` no registro, use [CWinAppEx:: WriteObject](#writeobject) ou [CWinAppEx:: WriteSectionObject](#writesectionobject).

O parâmetro *lpszSubSection* não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é anexado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getsectionstring"></a>CWinAppEx:: getseçãostring

Lê dados de cadeia de caracteres do registro.

```
CString GetSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = _T(""));
```

### <a name="parameters"></a>parâmetros

*lpszSubSection*<br/>
no Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o valor a ser lido.

*lpszDefault*<br/>
no O valor padrão a ser retornado se o valor especificado não existir.

### <a name="return-value"></a>Valor retornado

Os dados de cadeia de caracteres armazenados no valor do registro especificado se os dados existirem; caso contrário, *lpszDefault*.

### <a name="remarks"></a>Comentários

Esse método lê os dados de cadeia de caracteres gravados no registro. Use [CWinAppEx:: WriteString](#writestring) e [CWinAppEx:: WriteSectionString](#writesectionstring) para gravar dados de cadeia de caracteres no registro.

O parâmetro *lpszSubSection* não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é anexado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getshellmanager"></a>CWinAppEx:: GetShellManager

Retorna um ponteiro para o objeto [CShellManager](../../mfc/reference/cshellmanager-class.md) global.

```
CShellManager* GetShellManager();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para o objeto de `CShellManager` global.

### <a name="remarks"></a>Comentários

Se o objeto `CShellManager` não for inicializado, essa função chamará [CWinAppEx:: InitShellManager](#initshellmanager) antes de retornar um ponteiro.

##  <a name="getstring"></a>CWinAppEx:: GetString

Lê dados de cadeia de caracteres de uma chave do Registro especificada.

```
CString GetString(
    LPCTSTR lpszEntry,
    LPCTSTR lpzDefault= _T(""));
```

### <a name="parameters"></a>parâmetros

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o nome de uma chave do registro

*lpzDefault*<br/>
no O valor padrão que o método retorna se a entrada do Registro especificada não existir.

### <a name="return-value"></a>Valor retornado

Os dados de cadeia de caracteres armazenados no registro se forem bem-sucedidos; caso contrário, *lpszDefault* .

### <a name="remarks"></a>Comentários

Esse método lê os dados de cadeia de caracteres gravados no registro. Para gravar dados no registro, use os métodos [CWinAppEx:: WriteString](#writestring) ou [CWinAppEx:: WriteSectionString](#writesectionstring).

O parâmetro *lpszEntry* é o nome de uma entrada de registro localizada sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="gettooltipmanager"></a>CWinAppEx:: GetTooltipManager

Retorna um ponteiro para o objeto [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) global.

```
CTooltipManager* GetTooltipManager();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para o objeto de `CTooltipManager` global.

### <a name="remarks"></a>Comentários

Se o objeto `CTooltipManager` não for inicializado, essa função chamará [CWinAppEx:: InitTooltipManager](#inittooltipmanager) antes de retornar um ponteiro.

##  <a name="getusertoolsmanager"></a>CWinAppEx::GetUserToolsManager

Retorna um ponteiro para o objeto [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) global.

```
CUserToolsManager* GetUserToolsManager();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para o objeto de `CUserToolsManager` global; NULL se o gerenciamento de ferramentas do usuário não estiver habilitado para o aplicativo.

### <a name="remarks"></a>Comentários

Antes de recuperar um ponteiro para o objeto `CUserToolsManager`, você deve inicializar o Gerenciador chamando [CWinAppEx:: EnableUserTools](#enableusertools).

##  <a name="initcontextmenumanager"></a>CWinAppEx::InitContextMenuManager

Inicializa o objeto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) .

```
BOOL InitContextMenuManager();
```

### <a name="return-value"></a>Valor retornado

Diferente de zero se o método criar o objeto CContextMenuManager; 0 se o objeto de `CContextMenuManager` já existir.

### <a name="remarks"></a>Comentários

Se você chamar [CWinAppEx:: GetContextMenuManager](#getcontextmenumanager), a implementação padrão desse método chamará `InitContextMenuManager`.

Se seu aplicativo já tiver um Gerenciador de menu de contexto e você chamar `InitContextMenuManager`, seu aplicativo terá uma falha de [declaração](diagnostic-services.md#assert) . Portanto, você não deve chamar `InitContextMenuManager` se você criar um objeto de `CContextMenuManager` diretamente. Se você não estiver usando um `CContextMenuManager`personalizado, use `GetContextMenuManager` para criar um objeto `CContextMenuManager`.

##  <a name="initkeyboardmanager"></a>CWinAppEx::InitKeyboardManager

Inicializa o objeto [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) .

```
BOOL InitKeyboardManager();
```

### <a name="return-value"></a>Valor retornado

Diferente de zero se o método criar o objeto de `CKeyboardManager`; 0 se o objeto de `CKeyboardManager` já existir.

### <a name="remarks"></a>Comentários

Se você chamar [CWinAppEx:: GetKeyboardManager](#getkeyboardmanager), a implementação padrão desse método chamará `InitKeyboardManager`.

Se o seu aplicativo já tiver um Gerenciador de teclado e você chamar `InitKeyboardManager`, seu aplicativo terá uma falha de [declaração](diagnostic-services.md#assert) . Portanto, você não deve chamar `InitKeyboardManager` se você criar um objeto de `CKeyboardManager` diretamente. Se você não estiver usando um `CKeyboardManager`personalizado, use `GetKeyboardManager` para criar um objeto `CKeyboardManager`.

##  <a name="initmousemanager"></a>CWinAppEx::InitMouseManager

Inicializa o objeto [CMouseManager](../../mfc/reference/cmousemanager-class.md) .

```
BOOL InitMouseManager();
```

### <a name="return-value"></a>Valor retornado

Diferente de zero se o método criar o objeto de `CMouseManager`; 0 se o objeto de `CMouseManager` já existir.

### <a name="remarks"></a>Comentários

Se você chamar [CWinAppEx:: GetMouseManager](#getmousemanager), a implementação padrão desse método chamará `InitMouseManager`.

Se o seu aplicativo já tiver um Gerenciador de mouse e você chamar `InitMouseManager`, seu aplicativo terá uma falha de [declaração](diagnostic-services.md#assert) . Portanto, você não deve chamar `InitMouseManager` se você criar um objeto de `CMouseManager` diretamente. Se você não estiver usando um `CMouseManager`personalizado, use `GetMouseManager` para criar um objeto `CMouseManager`.

##  <a name="initshellmanager"></a>CWinAppEx::InitShellManager

Inicializa o objeto [CShellManager](../../mfc/reference/cshellmanager-class.md) .

```
BOOL InitShellManager();
```

### <a name="return-value"></a>Valor retornado

Diferente de zero se o método criar o objeto de `CShellManager`; 0 se o objeto de `CShellManager` já existir.

### <a name="remarks"></a>Comentários

Se você chamar [CWinAppEx:: GetShellManager](#getshellmanager), a implementação padrão desse método chamará `InitShellManager`.

Se seu aplicativo já tiver um Gerenciador de shell e você chamar `InitShellManager`, seu aplicativo gerará uma falha de [asserção](diagnostic-services.md#assert) . Portanto, não chame `InitShellManager` se você criar um objeto de `CShellManager` diretamente. Se você não estiver usando um `CShellManager`personalizado, use `GetShellManager` para criar um objeto `CShellManager`.

##  <a name="inittooltipmanager"></a>CWinAppEx::InitTooltipManager

Inicializa o objeto [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) .

```
BOOL InitTooltipManager();
```

### <a name="return-value"></a>Valor retornado

Diferente de zero se o método criar o objeto de `CTooltipManager`; 0 se o objeto de `CTooltipManager` já existir.

### <a name="remarks"></a>Comentários

Se você chamar [CWinAppEx:: GetTooltipManager](#gettooltipmanager), a implementação padrão desse método chamará `InitTooltipManager`.

Se seu aplicativo já tiver um Gerenciador de dica de ferramenta e você chamar `InitTooltipManager`, seu aplicativo terá uma falha de [declaração](diagnostic-services.md#assert) . Portanto, você não deve chamar `InitTooltipManager` se você criar um objeto de `CTooltipManager` diretamente. Se você não estiver usando um `CTooltipManager`personalizado, use `GetTooltipManager` para criar um objeto `CTooltipManager`.

##  <a name="isresourcesmartupdate"></a>CWinAppEx::IsResourceSmartUpdate

```
BOOL IsResourceSmartUpdate() const;
```

### <a name="return-value"></a>Valor retornado

### <a name="remarks"></a>Comentários

##  <a name="isstateexists"></a>CWinAppEx::IsStateExists

Indica se a chave especificada está no registro.

```
BOOL IsStateExists(LPCTSTR lpszSectionName);
```

### <a name="parameters"></a>parâmetros

*lpszSectionName*<br/>
no Uma cadeia de caracteres que contém um caminho de uma chave do registro.

### <a name="return-value"></a>Valor retornado

Diferente de zero se a chave estiver no registro; caso contrário, 0.

##  <a name="loadcustomstate"></a>CWinAppEx:: loadcustomstate

A estrutura chama esse método depois de carregar o estado do aplicativo do registro.

```
virtual void LoadCustomState();
```

### <a name="remarks"></a>Comentários

Substitua esse método se você quiser fazer qualquer processamento depois que o aplicativo carregar o estado do registro. Por padrão, esse método não faz nada.

Para carregar informações de estado personalizado do registro, as informações devem primeiro ser salvas usando [CWinAppEx:: SaveCustomState](#savecustomstate).

##  <a name="loadstate"></a>CWinAppEx:: LoadState

Lê o estado do aplicativo no registro do Windows.

```
BOOL LoadState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

virtual BOOL LoadState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);
```

### <a name="parameters"></a>parâmetros

*pFrame*<br/>
no Um ponteiro para um objeto de janela de quadro. O método aplica as informações de estado no registro a esta janela do quadro.

*lpszSectionName*<br/>
no Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*pFrameImpl*<br/>
no Um ponteiro para um objeto `CFrameImpl`. O método aplica as informações de estado no registro a esta janela do quadro.

### <a name="return-value"></a>Valor retornado

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Esse método carrega o estado do aplicativo e qualquer informação de estado para uma janela do quadro. As informações carregadas para a janela do quadro são aplicadas à janela do quadro fornecido. Se você não fornecer uma janela de quadro, somente as informações de estado do aplicativo serão carregadas. As informações do aplicativo incluem o estado da [classe CMouseManager](../../mfc/reference/cmousemanager-class.md), classe [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), [Classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)e a [classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md).

A implementação padrão de chamadas de `CFrameImpl::OnLoadFrame` `LoadState`.

O parâmetro *lpszSectionName* não é o caminho absoluto para uma entrada de registro. É um caminho relativo que é adicionado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="loadwindowplacement"></a>CWinAppEx::LoadWindowPlacement

Chamado pelo Framework quando ele carrega o tamanho e o local da janela do quadro principal do registro.

```
virtual BOOL LoadWindowPlacement(
    CRect& rectNormalPosition,
    int& nFlags,
    int& nShowCmd);
```

### <a name="parameters"></a>parâmetros

*rectNormalPosition*<br/>
fora Um retângulo que contém as coordenadas da janela do quadro principal quando ela está na posição restaurada.

*nFlags*<br/>
fora Sinalizadores que controlam a posição da janela minimizada e como o sistema operacional alterna entre uma janela minimizada e uma janela restaurada.

*nShowCmd*<br/>
fora Um inteiro que especifica o estado de exibição da janela. Para obter mais informações sobre os valores possíveis, consulte [CWnd:: sawindow](../../mfc/reference/cwnd-class.md#showwindow).

### <a name="return-value"></a>Valor retornado

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Por padrão, o MFC carrega automaticamente a posição e o estado anteriores da janela do quadro principal quando o aplicativo é iniciado. Para obter mais informações sobre como essas informações são armazenadas no registro, consulte [CWinAppEx:: StoreWindowPlacement](#storewindowplacement).

Substitua esse método se você quiser carregar informações adicionais sobre a janela do quadro principal.

##  <a name="m_bforceimagereset"></a>CWinAppEx:: m_bForceImageReset

Especifica se a estrutura redefine todas as imagens da barra de ferramentas quando recarrega a janela do quadro que contém a barra de ferramentas.

```
BOOL m_bForceImageReset;
```

### <a name="remarks"></a>Comentários

O membro de dados `m_bForceImageReset` é uma variável protegida.

##  <a name="onappcontexthelp"></a>CWinAppEx::OnAppContextHelp

A estrutura chama esse método quando o usuário solicita ajuda de contexto para a caixa de diálogo de **personalização** .

```
virtual void OnAppContextHelp(
    CWnd* pWndControl,
    const DWORD dwHelpIDArray[]);
```

### <a name="parameters"></a>parâmetros

*pWndControl*<br/>
no Um ponteiro para um objeto Window para o qual o usuário chamou a ajuda de contexto.

*dwHelpIDArray[]*<br/>
no Um valor reservado.

### <a name="remarks"></a>Comentários

Este método está reservado no momento para uso futuro. A implementação padrão não faz nada e não é chamada no momento pela estrutura.

##  <a name="onclosingmainframe"></a>CWinAppEx::OnClosingMainFrame

A estrutura chama esse método quando uma janela do quadro está processando WM_CLOSE.

```
virtual void OnClosingMainFrame(CFrameImpl* pFrameImpl);
```

### <a name="parameters"></a>parâmetros

*pFrameImpl*<br/>
no Um ponteiro para um objeto `CFrameImpl`.

### <a name="remarks"></a>Comentários

A implementação padrão desse método salva o estado de *pFrameImpl*.

##  <a name="onviewdoubleclick"></a>CWinAppEx::OnViewDoubleClick

Chama o comando definido pelo usuário que está associado a uma exibição quando o usuário clica duas vezes em qualquer lugar dentro dessa exibição.

```
virtual BOOL OnViewDoubleClick(
    CWnd* pWnd,
    int iViewId);
```

### <a name="parameters"></a>parâmetros

*pWnd*<br/>
no Um ponteiro para um objeto derivado da [classe cvisualização](../../mfc/reference/cview-class.md).

*iViewid*<br/>
no A ID da exibição.

### <a name="return-value"></a>Valor retornado

TRUE se a estrutura encontrar um comando; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Para dar suporte ao comportamento personalizado do mouse, você deve chamar essa função ao processar a mensagem de WM_LBUTTONDBLCLK. Esse método executará o comando associado à ID de exibição fornecida por *iViewId*. Para obter mais informações sobre o comportamento personalizado do mouse, consulte [personalização do teclado e do mouse](../../mfc/keyboard-and-mouse-customization.md).

##  <a name="onworkspaceidle"></a>CWinAppEx::OnWorkspaceIdle

```
virtual BOOL OnWorkspaceIdle(CWnd*);
```

### <a name="parameters"></a>parâmetros

no *CWnd&#38;*<br/>

### <a name="return-value"></a>Valor retornado

### <a name="remarks"></a>Comentários

##  <a name="preloadstate"></a>CWinAppEx::P reloadstate

A estrutura chama esse método imediatamente antes de carregar o estado do aplicativo do registro.

```
virtual void PreLoadState();
```

### <a name="remarks"></a>Comentários

Substitua esse método se você quiser fazer qualquer processamento imediatamente antes que a estrutura carregue o estado do aplicativo.

##  <a name="presavestate"></a>CWinAppEx::P salvar novamente

A estrutura chama esse método imediatamente antes de salvar o estado do aplicativo.

```
virtual void PreSaveState();
```

### <a name="remarks"></a>Comentários

Substitua esse método se você quiser fazer qualquer processamento imediatamente antes que a estrutura salve o estado do aplicativo.

##  <a name="reloadwindowplacement"></a>CWinAppEx::ReloadWindowPlacement

Recarrega o tamanho e o local de uma janela do registro.

```
virtual BOOL ReloadWindowPlacement(CFrameWnd* pFrame);
```

### <a name="parameters"></a>parâmetros

*pFrame*<br/>
no Um ponteiro para uma janela de quadro.

### <a name="return-value"></a>Valor retornado

Diferente de zero se o método foi bem-sucedido; 0 se o carregamento tiver falhado ou não houver dados a serem carregados.

### <a name="remarks"></a>Comentários

Use a função [CWinAppEx:: StoreWindowPlacement](#storewindowplacement) para gravar o tamanho e o local de uma janela no registro.

##  <a name="savecustomstate"></a>CWinAppEx::SaveCustomState

A estrutura chama esse método depois de salvar o estado do aplicativo no registro.

```
virtual void SaveCustomState();
```

### <a name="remarks"></a>Comentários

Substitua esse método se você quiser fazer qualquer processamento depois que o aplicativo salvar o estado no registro. Por padrão, esse método não faz nada.

##  <a name="savestate"></a>CWinAppEx:: SaveState

Grava o estado do aplicativo no registro do Windows.

```
virtual BOOL SaveState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);

BOOL SaveState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>parâmetros

*lpszSectionName*<br/>
no Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*pFrameImpl*<br/>
no Um ponteiro para um objeto `CFrameImpl`. Esse quadro é salvo no registro do Windows.

*pFrame*<br/>
no Um ponteiro para um objeto de janela de quadro. Esse quadro é salvo no registro do Windows.

### <a name="return-value"></a>Valor retornado

Verdadeiro se for bem-sucedido; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Esse método salva o estado do aplicativo e qualquer informação de estado para a janela de quadro fornecida. Se você não fornecer uma janela de quadro, o método só salvará o estado do aplicativo. As informações do aplicativo incluem o estado da [classe CMouseManager](../../mfc/reference/cmousemanager-class.md), classe [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), [Classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)e a [classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md).

O parâmetro *lpszSectionName* não é o caminho absoluto para uma entrada de registro. É um caminho relativo que é anexado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="setregistrybase"></a>CWinAppEx::SetRegistryBase

Define o caminho do registro padrão para o aplicativo.

```
LPCTSTR SetRegistryBase(LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>parâmetros

*lpszSectionName*<br/>
no Uma cadeia de caracteres que contém o caminho de uma chave do registro.

### <a name="return-value"></a>Valor retornado

Uma cadeia de caracteres que contém o caminho do local do registro padrão.

### <a name="remarks"></a>Comentários

Todos os métodos da [classe CWinAppEx](../../mfc/reference/cwinappex-class.md) que acessam o registro são iniciados em um local padrão. Use este método para alterar o local padrão do registro. Use [CWinAppEx:: GetRegistryBase](#getregistrybase) para recuperar o local do registro padrão.

##  <a name="showpopupmenu"></a>CWinAppEx::ShowPopupMenu

Exibe um menu pop-up.

```
virtual BOOL ShowPopupMenu(
    UINT uiMenuResId,
    const CPoint& point,
    CWnd* pWnd);
```

### <a name="parameters"></a>parâmetros

*uiMenuResId*<br/>
no Uma ID de recurso de menu.

*empresas*<br/>
no Um [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) que especifica a posição do menu em coordenadas da tela.

*pWnd*<br/>
no Um ponteiro para a janela que possui o menu pop-up.

### <a name="return-value"></a>Valor retornado

Diferente de zero se o menu pop-up for exibido com êxito; caso contrário, 0.

### <a name="remarks"></a>Comentários

Esse método exibe o menu associado a *uiMenuResId*.

Para dar suporte a menus pop-up, você deve ter um objeto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) . Se você não tiver inicializado o objeto `CContextMenuManager`, `ShowPopupMenu` falhará.

##  <a name="storewindowplacement"></a>CWinAppEx::StoreWindowPlacement

Chamado pelo Framework para gravar o tamanho e o local da janela do quadro principal no registro.

```
virtual BOOL StoreWindowPlacement(
    const CRect& rectNormalPosition,
    int nFlags,
    int nShowCmd);
```

### <a name="parameters"></a>parâmetros

*nFlags*<br/>
no Sinalizadores que controlam a posição da janela minimizada e como o sistema operacional alterna entre uma janela minimizada e uma janela restaurada.

*nShowCmd*<br/>
no Um inteiro que especifica o estado de exibição da janela. Para obter mais informações sobre os valores possíveis, consulte [CWnd:: sawindow](../../mfc/reference/cwnd-class.md#showwindow).

*rectNormalPosition*<br/>
no Um retângulo que contém as coordenadas da janela do quadro principal quando está no estado restaurado.

### <a name="return-value"></a>Valor retornado

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Por padrão, o MFC salva automaticamente a posição e o estado da janela do quadro principal antes da saída do aplicativo. Essas informações são armazenadas no registro do Windows na chave WindowPlacement no local do registro padrão para seu aplicativo. Para obter mais informações sobre o local do registro padrão do seu aplicativo, consulte [CWinAppEx:: GetRegistryBase](#getregistrybase).

Substitua esse método se desejar armazenar informações adicionais sobre a janela do quadro principal.

##  <a name="writebinary"></a>CWinAppEx::WriteBinary

Grava dados binários no registro.

```
BOOL WriteBinary(
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>parâmetros

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o nome de uma chave do registro.

*pData*<br/>
no Os dados a serem armazenados.

*nBytes*<br/>
no O tamanho de *pData* em bytes.

### <a name="return-value"></a>Valor retornado

TRUE se esse método for bem-sucedido; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O parâmetro *lpszEntry* é o nome de uma entrada de registro que está localizada sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

Se a chave especificada por *lpszEntry* não existir, esse método irá criá-la.

##  <a name="writeint"></a>CWinAppEx::WriteInt

Grava dados numéricos no registro.

```
BOOL WriteInt(
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>parâmetros

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o nome de uma chave do registro.

*nvalor*<br/>
no Os dados a serem armazenados.

### <a name="return-value"></a>Valor retornado

TRUE se esse método for bem-sucedido; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O parâmetro *lpszEntry* é o nome de uma entrada de registro localizada sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

Se a chave especificada por *lpszEntry* não existir, esse método irá criá-la.

##  <a name="writeobject"></a>CWinAppEx:: WriteObject

Grava dados derivados da [classe CObject](../../mfc/reference/cobject-class.md) para o registro.

```
BOOL WriteObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>parâmetros

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o valor a ser definido.

*obj*<br/>
no Uma referência a `CObject` dados que serão armazenados pelo método.

### <a name="return-value"></a>Valor retornado

TRUE se esse método for bem-sucedido; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Esse método grava os dados *obj* no valor especificado na chave do registro padrão. Use [CWinAppEx:: GetRegistryBase](#getregistrybase) para determinar a chave do registro atual.

##  <a name="writesectionbinary"></a>CWinAppEx::WriteSectionBinary

Grava dados binários em um valor no registro.

```
BOOL WriteSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>parâmetros

*lpszSubSection*<br/>
no Uma cadeia de caracteres que contém o nome de uma chave do registro

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o valor a ser definido.

*pData*<br/>
no Os dados a serem gravados no registro.

*nBytes*<br/>
no O tamanho de *pData* em bytes.

### <a name="return-value"></a>Valor retornado

TRUE se esse método for bem-sucedido; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O parâmetro *lpszSubSection* não é o caminho absoluto para uma entrada de registro. É um caminho relativo que é anexado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

Se a chave especificada por *lpszEntry* não existir, esse método irá criá-la.

##  <a name="writesectionint"></a>CWinAppEx::WriteSectionInt

Grava dados numéricos no registro.

```
BOOL WriteSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>parâmetros

*lpszSubSection*<br/>
no Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o valor a ser definido.

*nvalor*<br/>
no Os dados a serem gravados no registro.

### <a name="return-value"></a>Valor retornado

TRUE se esse método for bem-sucedido; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O parâmetro *lpszSubSection* não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é anexado à chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

Se a chave especificada por *lpszEntry* não existir, esse método irá criá-la.

##  <a name="writesectionobject"></a>CWinAppEx::WriteSectionObject

Grava dados derivados da [classe CObject](../../mfc/reference/cobject-class.md) para um valor de registro específico.

```
BOOL WriteSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>parâmetros

*lpszSubSection*<br/>
no Uma cadeia de caracteres que contém o nome de uma chave do registro.

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o nome do valor a ser definido.

*obj*<br/>
no Os dados a serem armazenados.

### <a name="return-value"></a>Valor retornado

TRUE se esse método for bem-sucedido; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O parâmetro *lpszSubSection* não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é anexado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase), respectivamente.

Se o valor especificado por *lpszEntry* não existir na chave do Registro especificada por *lpszSubSection*, esse método criará esse valor.

##  <a name="writesectionstring"></a>CWinAppEx::WriteSectionString

Grava dados de cadeia de caracteres em um valor no registro.

```
BOOL WriteSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>parâmetros

*lpszSubSection*<br/>
no Uma cadeia de caracteres que contém o nome de uma chave do registro.

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o valor a ser definido.

*lpszValue*<br/>
no Os dados de cadeia de caracteres a serem gravados no registro.

### <a name="return-value"></a>Valor retornado

TRUE se esse método for bem-sucedido; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O parâmetro *lpszSubSection* não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é anexado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase), respectivamente.

Se o valor especificado por *lpszEntry* não existir em *lpszSubSection*, esse método irá criá-lo.

##  <a name="writestring"></a>CWinAppEx:: WriteString

Grava dados de cadeia de caracteres no registro.

```
BOOL WriteString(
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>parâmetros

*lpszEntry*<br/>
no Uma cadeia de caracteres que contém o nome de uma chave do registro.

*lpszValue*<br/>
no Os dados a serem armazenados.

### <a name="return-value"></a>Valor retornado

TRUE se esse método for bem-sucedido; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O parâmetro *lpszEntry* é o nome de uma entrada de registro localizada sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) e [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

Se a chave especificada por *lspzEntry* não existir, esse método irá criá-la.

## <a name="see-also"></a>Confira também

[Gráfico da hierarquia](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[Classe CWinApp](../../mfc/reference/cwinapp-class.md)<br/>
[Classe CMouseManager](../../mfc/reference/cmousemanager-class.md)<br/>
[Classe CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)<br/>
[Classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)<br/>
[Classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)
