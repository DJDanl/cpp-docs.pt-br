---
title: Classe COleControl
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 54138955b0aa61a5e307c64825f3c74fa6f592b1
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753941"
---
# <a name="colecontrol-class"></a>Classe COleControl

Uma classe base poderosa para desenvolver controles OLE.

## <a name="syntax"></a>Sintaxe

```
class COleControl : public CWnd
```

## <a name="members"></a>Membros

### <a name="public-constructors"></a>Construtores públicos

|Nome|Descrição|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Cria um objeto `COleControl`.|

### <a name="public-methods"></a>Métodos públicos

|Nome|Descrição|
|----------|-----------------|
|[COleControl::Aparência ambiente](#ambientappearance)|Recupera a aparência atual do controle.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Retorna o valor da propriedade BackColor ambiente.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Retorna o nome do controle conforme especificado pelo recipiente.|
|[COleControl::AmbientFont](#ambientfont)|Devolve o valor da propriedade Font ambiente.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Retorna o valor da propriedade ForeColor ambiente.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Devolve o ID local do contêiner.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Retorna o tipo de unidades utilizadas pelo recipiente.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Determina se as alças de agarramento devem ser exibidas.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Determina se a eclosão deve ser exibida.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Retorna o tipo de alinhamento de texto especificado pelo contêiner.|
|[COleControl::AmbientUIDead](#ambientuidead)|Determina se o controle deve responder às ações de interface do usuário.|
|[COleControl::AmbientUserMode](#ambientusermode)|Determina o modo do recipiente.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Notifica o contêiner de que uma propriedade vinculada foi alterada.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Solicita permissão para editar o valor da propriedade.|
|[COleControl::ClientToParent](#clienttoparent)|Traduz um ponto relativo à origem do controle para um ponto em relação à origem do seu contêiner.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Ajusta um retângulo de cuidado se for sobreposto por um controle.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Chame esta função depois que o conjunto de mnemônicos manipulados pelo controle tenha sido alterado.|
|[COleControl::DisplayError](#displayerror)|Exibe eventos de erro de estoque para o usuário do controle.|
|[COleControl::DoClick](#doclick)|Implementação do `DoClick` método de estoque.|
|[COleControl::DoPropExchange](#dopropexchange)|Serializa as propriedades `COleControl` de um objeto.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Redesenha um controle OLE que foi subclassificado a partir de um controle do Windows.|
|[COleControl::Habilitarquadro simples](#enablesimpleframe)|Permite suporte de quadro simples para um controle.|
|[COleControl::ExchangeExtent](#exchangeextent)|Serializa a largura e a altura do controle.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serializa as propriedades de estoque do controle.|
|[COleControl::ExchangeVersion](#exchangeversion)|Serializa o número da versão do controle.|
|[COleControl::FireClick](#fireclick)|Dispara o `Click` evento de ações.|
|[COleControl::FireDblClick](#firedblclick)|Dispara o `DblClick` evento de ações.|
|[COleControl::FireError](#fireerror)|Dispara o `Error` evento de ações.|
|[COleControl::FireEvent](#fireevent)|Dispara um evento personalizado.|
|[COleControl::FireKeyDown](#firekeydown)|Dispara o `KeyDown` evento de ações.|
|[COleControl::FireKeyPress](#firekeypress)|Dispara o `KeyPress` evento de ações.|
|[COleControl::FireKeyUp](#firekeyup)|Dispara o `KeyUp` evento de ações.|
|[COleControl::FireMouseDown](#firemousedown)|Dispara o `MouseDown` evento de ações.|
|[COleControl::FireMouseMove](#firemousemove)|Dispara o `MouseMove` evento de ações.|
|[COleControl::FireMouseUp](#firemouseup)|Dispara o `MouseUp` evento de ações.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Dispara um evento quando o estado pronto do controle muda.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Altera o comportamento de ativação padrão `IPointerInactive` de um controle que suporta a interface.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Devolve o valor da propriedade ambiente especificada.|
|[COleControl::GetAppearance](#getappearance)|Devolve o valor da propriedade Appearance.|
|[COleControl::GetBackColor](#getbackcolor)|Devolve o valor da propriedade BackColor de estoque.|
|[COleControl::GetBorderStyle](#getborderstyle)|Devolve o valor da propriedade BorderStyle de estoque.|
|[COleControl::GetCapture](#getcapture)|Determina se um objeto de controle ativado e sem janelas tem a captura do mouse.|
|[COleControl::GetClassID](#getclassid)|Recupera o ID de classe OLE do controle.|
|[COleControl::GetClientOffset](#getclientoffset)|Recupera a diferença entre o canto superior esquerdo da área retangular do controle e o canto superior esquerdo de sua área cliente.|
|[COleControl::GetClientRect](#getclientrect)|Recupera o tamanho da área de clientes do controle.|
|[COleControl::GetClientSite](#getclientsite)|Consulta um objeto para o ponteiro para o seu site cliente atual dentro de seu contêiner.|
|[COleControl::GetControlFlags](#getcontrolflags)|Recupera as configurações do sinalizador de controle.|
|[COleControl::GetControlSize](#getcontrolsize)|Retorna a posição e o tamanho do controle OLE.|
|[COleControl::GetDC](#getdc)|Fornece um meio para um controle sem janelas para obter um contexto do dispositivo a partir de seu contêiner.|
|[COleControl::GetEnabled](#getenabled)|Devolve o valor da propriedade habilitada.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Recupera um ponteiro para um objeto de controle estendido pertencente ao recipiente.|
|[COleControl::GetFocus](#getfocus)|Determina se o controle tem o foco.|
|[COleControl::GetFont](#getfont)|Devolve o valor da propriedade font stock.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Retorna as métricas `CFontHolder` de um objeto.|
|[COleControl::GetForeColor](#getforecolor)|Devolve o valor da propriedade ForeColor do estoque.|
|[COleControl::GetHwnd](#gethwnd)|Devolve o valor da propriedade hWnd de ações.|
|[COleControl::GetMessageString](#getmessagestring)|Fornece texto da barra de status para um item do menu.|
|[COleControl::GetNotSupported](#getnotsupported)|Impede o acesso ao valor de propriedade de um controle pelo usuário.|
|[COleControl::GetReadyState](#getreadystate)|Retorna o estado de prontidão do controle.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Retorna o retângulo do controle em relação ao seu recipiente.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Retorna as métricas da propriedade Font stock.|
|[COleControl::GetText](#gettext)|Devolve o valor da propriedade Texto ou Legenda de estoque.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Substituir para permitir que um controle sem janelas seja o alvo das operações de arrastar e soltar.|
|[COleControl::InitializeIIDs](#initializeiids)|Informa a classe base dos IIDs que o controle usará.|
|[COleControl::InternalGetFont](#internalgetfont)|Devolve `CFontHolder` um objeto para a propriedade Font stock.|
|[COleControl::InternalGetText](#internalgettext)|Recupera a propriedade Legenda ou Texto de estoque.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Define o estado de prontidão do controle e dispara o evento de mudança de estado pronto.|
|[COleControl::InvalidaControl](#invalidatecontrol)|Invalida uma área do controle exibido, fazendo com que ele seja redesenhado.|
|[COleControl::InvalidRgn](#invalidatergn)|Invalida a área de cliente da janela do contêiner dentro da determinada região. Pode ser usado para redesenhar controles sem janelas na região.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Permite o carregamento especializado de um controle OLE.|
|[COleControl::IsModified](#ismodified)|Determina se o estado de controle mudou.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Indica se o contêiner suporta desenho otimizado para a operação de desenho atual.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Chamado para determinar se o controle subclasse um controle do Windows.|
|[COleControl::Carga](#load)|Redefine quaisquer dados assíncronos anteriores e inicia uma nova carga da propriedade assíncrona do controle.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Determina se seu controle pode ser desativado pelo recipiente.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Chamado quando uma propriedade ambiente é alterada.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Chamado quando a propriedade aparência de estoque é alterada.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Chamado quando a propriedade BackColor stock é alterada.|
|[COleControl::OnBorderStyleAlterado](#onborderstylechanged)|Chamado quando a propriedade borderstyle estoque é alterada.|
|[COleControl::OnClick](#onclick)|Chamado para disparar o evento stock Click.|
|[COleControl::OnClose](#onclose)|Notifica o `IOleControl::Close` controle que foi chamado.|
|[COleControl::OnDoVerb](#ondoverb)|Chamado depois que um verbo de controle foi executado.|
|[COleControl::OnDraw](#ondraw)|Chamado quando um controle é solicitado para redesenhar-se.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Chamado pelo contêiner quando um controle é solicitado para se redesenhar usando um contexto de dispositivo de metaarquivo.|
|[COleControl::OnEdit](#onedit)|Chamado pelo contêiner para UI Ativar um controle OLE.|
|[COleControl::AtivadoAlterado](#onenabledchanged)|Chamado quando o estoque de propriedade habilitada é alterado.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Chamado pelo contêiner para enumerar os verbos de um controle.|
|[COleControl::OnEventAdvise](#oneventadvise)|Chamado quando os manipuladores de eventos estão conectados ou desconectados de um controle.|
|[COleControl::OnFontChanged](#onfontchanged)|Chamado quando a propriedade font stock é alterada.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Chamado quando a propriedade foreColor de estoque é alterada.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Chamado quando os eventos de um controle são congelados ou descongelados.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Notifica o `IOleObject::GetColorSet` controle que foi chamado.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Fornece informações mnemônicas ao recipiente.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Chamado para obter uma seqüência para representar um valor de propriedade.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Solicita a alça do menu do controle que será mesclado com o menu do contêiner.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Substituir para recuperar o tamanho de exibição do controle mais próximo do modo de tamanho e extensão proposto.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Retorna strings representando possíveis valores para uma propriedade.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Retorna o valor correspondente a uma seqüência de string predefinida.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Substituir para recuperar o tamanho das áreas de exibição do controle (pode ser usado para ativar o desenho de duas vias).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Substituir para converter o tamanho do controle em um retângulo a partir de uma posição específica.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Substituir para recuperar o status de exibição do controle.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Chamado pelo contêiner quando o controle é ui desativado.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Substituir para ter o recipiente para o controle inativo sob o ponteiro do mouse despacho WM_MOUSEMOVE mensagens para o controle.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Substituir para ter o recipiente para o controle inativo sob o ponteiro do mouse despachar WM_SETCURSOR mensagens para o controle.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Chamado após o evento keydown ações foi demitido.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Chamado após o evento keypress ações foi demitido.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Chamado após o evento stock KeyUp foi demitido.|
|[COleControl:OnMapPropertyToPage](#onmappropertytopage)|Indica qual página de propriedade usar para editar uma propriedade.|
|[COleControl::OnMnemônico](#onmnemonic)|Chamado quando uma chave mnemônica do controle foi pressionada.|
|[COleControl::OnProperties](#onproperties)|Chamado quando o verbo "Propriedades" do controle foi invocado.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Substituir para consultar se a exibição de um controle se sobrepõe a um determinado ponto.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Substituir para consultar se a exibição de um controle se sobrepõe a qualquer ponto em um determinado retângulo.|
|[COleControl::OnRenderData](#onrenderdata)|Chamado pela estrutura para recuperar dados no formato especificado.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Chamado pela estrutura para recuperar dados de um arquivo no formato especificado.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Chamado pela estrutura para recuperar dados da memória global no formato especificado.|
|[COleControl::OnResetState](#onresetstate)|Redefine as propriedades de um controle para os valores padrão.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Notifica o `IOleControl::SetClientSite` controle que foi chamado.|
|[COleControl::OnSetData](#onsetdata)|Substitui os dados do controle por outro valor.|
|[COleControl::OnSetExtent](#onsetextent)|Chamado depois que a extensão do controle mudou.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Chamado depois que as dimensões do controle foram alteradas.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Chamado quando o controle foi ativado ui.|
|[COleControl::OnTextChanged](#ontextchanged)|Chamado quando a propriedade Texto ou Legenda de estoque for alterada.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Processa mensagens de janela (além de mensagens de mouse e teclado) para controles sem janelas.|
|[COleControl::ParentToClient](#parenttoclient)|Traduz um ponto relativo à origem do contêiner a um ponto relativo à origem do controle.|
|[COleControl::PostModalDialog](#postmodaldialog)|Notifica o contêiner de que uma caixa de diálogo modal foi fechada.|
|[COleControl::PreModalDialog](#premodaldialog)|Notifica o recipiente de que uma caixa de diálogo modal está prestes a ser exibida.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Destrói e recria a janela do controle.|
|[COleControl::Atualização](#refresh)|Força uma repintura da aparência de um controle.|
|[COleControl::Captura de lançamento](#releasecapture)|Libera a captura do mouse.|
|[COleControl::ReleaseDC](#releasedc)|Libera o contexto do dispositivo de exibição de um contêiner de um controle sem janelas.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Redefine o pai da janela de controle.|
|[COleControl::ResetStockProps](#resetstockprops)|Inicializa `COleControl` as propriedades de estoque para seus valores padrão.|
|[COleControl::ResetVersion](#resetversion)|Inicializa o número da versão para um determinado valor.|
|[COleControl::ScrollWindow](#scrollwindow)|Permite que um controle sem janelas role uma área dentro de sua imagem ativa no local no visor.|
|[COleControl::SelectFontObject](#selectfontobject)|Seleciona uma propriedade Font personalizada em um contexto de dispositivo.|
|[COleControl::SelectStockFont](#selectstockfont)|Seleciona a propriedade Stock Font em um contexto de dispositivo.|
|[COleControl::SerializeExtent](#serializeextent)|Serializa ou inicializa o espaço de exibição para o controle.|
|[COleControl::SerializeStockProps](#serializestockprops)|Serializa ou inicializa `COleControl` as propriedades do estoque.|
|[COleControl::SerializeVersion](#serializeversion)|Serializa ou inicializa as informações da versão do controle.|
|[COleControl::SetAppearance](#setappearance)|Define o valor da propriedade Aparência de estoque.|
|[COleControl::SetBackColor](#setbackcolor)|Define o valor da propriedade BackColor de estoque.|
|[COleControl::SetBorderStyle](#setborderstyle)|Define o valor da propriedade BorderStyle de estoque.|
|[COleControl::SetCapture](#setcapture)|Faz com que a janela do contêiner do controle tome posse da captura do mouse em nome do controle.|
|[COleControl::SetControlSize](#setcontrolsize)|Define a posição e o tamanho do controle OLE.|
|[COleControl::SetEnabled](#setenabled)|Define o valor da propriedade habilitada do estoque.|
|[COleControl::SetFocus](#setfocus)|Faz com que a janela de contêiner do controle tome posse do foco de entrada em nome do controle.|
|[COleControl::SetFont](#setfont)|Define o valor da propriedade font de estoque.|
|[COleControl::SetForeColor](#setforecolor)|Define o valor da propriedade ForeColor de estoque.|
|[COleControl::SetInitialSize](#setinitialsize)|Define o tamanho de um controle OLE quando exibido pela primeira vez em um recipiente.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Muda o estado modificado de um controle.|
|[COleControl::SetNotAllowed](#setnotpermitted)|Indica que uma solicitação de edição falhou.|
|[COleControl::SetNotSupported](#setnotsupported)|Impede a modificação do valor de propriedade de um controle pelo usuário.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Define o retângulo do controle em relação ao seu recipiente.|
|[COleControl::SetText](#settext)|Define o valor da propriedade Texto ou Legenda de estoque.|
|[COleControl::ThrowError](#throwerror)|Sinaliza que ocorreu um erro em um controle OLE.|
|[COleControl::TransformCoords](#transformcoords)|Transforma valores de coordenadas entre um recipiente e o controle.|
|[COleControl::TranslateColor](#translatecolor)|Converte um valor de OLE_COLOR em um valor COLORREF.|
|[COleControl::WillAmbientsBeValidDurante carga](#willambientsbevalidduringload)|Determina se as propriedades ambientais estarão disponíveis na próxima vez que o controle for carregado.|
|[COleControl::WindowProc](#windowproc)|Fornece um procedimento `COleControl` do Windows para um objeto.|

### <a name="protected-methods"></a>Métodos Protegidos

|Nome|Descrição|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Chamado pelo framework quando a aparência do controle precisa ser atualizada.|
|[COleControl::DrawMetafile](#drawmetafile)|Chamado pela estrutura quando o contexto do dispositivo de metaarquivo está sendo usado.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Permite a invocação do método de automação.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Chamado pelo framework para inicializar a lista de formatos de dados suportados pelo controle.|

## <a name="remarks"></a>Comentários

Derivado de `CWnd`, esta classe herda toda a funcionalidade de um objeto de janela do Windows mais funcionalidadeadicional específica para OLE, como disparo de eventos e a capacidade de suportar métodos e propriedades.

Os controles OLE podem ser inseridos em aplicações de contêineres OLE e comunicar-se com o contêiner usando um sistema bidirecional de disparo de eventos e expondo métodos e propriedades ao recipiente. Observe que os recipientes OLE padrão só suportam a funcionalidade básica de um controle OLE. Eles não são capazes de suportar recursos estendidos de um controle OLE. O disparo do evento ocorre quando os eventos são enviados para o contêiner como resultado de determinadas ações ocorrendo no controle. Por sua vez, o recipiente se comunica com o controle usando um conjunto exposto de métodos e propriedades análogas às funções do membro e membros de dados de uma classe C++. Essa abordagem permite que o desenvolvedor controle a aparência do controle e notifique o contêiner quando determinadas ações ocorrem.

## <a name="windowless-controls"></a>Controles sem janelas

Os controles OLE podem ser usados no local ativos sem uma janela. Controles sem janelas têm vantagens significativas:

- Controles sem janelas podem ser transparentes e não retangulares

- Controles sem janelas reduzem o tamanho da ocorrência e o tempo de criação do objeto

Os controles não precisam de uma janela. Serviços que uma janela oferece podem ser facilmente fornecidos através de uma única janela compartilhada (geralmente do contêiner) e um pouco de código de expedição. Ter uma janela é principalmente uma complicação desnecessária no objeto.

Quando a ativação sem janelas é usada, o contêiner (que tem uma janela) é responsável pela prestação de serviços que, de outra forma, teriam sido fornecidos pela própria janela do controle. Por exemplo, se o seu controle precisar consultar o foco do teclado, consultar a captura do mouse ou obter um contexto de dispositivo, essas operações serão gerenciadas pelo contêiner. As `COleControl` funções do membro de operação sem janelas invocam essas operações no contêiner.

Quando a ativação sem janelas é ativada, o `IOleInPlaceObjectWindowless` contêiner delega mensagens de entrada na interface do controle (uma extensão do [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) para suporte sem janelas). `COleControl`a implementação desta interface enviará essas mensagens através do mapa de mensagens do seu controle, depois de ajustar as coordenadas do mouse apropriadamente. Você pode processar essas mensagens como mensagens de janela comuns, adicionando as entradas correspondentes ao mapa de mensagens.

Em um controle sem janelas, `COleControl` você deve sempre `CWnd` usar as funções do membro em vez das funções de membro correspondentes ou suas funções relacionadas da API do Windows.

Os objetos de controle OLE também podem criar uma janela apenas quando se tornam ativos, mas a quantidade de trabalho necessária para a transição inativa sobe e a velocidade da transição diminui. Há casos em que isso é um problema: como exemplo, considere uma grade de caixas de texto. Ao fazer curso para cima e para baixo através da coluna, cada controle deve ser ativado no local e, em seguida, desativado. A velocidade da transição inativa/ativa afetará diretamente a velocidade de rolagem.

Para obter mais informações sobre o desenvolvimento de uma estrutura de controle OLE, consulte os artigos [MFC ActiveX Controls](../../mfc/mfc-activex-controls.md) and [Overview: Creating a MFC ActiveX Control Program](../../mfc/reference/mfc-activex-control-wizard.md). Para obter informações sobre a otimização dos controles OLE, incluindo controles sem janelas e sem cintilação, consulte [Controles MFC ActiveX: Otimização](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Hierarquia de herança

[Cobject](../../mfc/reference/cobject-class.md)

[Ccmdtarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Requisitos

**Cabeçalho:** afxctl.h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>COleControl::AmbientBackColor

Retorna o valor da propriedade BackColor ambiente.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Valor retornado

O valor atual da propriedade backcolor ambiente do contêiner, se houver. Se a propriedade não for suportada, essa função reameda a cor de fundo do Windows definida pelo sistema.

### <a name="remarks"></a>Comentários

A propriedade backcolor ambiente está disponível para todos os controles e é definida pelo contêiner. Observe que o recipiente não é necessário para suportar esta propriedade.

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>COleControl::AmbientDisplayName

O nome atribuído ao contêiner ao controle pode ser usado em mensagens de erro exibidas ao usuário.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Valor retornado

O nome do controle OLE. O padrão é uma seqüência de comprimento zero.

### <a name="remarks"></a>Comentários

Observe que o recipiente não é necessário para suportar esta propriedade.

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>COleControl::AmbientFont

Devolve o valor da propriedade Font ambiente.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para a interface de despacho de fonte ambiente do contêiner. O valor padrão é NULL. Se o retorno não for igual a NULL, você será responsável por liberar a fonte chamando sua função de membro [IUnknown::Release.](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)

### <a name="remarks"></a>Comentários

A propriedade font ambiente é definida pelo contêiner e disponível para todos os controles. Observe que o recipiente não é necessário para suportar esta propriedade.

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>COleControl::AmbientForeColor

Retorna o valor da propriedade ForeColor ambiente.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Valor retornado

O valor atual da propriedade ForeColor ambiente do contêiner, se houver. Se não for suportado, esta função retorna a cor de texto do Windows definida pelo sistema.

### <a name="remarks"></a>Comentários

A propriedade ForeColor ambiente está disponível para todos os controles e é definida pelo contêiner. Observe que o recipiente não é necessário para suportar esta propriedade.

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>COleControl::AmbientLocaleID

Devolve o ID local do contêiner.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Valor retornado

O valor da propriedade LocaleID do contêiner, se houver. Se esta propriedade não for suportada, esta função retorna 0.

### <a name="remarks"></a>Comentários

O controle pode usar o LocaleID para adaptar sua interface de usuário para locais específicos. Observe que o recipiente não é necessário para suportar esta propriedade.

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>COleControl::Aparência ambiente

Recupera a configuração de aparência atual para o objeto de controle.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Valor retornado

A aparência do controle:

- **0** Aparência plana

- **1** aparência 3D

### <a name="remarks"></a>Comentários

Chame esta função para recuperar o valor atual da propriedade DISPID_AMBIENT_APPEARANCE para o controle.

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits

Retorna o tipo de unidades utilizadas pelo recipiente.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Valor retornado

Uma seqüência contendo as Escalas ambienteS do recipiente. Se esta propriedade não for suportada, esta função retorna uma seqüência de comprimento zero.

### <a name="remarks"></a>Comentários

A propriedade ScaleUnits ambiente do contêiner pode ser usada para exibir posições ou dimensões, rotuladas com a unidade escolhida, como twips ou centímetros. Observe que o recipiente não é necessário para suportar esta propriedade.

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles

Determina se o recipiente permite que o controle exiba as alças de captura para si mesmo quando ativo.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Valor retornado

Não zero se as alças de agarramento devem ser exibidas; caso contrário, 0. Se esta propriedade não for suportada, esta função retorna não zero.

### <a name="remarks"></a>Comentários

Observe que o recipiente não é necessário para suportar esta propriedade.

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>COleControl::AmbientShowHatching

Determina se o recipiente permite que o controle se exiba com um padrão eclodido quando a iu ativa.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Valor retornado

Não zero se o padrão eclodido for mostrado; caso contrário, 0. Se esta propriedade não for suportada, esta função retorna não zero.

### <a name="remarks"></a>Comentários

Observe que o recipiente não é necessário para suportar esta propriedade.

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>COleControl::AmbientTextAlign

Determina o alinhamento de texto ambiente preferido pelo recipiente de controle.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Valor retornado

O status da propriedade textalign ambiente do contêiner. Se esta propriedade não for suportada, esta função retorna 0.

A seguir está uma lista de valores de retorno válidos:

|Valor retornado|Significado|
|------------------|-------------|
|0|Alinhamento geral (números à direita, texto para a esquerda).|
|1|Esquerda justificar|
|2|Centro|
|3|Justifique certo|

### <a name="remarks"></a>Comentários

Esta propriedade está disponível para todos os controles incorporados e é definida pelo contêiner. Observe que o recipiente não é necessário para suportar esta propriedade.

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>COleControl::AmbientUIDead

Determina se o contêiner deseja que o controle responda às ações de interface do usuário.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Valor retornado

Não zero se o controle responder às ações de interface do usuário; caso contrário, 0. Se esta propriedade não for suportada, esta função retorna 0.

### <a name="remarks"></a>Comentários

Por exemplo, um contêiner pode definir isso como TRUE no modo de design.

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>COleControl::AmbientUserMode

Determina se o contêiner está no modo de design ou no modo de usuário.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Valor retornado

Não zero se o contêiner estiver no modo de usuário; caso contrário 0 (no modo de design). Se esta propriedade não for suportada, esta função retorna TRUE.

### <a name="remarks"></a>Comentários

Por exemplo, um contêiner pode definir isso como FALSE no modo de design.

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>COleControl::BoundPropertyChanged

Sinais de que o valor da propriedade vinculada mudou.

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parâmetros

*Dispid*<br/>
A id de despacho de uma propriedade vinculada do controle.

### <a name="remarks"></a>Comentários

Isso deve ser chamado toda vez que o valor do imóvel mudar, mesmo nos casos em que a alteração não foi feita através do método conjunto de propriedades. Esteja particularmente ciente das propriedades vinculadas que são mapeadas para as variáveis dos membros. Sempre que essa variável `BoundPropertyChanged` de membro muda, deve ser chamada.

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdit

Solicita permissão `IPropertyNotifySink` da interface para alterar um valor de propriedade vinculado fornecido pelo controle.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parâmetros

*Dispid*<br/>
A id de despacho de uma propriedade vinculada do controle.

### <a name="return-value"></a>Valor retornado

Não zero se a alteração for permitida; caso contrário, 0. O valor padrão não é zero.

### <a name="remarks"></a>Comentários

Se a permissão for negada, o controle não deve deixar que o valor da propriedade mude. Isso pode ser feito ignorando ou falhando na ação que tentou alterar o valor do imóvel.

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>COleControl::ClientToParent

Traduz as coordenadas de *pPoint* em coordenadas-pai.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parâmetros

*lprcBounds*<br/>
Ponteiro para os limites do controle OLE dentro do recipiente. Não a área do cliente, mas a área de todo o controle, incluindo bordas e barras de rolagem.

*Ppoint*<br/>
Ponteiro para o ponto de área do cliente OLE a ser traduzido nas coordenadas do pai (contêiner).

### <a name="remarks"></a>Comentários

Na entrada *pPoint* é relativo à origem da área cliente do controle OLE (canto superior esquerdo da área do cliente do controle). Na saída *pPoint* é relativo à origem do pai (canto superior esquerdo do recipiente).

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>COleControl::ClipCaretRect

Ajusta um retângulo de cuidado se estiver coberto total ou parcialmente por objetos opacos sobrepostos.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*Lprect*<br/>
Na entrada, um ponteiro para uma estrutura [RECT](/windows/win32/api/windef/ns-windef-rect) que contém a área de cuidado a ser ajustada. Na saída, a área de cuidado ajustada, ou NULL se o retângulo de caret estiver completamente coberto.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Um caret é uma linha intermitente, bloco ou bitmap que normalmente indica onde texto ou gráficos serão inseridos.

Um objeto sem janelas não pode mostrar com segurança um cuidado sem antes verificar se o cuidador está parcial ou totalmente escondido por objetos sobrepostos. Para que isso seja possível, `ClipCaretRect` um objeto pode usar para ajustar o cuidador (reduzido) para garantir que ele se encaixe na região de recorte.

Os objetos que criam um caret `ClipCaretRect` devem submeter o retângulo da caret a e usar o retângulo ajustado para o cuidado. Se o cuidador estiver totalmente escondido, este método retornará FALSO e o careta não deve ser mostrado neste caso.

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>COleControl::COleControl

Constrói um objeto `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Comentários

Esta função normalmente não é chamada diretamente. Em vez disso, o controle OLE é geralmente criado por sua fábrica de classe.

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>COleControl::ControlInfoChanged

Chame esta função quando o conjunto de mnemônicos suportados pelo controle tiver sido alterado.

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>Comentários

Ao receber esta notificação, o contêiner do controle obtém o novo conjunto de mnemônicos fazendo uma chamada para [IOleControl::GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Observe que o contêiner não é obrigado a responder a esta notificação.

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>COleControl::DisplayError

Chamado pelo framework após o evento de erro de estoque ter sido tratado (a menos que o manipulador de eventos tenha suprimido a exibição do erro).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parâmetros

*Scode*<br/>
O valor do código de status a ser relatado. Para obter uma lista completa de possíveis códigos, consulte o artigo [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescrição*<br/>
A descrição do erro que está sendo relatado.

*lpszFonte*<br/>
O nome do módulo que gera o erro (normalmente, o nome do módulo de controle OLE).

*lpszHelpFile*<br/>
O nome do arquivo de ajuda contendo uma descrição do erro.

*nHelpID*<br/>
O ID de contexto de ajuda do erro que está sendo relatado.

### <a name="remarks"></a>Comentários

O comportamento padrão exibe uma caixa de mensagem contendo a descrição do erro, contida em *lpszDescription*.

Anular esta função para personalizar a forma como os erros são exibidos.

## <a name="colecontroldoclick"></a><a name="doclick"></a>COleControl::DoClick

Simula uma ação de clique do mouse no controle.

```cpp
void DoClick();
```

### <a name="remarks"></a>Comentários

A função `COleControl::OnClick` de membro superridable será chamada, e um evento stock Click será acionado, se apoiado pelo controle.

Esta função é suportada pela `COleControl` classe base como um método de estoque, chamado DoClick. Para obter mais informações, consulte o artigo [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>COleControl::DoPropExchange

Chamado pela estrutura ao carregar ou armazenar um controle de uma representação de armazenamento persistente, como um conjunto de fluxo ou propriedade.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parâmetros

*pPX*<br/>
Um ponteiro para um objeto `CPropExchange`. A estrutura fornece este objeto para estabelecer o contexto da troca de propriedades, incluindo sua direção.

### <a name="remarks"></a>Comentários

Esta função normalmente faz chamadas para a família **de funções PX_** para carregar ou armazenar propriedades específicas definidas pelo usuário de um controle OLE.

Se o Assistente de Controle tiver sido usado para criar o projeto de controle OLE, `COleControl` a versão substituída desta `COleControl::DoPropExchange`função serializará as propriedades de estoque suportadas por uma chamada para a função de classe base, . À medida que você adiciona propriedades definidas pelo usuário ao controle OLE, você precisará modificar essa função para serializar suas novas propriedades. Para obter mais informações sobre serialização, consulte o artigo [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint

Redesenha um controle OLE que foi subclassificado a partir de um controle do Windows.

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Um ponteiro para o contexto do dispositivo do recipiente de controle.

*Rcbounds*<br/>
A área em que o controle deve ser desenhado.

### <a name="remarks"></a>Comentários

Chame esta função para manusear corretamente a pintura de um controle OLE não ativo. Esta função só deve ser usada se o controle OLE subclasses um controle do Windows e deve ser chamado na função do `OnDraw` seu controle.

Para obter mais informações sobre esta função e subclassificar um controle do Windows, consulte o artigo [ActiveX Controls: Subclassing a Windows Control](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>COleControl::DrawContent

Chamado pelo framework quando a aparência do controle precisa ser atualizada.

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Ponteiro para o contexto do dispositivo.

*Rc*<br/>
Área retangular a ser desenhada.

### <a name="remarks"></a>Comentários

Esta função chama diretamente `OnDraw` a função superridable.

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>COleControl::DrawMetafile

Chamado pela estrutura quando o contexto do dispositivo de metaarquivo está sendo usado.

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Ponteiro para o contexto do dispositivo de metaarquivo.

*Rc*<br/>
Área retangular a ser desenhada.

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>COleControl::Habilitarquadro simples

Permite a característica de quadro simples para um controle OLE.

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>Comentários

Esta característica permite um controle para suportar a contenção visual de outros controles, mas não a verdadeira contenção OLE. Um exemplo seria uma caixa de grupo com vários controles dentro. Estes controles não são contidos em OLE, mas estão na mesma caixa de grupo.

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>COleControl::ExchangeExtent

Serializa ou inicializa o estado da extensão do controle (suas dimensões em unidades HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parâmetros

*pPX*<br/>
Um ponteiro para um objeto [CPropExchange.](../../mfc/reference/cpropexchange-class.md) A estrutura fornece este objeto para estabelecer o contexto da troca de propriedades, incluindo sua direção.

### <a name="return-value"></a>Valor retornado

Não zero se a função foi bem sucedida; 0 caso contrário.

### <a name="remarks"></a>Comentários

Esta função é normalmente chamada `COleControl::DoPropExchange`pela implementação padrão de .

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>COleControl::ExchangeStockProps

Serializa ou inicializa o estado das propriedades de estoque do controle.

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parâmetros

*pPX*<br/>
Um ponteiro para um objeto [CPropExchange.](../../mfc/reference/cpropexchange-class.md) A estrutura fornece este objeto para estabelecer o contexto da troca de propriedades, incluindo sua direção.

### <a name="remarks"></a>Comentários

Esta função é normalmente chamada `COleControl::DoPropExchange`pela implementação padrão de .

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>COleControl::ExchangeVersion

Serializa ou inicializa o estado das informações da versão de um controle.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parâmetros

*pPX*<br/>
Um ponteiro para um objeto `CPropExchange`. A estrutura fornece este objeto para estabelecer o contexto da troca de propriedades, incluindo sua direção.

*dwVersionDefault*<br/>
O número da versão atual do controle.

*bConverter*<br/>
Indica se os dados persistentes devem ser convertidos para o formato mais recente quando salvos ou mantidos no mesmo formato que foi carregado.

### <a name="return-value"></a>Valor retornado

Não zero da função conseguiu; 0 caso contrário.

### <a name="remarks"></a>Comentários

Normalmente, esta será a primeira função chamada por `COleControl::DoPropExchange`uma substituição de controle de . Ao carregar, essa função lê o número da versão dos dados persistentes e define o atributo de versão do objeto [CPropExchange](../../mfc/reference/cpropexchange-class.md) de acordo. Ao salvar, esta função grava o número da versão dos dados persistentes.

Para obter mais informações sobre persistência e versionamento, consulte o artigo [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>COleControl::FireClick

Chamado pela estrutura quando o mouse é clicado sobre um controle ativo.

```cpp
void FireClick();
```

### <a name="remarks"></a>Comentários

Se este evento for definido como um evento personalizado, você determinará quando o evento será acionado.

Para que o disparo automático de um evento clique ocorra, o mapa Evento do controle deve ter um evento de clique de estoque definido.

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>COleControl::FireDblClick

Chamado pela estrutura quando o mouse é clicado duas vezes sobre um controle ativo.

```cpp
void FireDblClick();
```

### <a name="remarks"></a>Comentários

Se este evento for definido como um evento personalizado, você determinará quando o evento será acionado.

Para que a disparo automático de um evento DblClick ocorra, o mapa Event do controle deve ter um evento DblClick de estoque definido.

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>COleControl::FireError

Dispara o evento de erro de estoque.

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parâmetros

*Scode*<br/>
O valor do código de status a ser relatado. Para obter uma lista completa de possíveis códigos, consulte o artigo [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescrição*<br/>
A descrição do erro que está sendo relatado.

*nHelpID*<br/>
O ID de ajuda do erro que está sendo relatado.

### <a name="remarks"></a>Comentários

Este evento fornece uma maneira de sinalizar, em locais apropriados em seu código, que ocorreu um erro dentro do seu controle. Ao contrário de outros eventos de ações, como Click ou MouseMove, o erro nunca é disparado pela estrutura.

Para relatar um erro que ocorre durante uma função de obter propriedades, função de conjunto de propriedades ou método de automação, ligue para [COleControl::ThrowError](#throwerror).

A implementação do evento De erro de estoque de um controle OLE usa um valor SCODE. Se o seu controle usar este evento, e for destinado a ser usado no Visual Basic 4.0, você receberá erros porque o valor SCODE não é suportado no Visual Basic.

Para corrigir isso, altere manualmente o parâmetro SCODE no controle . Arquivo ODL para um **longo**. Além disso, qualquer evento personalizado, método ou propriedade que use um parâmetro SCODE também causa o mesmo problema.

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>COleControl::FireEvent

Dispara um evento definido pelo usuário a partir do seu controle com qualquer número de argumentos opcionais,.

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parâmetros

*Dispid*<br/>
A id do evento a ser disparada.

*pbParams*<br/>
Um descritor para os tipos de parâmetros do evento.

### <a name="remarks"></a>Comentários

Normalmente essa função não deve ser chamada diretamente. Em vez disso, você chamará as funções de disparo de eventos na seção mapa de eventos da declaração de classe do seu controle.

O *argumento pbParams* é uma lista de **VTS_.** Um ou mais desses valores, separados por espaços (não commas), especifica a lista de parâmetros da função. Os valores possíveis são:

|Símbolo|Tipo de parâmetro|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|Ole_xpos_pixels|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> Foram definidas constantes adicionais de variantes para todos os tipos de variantes, com exceção de VTS_FONT e VTS_PICTURE, que fornecem um ponteiro para a constante de dados da variante. Essas constantes são nomeadas usando a convenção **VTS_P.** `constantname` Por exemplo, VTS_PCOLOR é um ponteiro para uma VTS_COLOR constante.

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>COleControl::FireKeyDown

Chamado pelo framework quando uma tecla é pressionada enquanto o controle está ativo.

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parâmetros

*pnChar*<br/>
Ponteiro para o valor de código de chave virtual da tecla pressionada. Para obter uma lista de códigos-chave virtuais padrão, consulte Winuser.h

*nShiftState*<br/>
Contém uma combinação das seguintes bandeiras:

- SHIFT_MASK A tecla SHIFT foi pressionada durante a ação.

- CTRL_MASK a tecla CTRL foi pressionada durante a ação.

- ALT_MASK A tecla ALT foi pressionada durante a ação.

### <a name="remarks"></a>Comentários

Se este evento for definido como um evento personalizado, você determinará quando o evento será acionado.

Para que ocorra a disparo automático de um evento KeyDown, o mapa Event do controle deve ter um evento KeyDown de estoque definido.

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>COleControl::FireKeyPress

Chamado pela estrutura quando uma tecla é pressionada e liberada enquanto o controle personalizado é UI Active dentro do recipiente.

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parâmetros

*pnChar*<br/>
Um ponteiro para o valor do caractere da tecla pressionada.

### <a name="remarks"></a>Comentários

Se este evento for definido como um evento personalizado, você determinará quando o evento será acionado.

O destinatário do evento pode modificar *pnChar,* por exemplo, converter todos os caracteres minúsculos em maiúsculas. Se você quiser examinar o caractere `OnKeyPressEvent`modificado, anular .

Para que ocorra o disparo automático de um evento KeyPress, o mapa Event do controle deve ter um evento keypress de estoque definido.

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>COleControl::FireKeyUp

Chamado pela estrutura quando uma chave é liberada enquanto o controle personalizado é UI Active dentro do contêiner.

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parâmetros

*pnChar*<br/>
Ponteiro para o valor do código de chave virtual da chave liberada. Para obter uma lista de códigos-chave virtuais padrão, consulte Winuser.h

*nShiftState*<br/>
Contém uma combinação das seguintes bandeiras:

- SHIFT_MASK A tecla SHIFT foi pressionada durante a ação.

- CTRL_MASK a tecla CTRL foi pressionada durante a ação.

- ALT_MASK A tecla ALT foi pressionada durante a ação.

### <a name="remarks"></a>Comentários

Se este evento for definido como um evento personalizado, você determinará quando o evento será acionado.

Para que ocorra o disparo automático de um evento KeyUp, o mapa Event do controle deve ter um evento keyup de estoque definido.

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>COleControl::FireMouseDown

Chamado pela estrutura quando um botão do mouse é pressionado sobre um controle personalizado ativo.

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parâmetros

*nBotão*<br/>
O valor numérico do botão do mouse pressionado. Pode conter um dos seguintes valores:

- LEFT_BUTTON O botão esquerdo do mouse foi pressionado para baixo.

- MIDDLE_BUTTON O botão do mouse do meio foi pressionado para baixo.

- RIGHT_BUTTON O botão direito do mouse foi pressionado para baixo.

*nShiftState*<br/>
Contém uma combinação das seguintes bandeiras:

- SHIFT_MASK A tecla SHIFT foi pressionada durante a ação.

- CTRL_MASK a tecla CTRL foi pressionada durante a ação.

- ALT_MASK A tecla ALT foi pressionada durante a ação.

*x*<br/>
A coordenada x do cursor quando um botão do mouse foi pressionado para baixo. A coordenada é relativa ao canto superior esquerdo da janela de controle.

*Y*<br/>
A coordenada y do cursor quando um botão do mouse foi pressionado para baixo. A coordenada é relativa ao canto superior esquerdo da janela de controle.

### <a name="remarks"></a>Comentários

Se este evento for definido como um evento personalizado, você determinará quando o evento será acionado.

Para que ocorra o disparo automático de um evento MouseDown, o mapa Event do controle deve ter um evento mouseDown de estoque definido.

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>COleControl::FireMouseMove

Chamado pela estrutura quando o cursor é movido sobre um controle personalizado ativo.

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parâmetros

*nBotão*<br/>
O valor numérico dos botões do mouse pressionados. Contém uma combinação dos seguintes valores:

- LEFT_BUTTON O botão esquerdo do mouse foi pressionado durante a ação.

- MIDDLE_BUTTON O botão do mouse do meio foi pressionado durante a ação.

- RIGHT_BUTTON O botão direito do mouse foi pressionado durante a ação.

*nShiftState*<br/>
Contém uma combinação das seguintes bandeiras:

- SHIFT_MASK A tecla SHIFT foi pressionada durante a ação.

- CTRL_MASK a tecla CTRL foi pressionada durante a ação.

- ALT_MASK A tecla ALT foi pressionada durante a ação.

*x*<br/>
A coordenada x do cursor. A coordenada é relativa ao canto superior esquerdo da janela de controle.

*Y*<br/>
A coordenada y do cursor. A coordenada é relativa ao canto superior esquerdo da janela de controle.

### <a name="remarks"></a>Comentários

Se este evento for definido como um evento personalizado, você determinará quando o evento será acionado.

Para que ocorra o disparo automático de um evento MouseMove, o mapa Event do controle deve ter um evento mouseMove de estoque definido.

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>COleControl::FireMouseUp

Chamado pela estrutura quando um botão do mouse é liberado sobre um controle personalizado ativo.

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parâmetros

*nBotão*<br/>
O valor numérico do botão do mouse liberado. Pode ter um dos seguintes valores:

- LEFT_BUTTON O botão esquerdo do mouse foi liberado.

- MIDDLE_BUTTON O botão do mouse do meio foi liberado.

- RIGHT_BUTTON O botão direito do mouse foi liberado.

*nShiftState*<br/>
Contém uma combinação das seguintes bandeiras:

- SHIFT_MASK A tecla SHIFT foi pressionada durante a ação.

- CTRL_MASK a tecla CTRL foi pressionada durante a ação.

- ALT_MASK A tecla ALT foi pressionada durante a ação.

*x*<br/>
A coordenada x do cursor quando um botão do mouse foi liberado. A coordenada é relativa ao canto superior esquerdo da janela de controle.

*Y*<br/>
A coordenada y de um cursor quando um botão do mouse foi lançado. A coordenada é relativa ao canto superior esquerdo da janela de controle.

### <a name="remarks"></a>Comentários

Se este evento for definido como um evento personalizado, você determinará quando o evento será acionado.

Para que o disparo automático de um evento MouseUp ocorra, o mapa Event do controle deve ter um evento mouseUp de estoque definido.

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>COleControl::FireReadyStateChange

Dispara um evento com o valor atual do estado de controle pronto.

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>Comentários

O estado pronto pode ser um dos seguintes valores:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialização padrão|
|READYSTATE_LOADING|Control está atualmente carregando suas propriedades|
|READYSTATE_LOADED|O controle foi inicializado|
|READYSTATE_INTERACTIVE|O controle tem dados suficientes para ser interativo, mas nem todos os dados assíncronos ainda estão carregados|
|Readystate_complete|Control tem todos os seus dados|

Use [GetReadyState](#getreadystate) para determinar a prontidão atual do controle.

[InternalSetReadyState](#internalsetreadystate) altera o estado pronto para `FireReadyStateChange`o valor fornecido e, em seguida, chama .

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>COleControl::GetActivationPolicy

Altera o comportamento de ativação padrão `IPointerInactive` de um controle que suporta a interface.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Valor retornado

Uma combinação de bandeiras da enumeração POINTERINACTIVE. As possíveis bandeiras são:

|||
|-|-|
|Pointerinactive_activateonentry|O objeto deve ser ativado no local quando o mouse entrar nele durante uma operação de movimento do mouse.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|O objeto deve ser desativado quando o mouse deixar o objeto durante uma operação de movimento do mouse.|
|POINTERINACTIVE_ACTIVATEONDRAG|O objeto deve ser ativado no local quando o mouse for arrastado sobre ele durante uma operação de arrastar e soltar.|

### <a name="remarks"></a>Comentários

Quando `IPointerInactive` a interface estiver ativada, o contêiner delegará WM_SETCURSOR e WM_MOUSEMOVE mensagens para ele. `COleControl`a implementação desta interface enviará essas mensagens através do mapa de mensagens do seu controle, depois de ajustar as coordenadas do mouse apropriadamente.

Sempre que o contêiner receber uma mensagem WM_SETCURSOR ou `IPointerInactive`WM_MOUSEMOVE com `GetActivationPolicy` o ponteiro do mouse sobre um objeto inativo suportando, ele deve ligar para a interface e retornar bandeiras da enumeração POINTERINACTIVE.

Você pode processar essas mensagens como mensagens de janela comuns, adicionando as entradas correspondentes ao mapa de mensagens. Em seus manipuladores, `m_hWnd` evite usar a variável membro (ou quaisquer funções de membro que a use) sem antes verificar se seu valor não é NULA.

Qualquer objeto destinado a fazer mais do que definir o cursor do mouse e/ou disparar um evento de movimento do mouse, como dar feedback visual especial, deve retornar o POINTERINACTIVE_ACTIVATEONENTRY bandeira e desenhar o feedback somente quando ativo. Se o objeto retornar este sinalizador, o recipiente deve ativá-lo no local imediatamente `GetActivationPolicy`e, em seguida, encaminhá-lo a mesma mensagem que acionou a chamada para .

Se as bandeiras POINTERINACTIVE_ACTIVATEONENTRY e POINTERINACTIVE_DEACTIVATEONLEAVE forem devolvidas, o objeto só será ativado quando o mouse estiver sobre o objeto. Se apenas a bandeira POINTERINACTIVE_ACTIVATEONENTRY for devolvida, o objeto só será ativado uma vez quando o mouse entrar primeiro no objeto.

Você também pode querer que um controle inativo seja o alvo de uma operação de arrastar e soltar OLE. Isso requer ativar o controle no momento em que o usuário arrasta um objeto sobre ele, para que a janela do controle possa ser registrada como um alvo de queda. Para que a ativação ocorra durante um arrasto, retorne a bandeira POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

As informações comunicadas não `GetActivationPolicy` devem ser armazenadas em cache por um contêiner. Em vez disso, este método deve ser chamado toda vez que o mouse entra em um objeto inativo.

Se um objeto inativo não solicitar que o mouse esteja ativado no local quando o mouse entrar nele, seu contêiner deverá enviar mensagens WM_SETCURSOR subseqüentes para este objeto, chamando [OnInactiveSetCursor](#oninactivesetcursor) enquanto o ponteiro do mouse permanecer sobre o objeto.

Ativar a `IPointerInactive` interface normalmente significa que você quer que o controle seja capaz de processar mensagens de mouse o tempo todo. Para obter esse comportamento em um recipiente `IPointerInactive` que não suporta a interface, você precisará ter seu controle sempre ativado quando visível, o que significa que o controle deve ter a bandeira OLEMISC_ACTIVATEWHENVISIBLE entre suas bandeiras diversas. No entanto, para evitar que essa bandeira `IPointerInactive`faça efeito em um recipiente que faça suporte, você também pode especificar a bandeira OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>COleControl::GetAmbientProperty

Obtém o valor de uma propriedade ambiental do contêiner.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parâmetros

*Dwdispid*<br/>
A id de despacho da propriedade ambiental desejada.

*Vtprop*<br/>
Uma tag de tipo variante que especifica o tipo do valor a ser devolvido em *pvProp*.

*Pvprop*<br/>
Um ponteiro para o endereço da variável que receberá o valor da propriedade ou o valor de retorno. O tipo real deste ponteiro deve corresponder ao tipo especificado por *vtProp*.

|Vtprop|Tipo de pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Valor retornado

Não zero se a propriedade ambiente for suportada; caso contrário, 0.

### <a name="remarks"></a>Comentários

Se você `GetAmbientProperty` usar para recuperar as propriedades displayname e scaleUnits ambiente, `CString*`defina *vtProp* para VT_BSTR e *pvProp* para . Se você estiver recuperando a propriedade Font ambiente, defina *vtProp* para VT_FONT e *pvProp* para LPFONTDISP*.

Observe que as funções já foram fornecidas para propriedades ambientais comuns, como [AmbientBackColor](#ambientbackcolor) e [AmbientFont](#ambientfont).

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>COleControl::GetAppearance

Implementa a função Obter da propriedade aparência de estoque do seu controle.

```
short GetAppearance ();
```

### <a name="return-value"></a>Valor retornado

O valor de retorno especifica a configuração de aparência atual como um valor **curto** (VT_I2), se bem sucedido. Este valor é zero se a aparência do controle for plana e 1 se a aparência do controle for 3D.

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>COleControl::GetBackColor

Implementa a função Obter da propriedade BackColor de estoque do seu controle.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Valor retornado

O valor de retorno especifica a cor de fundo atual como um valor OLE_COLOR, se bem sucedido. Esse valor pode ser traduzido para um valor `TranslateColor`COLORREF com uma chamada para .

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>COleControl::GetBorderStyle

Implementa a função Obter da propriedade BorderStyle de estoque do seu controle.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Valor retornado

1 se o controle tiver uma borda normal; 0 se o controle não tiver fronteira.

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>COleControl::GetCapture

Determina se `COleControl` o objeto tem a captura do mouse.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Valor retornado

Se o controle for ativado e sem janelas, **retorne-o** se o controle tiver atualmente a captura do mouse (conforme determinado pelo contêiner do controle) ou NULL se ele não tiver a captura.

Caso contrário, `CWnd` retorna o objeto que tem `CWnd::GetCapture`a captura do mouse (mesmo que ).

### <a name="remarks"></a>Comentários

Um controle sem janela ativado recebe a captura do mouse quando [setCapture](#setcapture) é chamado.

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>COleControl::GetClassID

Chamado pela estrutura para recuperar o ID de classe OLE do controle.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parâmetros

*Pclsid*<br/>
Ponteiro para a localização do ID da classe.

### <a name="return-value"></a>Valor retornado

Não zero se a chamada não foi bem sucedida; caso contrário, 0.

### <a name="remarks"></a>Comentários

Geralmente implementado pelo [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>COleControl::GetClientOffset

Recupera a diferença entre o canto superior esquerdo da área retangular do controle e o canto superior esquerdo de sua área cliente.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parâmetros

*pdxOffset*<br/>
Ponteiro para o deslocamento horizontal da área cliente do controle OLE.

*pdyOffset*<br/>
Ponteiro para o deslocamento vertical da área cliente do controle OLE.

### <a name="remarks"></a>Comentários

O controle OLE tem uma área retangular dentro de seu recipiente. A área cliente do controle é a área de controle excluindo bordas e barras de rolagem. O deslocamento recuperado `GetClientOffset` é a diferença entre o canto superior esquerdo da área retangular do controle e o canto superior esquerdo de sua área cliente. Se o seu controle tiver elementos não clientes que não as bordas padrão e as barras de rolagem, altere essa função de membro para especificar a compensação.

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>COleControl::GetClientRect

Recupera o tamanho da área de clientes do controle.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parâmetros

*Lprect*<br/>
Ponteiro para `RECT` uma estrutura que contenha as dimensões da área cliente do controle sem janelas; ou seja, o tamanho do controle menos bordas da janela, quadros, barras de rolagem, e assim por diante. O parâmetro *lpRect* indica o tamanho do retângulo do cliente do controle, não sua posição.

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>COleControl::GetClientSite

Consulta um objeto para o ponteiro para o seu site cliente atual dentro de seu contêiner.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para o site do cliente atual do controle em seu contêiner.

### <a name="remarks"></a>Comentários

O ponteiro retornado aponta `IOleClientSite`para uma instância de . A `IOleClientSite` interface, implementada por contêineres, é a visão do objeto de seu contexto: onde ele está ancorado no documento, onde obtém seu armazenamento, interface de usuário e outros recursos.

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>COleControl::GetControlFlags

Recupera as configurações do sinalizador de controle.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Valor retornado

Uma combinação ORed das bandeiras na enumeração ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Comentários

Por padrão, `GetControlFlags` retorna `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Se estiver definido, usa uma função start-paint adaptada para controles OLE em vez da API [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) (definida por padrão).|
|`clipPaintDC`|Se não estiver definido, `IntersectClipRect` desabilita `COleControl` a chamada feita por e ganha uma pequena vantagem de velocidade. Se você estiver usando ativação sem janelas, o sinalizador não tem efeito.|
|`pointerInactive`|Se definido, fornece interação do mouse enquanto `COleControl`seu controle `IPointerInactive` está inativo, ativando a implementação da interface, que é desativada por padrão.|
|`noFlickerActivate`|Se estiver definido, elimina as operações extras de desenho e a cintilação visual que acompanha. Use quando seu controle se desenha de forma idêntica nos estados inativos e ativos. Se você estiver usando ativação sem janelas, o sinalizador não tem efeito.|
|`windowlessActivate`|Se estiver definido, indica que seu controle usa ativação sem janelas.|
|`canOptimizeDraw`|Se estiver definido, indica que o controle executará o desenho otimizado, se o contêiner o suportar.|

Para obter `GetControlFlags` mais informações sobre e outras otimizações dos controles OLE, consulte [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>COleControl::GetControlSize

Recupera o tamanho da janela de controle OLE.

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parâmetros

*Pcx*<br/>
Especifica a largura do controle em pixels.

*pcy*<br/>
Especifica a altura do controle em pixels.

### <a name="remarks"></a>Comentários

Observe que todas as coordenadas para janelas de controle são relativas ao canto superior esquerdo do controle.

## <a name="colecontrolgetdc"></a><a name="getdc"></a>COleControl::GetDC

Fornece um objeto sem janelas para obter um contexto de dispositivo de tela (ou compatível) a partir de seu contêiner.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parâmetros

*lprcRect*<br/>
Um ponteiro para o retângulo que o controle sem janelas quer redesenhar, nas coordenadas do cliente do controle. NULL significa a extensão total do objeto.

*dwFlags*<br/>
Desenhando atributos do contexto do dispositivo. As opções são:

- OLEDC_NODRAW Indica que o objeto não usará o contexto do dispositivo para realizar qualquer desenho, mas apenas para obter informações sobre o dispositivo de exibição. O recipiente deve simplesmente passar o DC da janela sem mais processamento.

- OLEDC_PAINTBKGND Solicita que o recipiente pinte o fundo antes de retornar o DC. Um objeto deve usar este sinalizador se estiver solicitando um DC para redesenhar uma área com fundo transparente.

- OLEDC_OFFSCREEN Informa o contêiner que o objeto deseja renderizar em um bitmap fora da tela que deve ser copiado para a tela. Um objeto deve usar este sinalizador quando a operação de desenho que está prestes a realizar gera muita cintilação. O contêiner é livre para honrar este pedido ou não. No entanto, se este sinalizador não estiver definido, o recipiente deve devolver uma DC na tela. Isso permite que os objetos realizem operações de tela direta, como mostrar uma seleção (através de uma operação **XOR).**

### <a name="return-value"></a>Valor retornado

Ponteiro para o contexto do `CWnd` dispositivo de exibição para a área cliente do contêiner se for bem-sucedido; caso contrário, o valor de retorno é NULO. O contexto do dispositivo de exibição pode ser usado em funções GDI subseqüentes para desenhar na área cliente da janela do contêiner.

### <a name="remarks"></a>Comentários

A função de membro [ReleaseDC](#releasedc) deve ser chamada para liberar o contexto após a pintura. Ao `GetDC`ligar, os objetos passam pelo retângulo que desejam desenhar nas coordenadas de seus próprios clientes. `GetDC`traduz-as para coordenadas da área do cliente de contêineres. O objeto não deve solicitar um retângulo de desenho desejado maior do que seu próprio retângulo de área do cliente, o tamanho do qual pode ser recuperado com [GetClientRect](#getclientrect). Isso impede que os objetos desentem inadvertidamente onde não deveriam.

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>COleControl::GetEnabled

Implementa a função Obter do seu controle de propriedade habilitada.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Valor retornado

Não zero se o controle estiver ativado; caso contrário, 0.

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>COleControl::GetExtendedControl

Obtém um ponteiro para um objeto mantido pelo recipiente que representa o controle com um conjunto estendido de propriedades.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para o objeto de controle estendido do recipiente. Se não houver nenhum objeto disponível, o valor é NULO.

Este objeto pode ser `IDispatch` manipulado através de sua interface. Você também `QueryInterface` pode usar para obter outras interfaces disponíveis fornecidas pelo objeto. No entanto, o objeto não é necessário para suportar um conjunto específico de interfaces. Observe que confiar nas características específicas do objeto de controle estendido de um contêiner limita a portabilidade do seu controle a outros contêineres arbitrários.

### <a name="remarks"></a>Comentários

A função que chama esta função é responsável por liberar o ponteiro quando terminar com o objeto. Observe que o recipiente não é necessário para suportar este objeto.

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>COleControl::GetFocus

Determina se `COleControl` o objeto tem o foco.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Valor retornado

Se o controle estiver ativado e sem janelas, **retorne-o** se o controle tiver atualmente o foco do teclado (conforme determinado pelo contêiner do controle) ou NULL se ele não tiver o foco.

Caso contrário, `CWnd` retorna o objeto que `CWnd::GetFocus`tem o foco (mesmo que ).

### <a name="remarks"></a>Comentários

Um controle sem janela ativado recebe o foco quando [o SetFocus](#setfocus) é chamado.

## <a name="colecontrolgetfont"></a><a name="getfont"></a>COleControl::GetFont

Implementa a função Obter da propriedade Font stock.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para a interface de despacho de fonte da propriedade Font stock do controle.

### <a name="remarks"></a>Comentários

Observe que o chamador deve liberar o objeto quando terminar. Dentro da implementação do `InternalGetFont` controle, use para acessar o objeto Font de estoque do controle. Para obter mais informações sobre o uso de fontes no seu controle, consulte o artigo [ActiveX Controls: Usando fontes em um controle ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics

Mede as métricas `CFontHolder` de texto para qualquer objeto de propriedade do controle.

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parâmetros

*Lptm*<br/>
Ponteiro para uma estrutura [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

*fontHolder*<br/>
Referência a um objeto [CFontHolder.](../../mfc/reference/cfontholder-class.md)

### <a name="remarks"></a>Comentários

Essa fonte pode ser selecionada com a função [COleControl::SelectFontObject.](#selectfontobject) `GetFontTextMetrics`inicializará `TEXTMETRIC` a estrutura apontada pela *LPTM* com `fontHolder`informações métricas válidas sobre a fonte se for bem-sucedida, ou preencherá a estrutura com zeros se não for bem-sucedida. Você deve usar essa função em vez de [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) ao pintar seu controle porque os controles, como qualquer objeto OLE incorporado, podem ser necessários para se transformar em um metaarquivo.

A `TEXTMETRIC` estrutura da fonte padrão é atualizada quando a função [SelectFontObject](#selectfontobject) é chamada. Você deve `GetFontTextMetrics` ligar somente depois de selecionar a propriedade Font stock para garantir que as informações fornecidas sejam válidas.

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>COleControl::GetForeColor

Implementa a função Obter da propriedade ForeColor stock.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Valor retornado

O valor de retorno especifica a cor atual do primeiro plano como um valor OLE_COLOR, se bem sucedido. Esse valor pode ser traduzido para um valor `TranslateColor` [COLORREF](/windows/win32/gdi/colorref) com uma chamada para .

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>COleControl::GetHwnd

Implementa a função Get da propriedade hWnd de estoque.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Valor retornado

A alça da janela do controle OLE, se houver; caso contrário, NULL.

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>COleControl::GetMessageString

Chamado pela estrutura para obter uma seqüência curta que descreve o propósito do item do menu identificado por *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parâmetros

*nID*<br/>
Um id de menu.

*rMessage*<br/>
Uma referência a um objeto [CString](../../atl-mfc-shared/reference/cstringt-class.md) através do qual uma seqüência será devolvida.

### <a name="remarks"></a>Comentários

Isso pode ser usado para obter uma mensagem para exibição em uma barra de status enquanto o item do menu é destacado. A implementação padrão tenta carregar um recurso de string identificado por *nID*.

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>COleControl::GetNotSupported

Impede o acesso ao valor de propriedade de um controle pelo usuário.

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>Comentários

Chame esta função no lugar da função Get de qualquer propriedade onde a recuperação da propriedade pelo usuário do controle não seja suportada. Um exemplo seria uma propriedade que é apenas escrever.

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>COleControl::GetReadyState

Retorna o estado de prontidão do controle.

```
long GetReadyState();
```

### <a name="return-value"></a>Valor retornado

O estado de prontidão do controle, um dos seguintes valores:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialização padrão|
|READYSTATE_LOADING|Control está atualmente carregando suas propriedades|
|READYSTATE_LOADED|O controle foi inicializado|
|READYSTATE_INTERACTIVE|O controle tem dados suficientes para ser interativo, mas nem todos os dados assíncronos ainda estão carregados|
|Readystate_complete|Control tem todos os seus dados|

### <a name="remarks"></a>Comentários

A maioria dos controles simples nunca precisa diferenciar entre LOADED e INTERACTIVE. No entanto, controles que suportam propriedades de caminho de dados podem não estar prontos para serem interativos até que pelo menos alguns dados sejam recebidos de forma assíncrona. Um controle deve tentar se tornar interativo o mais rápido possível.

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>COleControl::GetRectInContainer

Obtém as coordenadas do retângulo do controle em relação ao recipiente, expressas em unidades de dispositivos.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*Lprect*<br/>
Um ponteiro para a estrutura retângulo na qual as coordenadas do controle serão copiadas.

### <a name="return-value"></a>Valor retornado

Não zero se o controle estiver ativo no local; caso contrário, 0.

### <a name="remarks"></a>Comentários

O retângulo só é válido se o controle estiver ativo no local.

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics

Mede as métricas de texto para a propriedade Font do controle, que pode ser selecionada com a função [SelectStockFont.](#selectstockfont)

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parâmetros

*Lptm*<br/>
Um ponteiro para uma estrutura [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

### <a name="remarks"></a>Comentários

A `GetStockTextMetrics` função inicializará a `TEXTMETRIC` estrutura apontada pelo *LPTM* com informações métricas válidas se for bem sucedida, ou preencherá a estrutura com zeros se não for bem sucedida. Use esta função em vez de [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) ao pintar seu controle porque os controles, como qualquer objeto OLE incorporado, podem ser necessários para se transformar em um metaarquivo.

A `TEXTMETRIC` estrutura da fonte padrão é `SelectStockFont` atualizada quando a função é chamada. Você deve chamar esta função somente depois de selecionar a fonte de estoque para garantir que as informações fornecidas sejam válidas.

## <a name="colecontrolgettext"></a><a name="gettext"></a>COleControl::GetText

Implementa a função Obter da propriedade Texto ou Legenda de estoque.

```
BSTR GetText();
```

### <a name="return-value"></a>Valor retornado

O valor atual da seqüência de texto de controle ou uma seqüência de comprimento zero se nenhuma seqüência estiver presente.

> [!NOTE]
> Para obter mais informações sobre o tipo de dados BSTR, consulte [Tipos de dados](../../mfc/reference/data-types-mfc.md) na seção Macros e Globals.

### <a name="remarks"></a>Comentários

Observe que o chamador `SysFreeString` desta função deve ligar para a seqüência retornada para liberar o recurso. Dentro da implementação do `InternalGetText` controle, use para acessar a propriedade texto ou legenda de estoque do controle.

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>COleControl::GetWindowlessDropTarget

Anular `GetWindowlessDropTarget` quando você quiser que um controle sem janelas seja o alvo de uma operação de arrastar e soltar OLE.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Valor retornado

Ponteiro para a `IDropTarget` interface do objeto. Como ele não tem uma janela, um `IDropTarget` objeto sem janelas não pode registrar uma interface. No entanto, para participar do arrasto e queda, um `GetWindowlessDropTarget`objeto sem janelas ainda pode implementar a interface e devolvê-la em .

### <a name="remarks"></a>Comentários

Normalmente, isso exigiria que a janela do controle fosse registrada como um alvo de queda. Mas como o controle não tem janela própria, o contêiner usará sua própria janela como alvo de queda. O controle simplesmente precisa fornecer `IDropTarget` uma implementação da interface para a qual o contêiner pode delegar chamadas no momento apropriado. Por exemplo:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>COleControl::InitializeIIDs

Informa a classe base dos IIDs que o controle usará.

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parâmetros

*piidPrimary*<br/>
Ponteiro para o ID de interface da interface de despacho principal do controle.

*piidEventos*<br/>
Ponteiro para o ID de interface da interface de evento do controle.

### <a name="remarks"></a>Comentários

Chame esta função no construtor do controle para informar a classe base das IDs de interface que seu controle estará usando.

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>COleControl::InternalGetFont

Acessa a propriedade font de estoque do seu controle

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Valor retornado

Uma referência a um objeto [CFontHolder](../../mfc/reference/cfontholder-class.md) que contém o objeto Font stock.

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>COleControl::InternalGetText

Acessa a propriedade Texto ou Legenda de estoque do seu controle.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Valor retornado

Uma referência à seqüência de texto de controle.

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>COleControl::InternalSetReadyState

Define o estado de prontidão do controle.

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parâmetros

*iNewReadyState*<br/>
O estado de prontidão a definir para o controle, um dos seguintes valores:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialização padrão|
|READYSTATE_LOADING|Control está atualmente carregando suas propriedades|
|READYSTATE_LOADED|O controle foi inicializado|
|READYSTATE_INTERACTIVE|O controle tem dados suficientes para ser interativo, mas nem todos os dados assíncronos ainda estão carregados|
|Readystate_complete|Control tem todos os seus dados|

### <a name="remarks"></a>Comentários

A maioria dos controles simples nunca precisa diferenciar entre LOADED e INTERACTIVE. No entanto, controles que suportam propriedades de caminho de dados podem não estar prontos para serem interativos até que pelo menos alguns dados sejam recebidos de forma assíncrona. Um controle deve tentar se tornar interativo o mais rápido possível.

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>COleControl::InvalidaControl

Força o controle a se redesenhar.

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parâmetros

*Lprect*<br/>
Um ponteiro para a região do controle a ser invalidado.

*Berase*<br/>
Especifica se o plano de fundo dentro da região de atualização deve ser apagado quando a região de atualização for processada.

### <a name="remarks"></a>Comentários

Se *o LPRect* tiver um valor NULL, todo o controle será redesenhado. Se *o lpRect* não for NULL, isso indica a parte do retângulo do controle que deve ser invalidada. Nos casos em que o controle não tem janela ou não está ativo no momento, o retângulo é ignorado e uma chamada é feita para a função de membro [IAdviseSink::OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) do site do cliente. Use esta função `CWnd::InvalidateRect` `InvalidateRect`em vez de ou .

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>COleControl::InvalidRgn

Invalida a área de cliente da janela do contêiner dentro da determinada região.

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parâmetros

*Prgn*<br/>
Um ponteiro para um objeto [CRgn](../../mfc/reference/crgn-class.md) que identifica a região de exibição do objeto OLE para invalidar, nas coordenadas do cliente da janela de contenção. Se este parâmetro for NULO, a extensão é o objeto inteiro.

*Berase*<br/>
Especifica se o plano de fundo dentro da região invalidada deve ser apagado. Se VERDADEIRO, o fundo é apagado. Se FALSO, o fundo permanece inalterado.

### <a name="remarks"></a>Comentários

Isso pode ser usado para redesenhar controles sem janelas dentro do recipiente. A região invalidada, juntamente com todas as outras áreas da região de atualização, está marcada para pintura quando a próxima [mensagem WM_PAINT](/windows/win32/gdi/wm-paint) é enviada.

Se *bErase* é TRUE para qualquer parte da região de atualização, o fundo em toda a região, não apenas na parte dada, é apagado.

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>COleControl::IsConvertingVBX

Permite o carregamento especializado de um controle OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Valor retornado

Não zero se o controle estiver sendo convertido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Ao converter um formulário que usa controles VBX para um que use controles OLE, pode ser necessário um código de carregamento especial para os controles OLE. Por exemplo, se você estiver carregando uma instância do seu controle OLE, você pode ter uma chamada para [PX_Font](persistence-of-ole-controls.md#px_font) em seu `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

No entanto, os controles VBX não tinham um objeto Font; cada propriedade da fonte foi salva individualmente. Neste caso, você `IsConvertingVBX` usaria para distinguir entre esses dois casos:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Outro caso seria se o controle VBX salvasse dados binários proprietários (em seu manipulador de mensagens VBM_SAVEPROPERTY), e seu controle OLE salvasse seus dados binários em um formato diferente. Se você quiser que o controle OLE seja retrocompatível com o controle VBX, `IsConvertingVBX` você pode ler os formatos antigos e novos usando a função, distinguindo se o controle VBX ou o controle OLE estavam sendo carregados.

Na função do `DoPropExchange` seu controle, você pode verificar se esta condição e, se verdadeira, executar código de carga específico para esta conversão (como os exemplos anteriores). Se o controle não estiver sendo convertido, você pode executar o código de carga normal. Essa habilidade só é aplicável aos controles que estão sendo convertidos a partir de contrapartes VBX.

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed

Permite a invocação do método de automação.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Valor retornado

Não zero se o controle tiver sido inicializado; caso contrário, 0.

### <a name="remarks"></a>Comentários

A aplicação das `IDispatch::Invoke` chamadas `IsInvokeAllowed` do quadro para determinar `dispid`se uma determinada função (identificada por ) pode ser invocada. O comportamento padrão para um controle oLE é permitir que os métodos de automação sejam invocados somente se o controle tiver sido inicializado; no `IsInvokeAllowed` entanto, é uma função virtual e pode ser substituída se necessário (por exemplo, quando o controle está sendo usado como um servidor de automação).

## <a name="colecontrolismodified"></a><a name="ismodified"></a>COleControl::IsModified

Determina se o estado do controle foi modificado.

```
BOOL IsModified();
```

### <a name="return-value"></a>Valor retornado

Não zero se o estado do controle foi modificado desde a última salva; caso contrário, 0.

### <a name="remarks"></a>Comentários

O estado de um controle é modificado quando uma propriedade muda de valor.

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>COleControl::IsOptimizedDraw

Determina se o contêiner suporta desenho otimizado para a operação de desenho atual.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Valor retornado

TRUE se o contêiner suportar desenho otimizado para a operação de desenho atual; caso contrário, FALSO.

### <a name="remarks"></a>Comentários

Se o desenho otimizado for suportado, então o controle não precisa selecionar objetos antigos (canetas, pincéis, fontes, etc.) no contexto do dispositivo quando o desenho estiver concluído.

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl

Chamado pela estrutura para determinar se o controle subclasses um controle do Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Valor retornado

Não zero se o controle for subclassificado; caso contrário, 0.

### <a name="remarks"></a>Comentários

Você deve substituir esta função e retornar TRUE se o controle OLE subclasses um controle do Windows.

## <a name="colecontrolload"></a><a name="load"></a>COleControl::Carga

Redefine quaisquer dados anteriores carregados de forma assíncrona e inicia um novo carregamento da propriedade assíncrona do controle.

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parâmetros

*strNewPath*<br/>
Um ponteiro para uma seqüência contendo o caminho que faz referência à localização absoluta da propriedade de controle assíncrono.

*Prop*<br/>
Um objeto [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) que implementa uma propriedade de controle assíncrono.

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>COleControl::LockInPlaceActive

Impede que o recipiente desacione seu controle.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parâmetros

*Bloco*<br/>
VERDADE se o estado ativo do controle no local for bloqueado; FALSO se for para ser desbloqueado.

### <a name="return-value"></a>Valor retornado

Não zero se o bloqueio foi bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Observe que cada bloqueio do controle deve ser emparelhado com um desbloqueio do controle quando concluído. Você só deve bloquear seu controle por curtos períodos, como durante a disparo de um evento.

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange

Chamado pela estrutura quando uma propriedade ambiente do contêiner mudou de valor.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parâmetros

*Dispid*<br/>
O ID de despacho da propriedade ambiente que mudou, ou DISPID_UNKNOWN se várias propriedades foram alteradas.

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>COleControl::OnAppearanceChanged

Chamado pelo framework quando o valor da propriedade appearance de ações mudou.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Comentários

Anular esta função se você quiser notificação após essa alteração de propriedade. As chamadas `InvalidateControl`de implementação padrão .

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>COleControl::OnBackColorChanged

Chamado pelo framework quando o valor de propriedade BackColor de estoque foi alterado.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Comentários

Anular esta função se você quiser notificação após essa alteração de propriedade. As chamadas `InvalidateControl`de implementação padrão .

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>COleControl::OnBorderStyleAlterado

Chamado pelo framework quando o valor da propriedade BorderStyle de estoque foi alterado.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Comentários

As chamadas `InvalidateControl`de implementação padrão .

Anular esta função se você quiser notificação após essa alteração de propriedade.

## <a name="colecontrolonclick"></a><a name="onclick"></a>COleControl::OnClick

Chamado pela estrutura quando um botão do mouse foi clicado ou o método de estoque DoClick foi invocado.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parâmetros

*Ibutton*<br/>
Índice de um botão do mouse. Pode ter um dos seguintes valores:

- LEFT_BUTTON O botão esquerdo do mouse foi clicado.

- MIDDLE_BUTTON O botão do mouse do meio foi clicado.

- RIGHT_BUTTON O botão direito do mouse foi clicado.

### <a name="remarks"></a>Comentários

As chamadas `COleControl::FireClick`de implementação padrão .

Substituir esta função de membro para modificar ou estender o manuseio padrão.

## <a name="colecontrolonclose"></a><a name="onclose"></a>COleControl::OnClose

Chamado pela estrutura quando o contêiner chamou `IOleControl::Close` a função do controle.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parâmetros

*dwSaveOption*<br/>
Sinalizador que indica se o objeto deve ser salvo antes de carregar. Os valores válidos são:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Comentários

Por padrão, `OnClose` salva o objeto de controle se ele tiver sido modificado e *dwSaveOption* está OLECLOSE_SAVEIFDIRTY ou OLECLOSE_PROMPTSAVE.

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>COleControl::OnDoVerb

Chamado pela estrutura quando o `IOleObject::DoVerb` contêiner chama a função de membro.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*Iverb*<br/>
O índice do verbo de controle a ser invocado.

*Lpmsg*<br/>
Um ponteiro para a mensagem do Windows que fez com que o verbo fosse invocado.

*Hwndparent*<br/>
A alça da janela dos pais do controle. Se a execução do verbo criar uma janela (ou janelas), *hWndParent* deve ser usado como pai.

*Lprect*<br/>
Um ponteiro para uma estrutura RECT na qual as coordenadas do controle, em relação ao recipiente, serão copiados.

### <a name="return-value"></a>Valor retornado

Não zero se a chamada foi bem sucedida; caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão usa as entradas de mapa de mensagem ON_OLEVERB e ON_STDOLEVERB para determinar a função adequada para invocar.

Anular esta função para alterar o manuseio padrão do verbo.

## <a name="colecontrolondraw"></a><a name="ondraw"></a>COleControl::OnDraw

Chamado pela estrutura para desenhar o controle OLE no retângulo delimitador especificado usando o contexto do dispositivo especificado.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
O contexto do dispositivo em que ocorre o desenho.

*Rcbounds*<br/>
A área retangular do controle, incluindo a fronteira.

*rcInválido*<br/>
A área retangular do controle que é inválida.

### <a name="remarks"></a>Comentários

`OnDraw`é tipicamente chamado para exibição de tela, passando um contexto de dispositivo de tela como *pDC*. O parâmetro *rcBounds* identifica o retângulo no contexto do dispositivo de destino (em relação ao modo de mapeamento atual). O parâmetro *rcInvalid* é o retângulo real que é inválido. Em alguns casos, esta será uma área menor do que *rcBounds*.

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>COleControl::OnDrawMetafile

Chamado pela estrutura para desenhar o controle OLE no retângulo delimitador especificado usando o contexto do dispositivo de metaarquivo especificado.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
O contexto do dispositivo em que ocorre o desenho.

*Rcbounds*<br/>
A área retangular do controle, incluindo a fronteira.

### <a name="remarks"></a>Comentários

A implementação padrão chama a função [OnDraw.](#ondraw)

## <a name="colecontrolonedit"></a><a name="onedit"></a>COleControl::OnEdit

Faz com que o controle seja ativado.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*Lpmsg*<br/>
Um ponteiro para a mensagem do Windows que invocou o verbo.

*Hwndparent*<br/>
Uma alça para a janela dos pais do controle.

*Lprect*<br/>
Um ponteiro para o retângulo usado pelo controle no recipiente.

### <a name="return-value"></a>Valor retornado

Não zero se a chamada for bem sucedida; caso contrário, 0.

### <a name="remarks"></a>Comentários

Isso tem o mesmo efeito de invocar o verbo OLEIVERB_UIACTIVATE do controle.

Esta função é normalmente usada como função de manipulador para uma entrada de mapa de mensagens ON_OLEVERB. Isso torna um verbo "Editar" disponível no menu "Objeto" do controle. Por exemplo:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>COleControl::AtivadoAlterado

Chamado pelo framework quando o valor da propriedade habilitado foi alterado.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Comentários

Anular esta função se você quiser notificação após essa alteração de propriedade. A implementação padrão chama [InvalidControl](#invalidatecontrol).

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>COleControl::OnEnumVerbs

Chamado pela estrutura quando o `IOleObject::EnumVerbs` contêiner chama a função de membro.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parâmetros

*ppenumOleVerb*<br/>
Um ponteiro `IEnumOLEVERB` para o objeto que enumera os verbos do controle.

### <a name="return-value"></a>Valor retornado

Não zero se os verbos estiverem disponíveis; caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão enumera as entradas ON_OLEVERB no mapa de mensagens.

Anular essa função para alterar a maneira padrão de enumerar verbos.

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>COleControl::OnEventAdvise

Chamado pela estrutura quando um manipulador de eventos está conectado ou desconectado de um controle OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parâmetros

*bAconselhar*<br/>
TRUE indica que um manipulador de eventos foi conectado ao controle. FALSE indica que um manipulador de eventos foi desconectado do controle.

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>COleControl::OnFontChanged

Chamado pelo framework quando o valor da propriedade font de estoque foi alterado.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Comentários

As chamadas `COleControl::InvalidateControl`de implementação padrão . Se o controle estiver subclassizando um controle do Windows, a implementação padrão também envia uma mensagem WM_SETFONT para a janela do controle.

Anular esta função se você quiser notificação após essa alteração de propriedade.

### <a name="example"></a>Exemplo

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>COleControl::OnForeColorChanged

Chamado pelo framework quando o valor de propriedade foreColor do estoque mudou.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Comentários

As chamadas `InvalidateControl`de implementação padrão .

Anular esta função se você quiser notificação após essa alteração de propriedade.

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>COleControl::OnFreezeEvents

Chamado pela estrutura após `IOleControl::FreezeEvents`as chamadas do contêiner .

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parâmetros

*bFreeze*<br/>
VERDADE se o manuseio de eventos do controle estiver congelado; caso contrário, FALSO.

### <a name="remarks"></a>Comentários

A implementação padrão não faz nada.

Anular esta função se você quiser comportamento adicional quando o manuseio do evento estiver congelado ou descongelado.

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>COleControl::OnGetColorSet

Chamado pela estrutura quando o `IViewObject::GetColorSet` contêiner chama a função de membro.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parâmetros

*Ptd*<br/>
Aponta para o dispositivo de destino para o qual a imagem deve ser renderizada. Se esse valor for NULO, a imagem deve ser renderizada para um dispositivo de destino padrão, geralmente um dispositivo de exibição.

*Hictargetdev*<br/>
Especifica o contexto de informações no dispositivo de destino indicado pelo *PTD*. Este parâmetro pode ser um contexto de dispositivo, mas não é necessariamente um. Se *ptd* for NULL, *hicTargetDev* também deve ser NULO.

*ppColorSet*<br/>
Um ponteiro para o local em que o conjunto de cores que seria usado deve ser copiado. Se a função não retornar o conjunto de cores, NULL será devolvido.

### <a name="return-value"></a>Valor retornado

Não zero se um conjunto de cores válido for retornado; caso contrário, 0.

### <a name="remarks"></a>Comentários

O contêiner chama esta função para obter todas as cores necessárias para desenhar o controle OLE. O recipiente pode usar os conjuntos de cores obtidos em conjunto com as cores que precisa para definir a paleta de cores geral. A implementação padrão retorna FALSE.

Anular esta função para fazer qualquer processamento especial desta solicitação.

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo

Chamado pela estrutura quando o contêiner do controle solicitou informações sobre o controle.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parâmetros

*pControlInfo*<br/>
Ponteiro para uma estrutura [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) a ser preenchida.

### <a name="remarks"></a>Comentários

Esta informação consiste principalmente em uma descrição das chaves mnemônicas do controle. A implementação padrão preenche *o pControlInfo* com informações padrão.

Anular esta função se o seu controle precisar processar chaves mnemônicas.

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString

Chamado pelo framework para obter uma string que representa o valor atual da propriedade identificada por *despid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parâmetros

*Dispid*<br/>
A impropriedade de uma propriedade do controle.

*strValue*<br/>
Uma referência a um objeto [CString](../../atl-mfc-shared/reference/cstringt-class.md) através do qual uma seqüência será devolvida.

### <a name="return-value"></a>Valor retornado

Não zero se uma seqüência foi devolvida em *strValue;* caso contrário 0.

### <a name="remarks"></a>Comentários

Anular essa função se o seu controle tiver uma propriedade cujo valor não pode ser convertido diretamente em uma string e você deseja que o valor da propriedade seja exibido em um navegador de propriedade fornecido por contêiner.

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>COleControl::OnGetInPlaceMenu

Chamado pela estrutura quando o controle é ativado para obter o menu a ser mesclado no menu existente do contêiner.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Valor retornado

A alça do menu do controle, ou NULL se o controle não tiver nenhum. A implementação padrão retorna NULL.

### <a name="remarks"></a>Comentários

Para obter mais informações sobre a fusão de recursos OLE, consulte o artigo [Menus and Resources (OLE)](../../mfc/menus-and-resources-ole.md).

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent

Chamado pelo quadro em resposta ao `IViewObjectEx::GetNaturalExtent` pedido de um contêiner.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parâmetros

*Dwaspect*<br/>
Especifica como o objeto deve ser representado. As representações incluem conteúdo, um ícone, uma miniatura ou um documento impresso. Os valores válidos são retirados da enumeração [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*Lindex*<br/>
A parte do objeto que é de interesse. Atualmente, apenas -1 é válido.

*Ptd*<br/>
Aponta para a estrutura [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) que define o dispositivo de destino para o qual o tamanho do objeto deve ser devolvido.

*Hictargetdev*<br/>
Especifica o contexto de informações para o dispositivo de destino indicado pelo parâmetro *ptd* a partir do qual o objeto pode extrair métricas do dispositivo e testar as capacidades do dispositivo. Se *ptd* for NULL, o objeto deve ignorar o valor no parâmetro *hicTargetDev.*

*pExtentInfo*<br/>
Aponta para `DVEXTENTINFO` a estrutura que especifica dados de dimensionamento. A `DVEXTENTINFO` estrutura é:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

O membro `dwExtentMode` da estrutura pode pegar um dos dois valores:

- DVEXTENT_CONTENT de ver o tamanho do controle para se encaixar exatamente no conteúdo (snap-to-size)

- DVEXTENT_INTEGRAL Ao redimensionar, passe o tamanho proposto para controlar

*Psizel*<br/>
Aponta para o dimensionamento de dados retornados pelo controle. Os dados de dimensionamento retornados são definidos como -1 para qualquer dimensão que não tenha sido ajustada.

### <a name="return-value"></a>Valor retornado

Não zero se ele retornar ou ajustar o tamanho com sucesso; caso contrário, 0.

### <a name="remarks"></a>Comentários

Substituir esta função para retornar o tamanho de exibição do objeto `DVEXTENTINFO` mais próximo do modo de tamanho e extensão proposto na estrutura. A implementação padrão retorna FALSE e não faz nenhum ajuste no tamanho.

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings

Chamado pelo framework para obter um conjunto de strings predefinidas representando os valores possíveis para uma propriedade.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parâmetros

*Dispid*<br/>
A impropriedade de uma propriedade do controle.

*Pstringarray*<br/>
Uma matriz de strings a ser preenchida com valores de retorno.

*pCookieArray*<br/>
Uma matriz DWORD a ser preenchida com valores de retorno.

### <a name="return-value"></a>Valor retornado

Não zero se os elementos foram adicionados ao *pStringArray* e *pCookieArray*.

### <a name="remarks"></a>Comentários

Anular essa função se o seu controle tiver uma propriedade com um conjunto de valores possíveis que podem ser representados por strings. Para cada elemento adicionado ao *pStringArray,* você deve adicionar um elemento "cookie" correspondente ao *pCookieArray.* Esses valores de "cookie" podem ser `COleControl::OnGetPredefinedValue` posteriormente passados pela estrutura para a função.

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue

Chamado pelo quadro para obter o valor correspondente a uma das strings predefinidas anteriormente devolvidas por uma substituição de `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parâmetros

*Dispid*<br/>
A impropriedade de uma propriedade do controle.

*Dwcookie*<br/>
Um valor de cookie anteriormente devolvido `COleControl::OnGetPredefinedStrings`por uma substituição de .

*lpvarOut*<br/>
Ponteiro para `VARIANT` uma estrutura através da qual um valor de propriedade será devolvido.

### <a name="return-value"></a>Valor retornado

Não zero se um valor tiver sido devolvido em *lpvarOut*; caso contrário, 0.

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>COleControl::OnGetViewExtent

Chamado pela estrutura em resposta à solicitação [IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) de um contêiner.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parâmetros

*dwDrawAspect*<br/>
DWORD descrevendo qual forma, ou aspecto, de um objeto deve ser exibido. Os valores válidos são retirados da enumeração [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*Lindex*<br/>
A parte do objeto que é de interesse. Atualmente, apenas -1 é válido.

*Ptd*<br/>
Aponta para a estrutura [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) que define o dispositivo de destino para o qual o tamanho do objeto deve ser devolvido.

*lpsizel*<br/>
Aponta para o local onde o tamanho do objeto é devolvido.

### <a name="return-value"></a>Valor retornado

Não zero se as informações de extensão forem devolvidas com sucesso; caso contrário, 0.

### <a name="remarks"></a>Comentários

Anular esta função se o seu controle usar desenho de duas passos, e suas peças opacas e transparentes têm dimensões diferentes.

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>COleControl::OnGetViewRect

Chamado pelo quadro em resposta ao `IViewObjectEx::GetRect` pedido de um contêiner.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parâmetros

*Dwaspect*<br/>
DWORD descrevendo qual forma, ou aspecto, de um objeto deve ser exibido. Os valores válidos são retirados da enumeração [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2:

- DVASPECT_CONTENT retângulo delimitador de todo o objeto. Canto superior esquerdo na origem e tamanho do objeto `GetViewExtent`iguais à medida devolvida por *.*

- DVASPECT_OPAQUE Objetos com uma região opaca retangular retornam esse retângulo. Outros falham.

- DVASPECT_TRANSPARENT Retângulo cobrindo todas as peças transparentes ou irregulares.

*pRect*<br/>
Aponta para a estrutura [RECTL](/windows/win32/api/windef/ns-windef-rectl) especificando o retângulo no qual o objeto deve ser desenhado. Este parâmetro controla o posicionamento e o alongamento do objeto.

### <a name="return-value"></a>Valor retornado

Não zero se o retângulo dimensionado para o objeto for devolvido com sucesso; caso contrário, 0.

### <a name="remarks"></a>Comentários

O tamanho do objeto é `OnGetViewRect` convertido por um retângulo a partir de uma posição específica (o padrão é o canto superior esquerdo do display). Anular esta função se o seu controle usar desenho de duas passos, e suas peças opacas e transparentes têm dimensões diferentes.

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>COleControl::OnGetViewStatus

Chamado pelo quadro em resposta ao `IViewObjectEx::GetViewStatus` pedido de um contêiner.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Valor retornado

Um dos valores da enumeração VIEWSTATUS se for bem sucedido; caso contrário, 0. Os valores possíveis são qualquer combinação do seguinte:

|||
|-|-|
|Viewstatus_opaque|O objeto é completamente opaco. Se esta broca não estiver definida, o objeto contém partes transparentes. Este bit se aplica apenas a aspectos relacionados ao conteúdo e não a DVASPECT_ICON ou DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|O objeto tem um fundo sólido (consistindo em uma cor sólida, não em um padrão de pincel). Este bit só é significativo se VIEWSTATUS_OPAQUE for definido e se aplicar apenas a aspectos relacionados ao conteúdo e não a DVASPECT_ICON ou DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Objeto suporta DVASPECT_OPAQUE. Todos os métodos IViewObjectEx que tomam um aspecto de desenho como parâmetro podem ser chamados com este aspecto.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Objeto suporta DVASPECT_TRANSPARENT. Todos `IViewObjectEx` os métodos que tomam um aspecto de desenho como parâmetro podem ser chamados com este aspecto.|

### <a name="remarks"></a>Comentários

Anular esta função se o seu controle usar desenho de duas passos. A implementação padrão retorna VIEWSTATUS_OPAQUE.

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>COleControl::OnHideToolBars

Chamado pela estrutura quando o controle é desativado.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Comentários

A implementação deve ocultar `OnShowToolbars`todas as barras de ferramentas exibidas por .

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove

Chamado pelo contêiner para o objeto inativo sob o ponteiro do mouse no recebimento de uma mensagem WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parâmetros

*lprcBounds*<br/>
O objeto delimita ndo retângulo, nas coordenadas do cliente da janela de contenção. Informa ao objeto sua posição e tamanho exatos na tela quando a mensagem WM_MOUSEMOVE foi recebida.

*x*<br/>
A coordenada x da localização do mouse nas coordenadas do cliente da janela de contenção.

*Y*<br/>
A coordenada y da localização do mouse nas coordenadas do cliente da janela de contenção.

*Dwkeystate*<br/>
Identifica o estado atual das teclas modificadoras do teclado no teclado. Os valores válidos podem ser uma combinação de qualquer uma das bandeiras MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON e MK_RBUTTON.

### <a name="remarks"></a>Comentários

Observe que as coordenadas do cliente de janela (pixels) são usadas para passar a posição do cursor do mouse. Isso é possível passando também pelo retângulo delimitador do objeto no mesmo sistema de coordenadas.

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor

Chamado pelo contêiner para o objeto inativo sob o ponteiro do mouse no recebimento de uma mensagem WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parâmetros

*lprcBounds*<br/>
O objeto delimita ndo retângulo, nas coordenadas do cliente da janela de contenção. Informa ao objeto sua posição e tamanho exatos na tela quando a mensagem WM_SETCURSOR foi recebida.

*x*<br/>
A coordenada x da localização do mouse nas coordenadas do cliente da janela de contenção.

*Y*<br/>
A coordenada y da localização do mouse nas coordenadas do cliente da janela de contenção.

*dwMouseMsg*<br/>
O identificador da mensagem do mouse para a qual ocorreu um WM_SETCURSOR.

*bSetAlways*<br/>
Especifica se o objeto deve ou não definir o cursor. Se TRUE, o objeto deve definir o cursor; se FALSO, o cursor não é obrigado a definir o cursor, e deve retornar S_FALSE nesse caso.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Observe que as coordenadas do cliente de janela (pixels) são usadas para passar a posição do cursor do mouse. Isso é possível passando também pelo retângulo delimitador do objeto no mesmo sistema de coordenadas.

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>COleControl::OnKeyDownEvent

Chamado pelo framework após um evento keydown de ações ter sido processado.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parâmetros

*Nchar*<br/>
O valor de código de chave virtual da chave pressionada. Para obter uma lista de códigos-chave virtuais padrão, consulte Winuser.h

*nShiftState*<br/>
Contém uma combinação das seguintes bandeiras:

- SHIFT_MASK A tecla SHIFT foi pressionada durante a ação.

- CTRL_MASK a tecla CTRL foi pressionada durante a ação.

- ALT_MASK A tecla ALT foi pressionada durante a ação.

### <a name="remarks"></a>Comentários

Anular esta função se o seu controle precisar de acesso às informações-chave após o evento ter sido acionado.

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>COleControl::OnKeyPressEvent

Chamado pelo framework após o evento keypress de ações ter sido demitido.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parâmetros

*Nchar*<br/>
Contém o valor de código de chave virtual da tecla pressionada. Para obter uma lista de códigos-chave virtuais padrão, consulte Winuser.h

### <a name="remarks"></a>Comentários

Observe que o valor *nChar* pode ter sido modificado pelo recipiente.

Anular esta função se você quiser notificação após a ocorrência deste evento.

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>COleControl::OnKeyUpEvent

Chamado pelo framework após um evento keydown de ações ter sido processado.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parâmetros

*Nchar*<br/>
O valor de código de chave virtual da chave pressionada. Para obter uma lista de códigos-chave virtuais padrão, consulte Winuser.h

*nShiftState*<br/>
Contém uma combinação das seguintes bandeiras:

- SHIFT_MASK A tecla SHIFT foi pressionada durante a ação.

- CTRL_MASK a tecla CTRL foi pressionada durante a ação.

- ALT_MASK A tecla ALT foi pressionada durante a ação.

### <a name="remarks"></a>Comentários

Anular esta função se o seu controle precisar de acesso às informações-chave após o evento ter sido acionado.

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>COleControl:OnMapPropertyToPage

Chamado pela framework para obter o ID de classe de uma página de propriedade que implementa a edição da propriedade especificada.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parâmetros

*Dispid*<br/>
A impropriedade de uma propriedade do controle.

*lpclídeos*<br/>
Ponteiro para `CLSID` uma estrutura através da qual uma iD de classe será devolvida.

*pbPageOptional*<br/>
Retorna um indicador de se o uso da página de propriedade especificada é opcional.

### <a name="return-value"></a>Valor retornado

Não zero se uma id de classe tiver sido devolvida em *lpclsid*; caso contrário, 0.

### <a name="remarks"></a>Comentários

Anular essa função para fornecer uma maneira de invocar as páginas de propriedade do seu controle a partir do navegador de propriedade do contêiner.

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>COleControl::OnMnemônico

Chamado pela estrutura quando o recipiente detectou que uma chave mnemônica do controle OLE foi pressionada.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parâmetros

*pMsg*<br/>
Ponteiro para a mensagem do Windows gerada por uma tecla mnemônica.

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>COleControl::OnProperties

Chamado pela estrutura quando o verbo de propriedades do controle foi invocado pelo recipiente.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*Lpmsg*<br/>
Um ponteiro para a mensagem do Windows que invocou o verbo.

*Hwndparent*<br/>
Uma alça para a janela dos pais do controle.

*Lprect*<br/>
Um ponteiro para o retângulo usado pelo controle no recipiente.

### <a name="return-value"></a>Valor retornado

Não zero se a chamada for bem sucedida; caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão exibe uma caixa de diálogo de propriedade modal.

Você também pode usar essa função para causar a exibição das páginas de propriedade do seu controle. Faça uma chamada `OnProperties` para a função, passando a alça do pai do seu controle no parâmetro *hWndParent.* Neste caso, os valores dos *parâmetros lpMsg* e *lpRect* são ignorados.

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint

Chamado pelo quadro em resposta ao `IViewObjectEx::QueryHitPoint` pedido de um contêiner.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parâmetros

*Dwaspect*<br/>
Especifica como o objeto é representado. Os valores válidos são retirados da enumeração [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*pRectBounds*<br/>
Ponteiro para `RECT` uma estrutura especificando o retângulo delimitador da área do cliente de controle OLE.

*ptlLoc*<br/>
Ponteiro para `POINT` a estrutura especificando o ponto a ser verificado para um hit. O ponto é especificado nas coordenadas da área do cliente OLE.

*lCloseHint*<br/>
A distância que define "perto" do ponto verificado para um hit.

*Phitresult*<br/>
Ponteiro para o resultado da consulta de acerto. Um dos seguintes valores:

- HITRESULT_OUTSIDE *ptlLoc* está fora do objeto OLE e não está perto.

- HITRESULT_TRANSPARENT *ptlLoc* está dentro dos limites do objeto OLE, mas não perto da imagem. Por exemplo, um ponto no meio de um círculo transparente pode ser HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* está dentro ou fora do objeto OLE, mas perto o suficiente do objeto a ser considerado dentro. Objetos pequenos, finos ou detalhados podem usar esse valor. Mesmo que um ponto esteja fora do retângulo delimitador de um objeto, ele ainda pode estar próximo (isso é necessário para atingir objetos pequenos).

- HITRESULT_HIT *ptlLoc* está dentro da imagem do objeto.

### <a name="return-value"></a>Valor retornado

Não zero se um resultado de acerto for devolvido com sucesso; caso contrário, 0. Um hit é uma sobreposição com a área de exibição de controle OLE.

### <a name="remarks"></a>Comentários

Questiona se o retângulo de exibição de um objeto se sobrepõe ao ponto dado (atinge o ponto). `QueryHitPoint`pode ser substituído para testar hits para objetos não retangulares.

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>COleControl::OnQueryHitRect

Chamado pelo quadro em resposta ao `IViewObjectEx::QueryHitRect` pedido de um contêiner.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parâmetros

*Dwaspect*<br/>
Especifica como o objeto deve ser representado. Os valores válidos são retirados da enumeração [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*pRectBounds*<br/>
Ponteiro para `RECT` uma estrutura especificando o retângulo delimitador da área do cliente de controle OLE.

*prcLoc*<br/>
Ponteiro para `RECT` a estrutura especificando o retângulo a ser verificado para um hit (sobreposição com o retângulo do objeto), em relação ao canto superior esquerdo do objeto.

*lCloseHint*<br/>
Não usado.

*Phitresult*<br/>
Ponteiro para o resultado da consulta de acerto. Um dos seguintes valores:

- HITRESULT_OUTSIDE nenhum ponto no retângulo é atingido pelo objeto OLE.

- HITRESULT_HIT pelo menos um ponto no retângulo seria um golpe no objeto.

### <a name="return-value"></a>Valor retornado

Não zero se um resultado de acerto for devolvido com sucesso; caso contrário, 0.

### <a name="remarks"></a>Comentários

Questiona se o retângulo de exibição de um objeto se sobrepõe a qualquer ponto no retângulo dado (atinge o retângulo). `QueryHitRect`pode ser substituído para testar hits para objetos não retangulares.

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>COleControl::OnRenderData

Chamado pela estrutura para recuperar dados no formato especificado.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parâmetros

*Lpformatetc*<br/>
Aponta para a estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) especificando o formato no qual as informações são solicitadas.

*Lpstgmedium*<br/>
Aponta para uma estrutura [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) na qual os dados devem ser devolvidos.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

O formato especificado é um anteriormente colocado no objeto de controle usando as funções de membro [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) ou [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) para renderização atrasada. A implementação padrão `OnRenderFileData` desta `OnRenderGlobalData`função chama ou, respectivamente, se o meio de armazenamento fornecido for um arquivo ou memória. Se o formato solicitado for CF_METAFILEPICT ou o formato de conjunto de propriedades persistente, a implementação padrão torna os dados apropriados e retorna não zero. Caso contrário, ele retorna 0 e não faz nada.

Se *o >lpStgMedium for* TYMED_NULL, o STGMEDIUM deve ser alocado e preenchido conforme especificado pelo *lpFormatEtc->tymed*. Se não TYMED_NULL, o STGMEDIUM deve ser preenchido no lugar com os dados.

Anular esta função para fornecer seus dados no formato e meio solicitados. Dependendo dos seus dados, você pode querer substituir uma das outras versões desta função. Se seus dados forem pequenos e `OnRenderGlobalData`fixos em tamanho, anular . Se seus dados estão em um arquivo, ou `OnRenderFileData`são de tamanho variável, sobreposição .

Para obter mais `FORMATETC` informações, consulte as estruturas e `STGMEDIUM` estruturas no SDK do Windows.

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>COleControl::OnRenderFileData

Chamado pela estrutura para recuperar dados no formato especificado quando o meio de armazenamento é um arquivo.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parâmetros

*Lpformatetc*<br/>
Aponta para a estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) especificando o formato no qual as informações são solicitadas.

*Pfile*<br/>
Aponta para um objeto [CFile](../../mfc/reference/cfile-class.md) no qual os dados devem ser renderizados.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

O formato especificado é um anteriormente colocado no objeto de controle usando a função [membro DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) para renderização atrasada. A implementação padrão desta função simplesmente retorna FALSE.

Anular esta função para fornecer seus dados no formato e meio solicitados. Dependendo dos seus dados, você pode querer substituir uma das outras versões desta função. Se você quiser lidar com vários `OnRenderData`meios de armazenamento, anular . Se seus dados estão em um arquivo, ou `OnRenderFileData`são de tamanho variável, sobreposição .

Para obter mais `FORMATETC` informações, consulte a estrutura no SDK do Windows.

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData

Chamado pela estrutura para recuperar dados no formato especificado quando o meio de armazenamento especificado é memória global.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parâmetros

*Lpformatetc*<br/>
Aponta para a estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) especificando o formato no qual as informações são solicitadas.

*Phglobal*<br/>
Aponta para uma alça para a memória global na qual os dados devem ser devolvidos. Se nenhuma memória foi alocada, este parâmetro pode ser NULO.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

O formato especificado é um anteriormente colocado no objeto de controle usando a função [membro DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) para renderização atrasada. A implementação padrão desta função simplesmente retorna FALSE.

Se *phGlobal* for NULL, então um novo HGLOBAL deve ser alocado e devolvido em *phGlobal*. Caso contrário, o HGLOBAL especificado pela *phGlobal* deve ser preenchido com os dados. A quantidade de dados colocados no HGLOBAL não deve exceder o tamanho atual do bloco de memória. Além disso, o bloco não pode ser realocado para um tamanho maior.

Anular esta função para fornecer seus dados no formato e meio solicitados. Dependendo dos seus dados, você pode querer substituir uma das outras versões desta função. Se você quiser lidar com vários `OnRenderData`meios de armazenamento, anular . Se seus dados estão em um arquivo, ou `OnRenderFileData`são de tamanho variável, sobreposição .

Para obter mais `FORMATETC` informações, consulte a estrutura no SDK do Windows.

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>COleControl::OnResetState

Chamado pelo framework quando as propriedades do controle devem ser definidas para seus valores padrão.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Comentários

A implementação padrão chama [DoPropExchange](#dopropexchange), passando um `CPropExchange` objeto que faz com que as propriedades sejam definidas para seus valores padrão.

O autor do controle pode inserir o código de inicialização para o controle OLE neste overridable. Essa função é chamada quando [o IPersistStream::Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) ou [iPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) fails ou [IPersistStreamInit::InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) ou [IPersistStorage::InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) é chamado, sem antes chamar um ou `IPersistStream::Load` `IPersistStorage::Load`.

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>COleControl::OnSetClientSite

Chamado pela estrutura quando o contêiner chamou `IOleControl::SetClientSite` a função do controle.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Comentários

Por padrão, `OnSetClientSite` verifica se as propriedades do caminho de `DoDataPathPropExchange`dados estão carregadas e, se estiverem, chamadas .

Anular esta função para fazer qualquer processamento especial desta notificação. Em particular, as substituições desta função devem chamar a classe base.

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>COleControl::OnSetData

Chamado pela estrutura para substituir os dados do controle pelos dados especificados.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parâmetros

*Lpformatetc*<br/>
Pointer para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) especificando o formato dos dados.

*Lpstgmedium*<br/>
Ponteiro para uma estrutura [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) na qual os dados residem.

*Brelease*<br/>
TRUE se o controle liberar o meio de armazenamento; FALSO se o controle não liberar o meio de armazenamento.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Se os dados estão no formato de conjunto de propriedades persistentes, a implementação padrão modifica o estado do controle em conformidade. Caso contrário, a implementação padrão não faz nada. Se *bRelease* for TRUE, `ReleaseStgMedium` então uma chamada é feita; caso contrário, não.

Substitua esta função para substituir os dados do controle pelos dados especificados.

Para obter mais `FORMATETC` informações, consulte as estruturas e `STGMEDIUM` estruturas no SDK do Windows.

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>COleControl::OnSetExtent

Chamado pelo framework quando a extensão do controle precisa ser alterada, como resultado de uma chamada para [IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parâmetros

*lpSizeL*<br/>
Um ponteiro `SIZEL` para a estrutura que usa inteiros longos para representar a largura e altura do controle, expresso em unidades HIMETRIC.

### <a name="return-value"></a>Valor retornado

Não zero se a mudança de tamanho foi aceita; caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão lida com o redimensionamento da extensão do controle. Se o controle estiver ativo no local, uma `OnPosRectChanged` chamada para o contêiner é feita.

Anular esta função para alterar o redimensionamento padrão do seu controle.

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>COleControl::OnSetObjectRects

Chamado pela estrutura para implementar uma chamada para [IOleInPlaceObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parâmetros

*lpRectPos*<br/>
Um ponteiro `RECT` para uma estrutura indicando a nova posição e tamanho do controle em relação ao recipiente.

*lpRectClip*<br/>
Um ponteiro `RECT` para uma estrutura indicando uma área retangular para a qual o controle deve ser cortado.

### <a name="return-value"></a>Valor retornado

Não zero se o reposicionamento for aceito; caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão lida automaticamente com o reposicionamento e redimensionamento da janela de controle e retorna TRUE.

Anular esta função para alterar o comportamento padrão desta função.

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>COleControl::OnShowToolBars

Chamado pela estrutura quando o controle foi ativado.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Comentários

A implementação padrão não faz nada.

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>COleControl::OnTextChanged

Chamado pelo framework quando o valor de propriedade legenda ou texto de estoque foi alterado.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Comentários

As chamadas `InvalidateControl`de implementação padrão .

Anular esta função se você quiser notificação após essa alteração de propriedade.

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage

Chamado pelo quadro em resposta ao `IOleInPlaceObjectWindowless::OnWindowMessage` pedido de um contêiner.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parâmetros

*Msg*<br/>
Identificador de mensagem aprovado pelo Windows.

*wParam*<br/>
Como passou pelo Windows. Especifica informações específicas de mensagens adicionais. O conteúdo deste parâmetro depende do valor do parâmetro *msg.*

*lParam*<br/>
Como passou pelo Windows. Especifica informações específicas de mensagens adicionais. O conteúdo deste parâmetro depende do valor do parâmetro *msg.*

*plResult*<br/>
Código de resultados do Windows. Especifica o resultado do processamento da mensagem e depende da mensagem enviada.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Processa mensagens de janela para controles sem janelas. `COleControl`'s `OnWindowlessMessage` deve ser usado para mensagens de janela que não sejam mensagens de mouse e mensagens de teclado. `COleControl`fornece [SetCapture](#setcapture) e [SetFocus](#setfocus) especificamente para obter a captura do mouse e o foco do teclado para objetos OLE sem janelas.

Como os objetos sem janelas não têm uma janela, eles precisam de um mecanismo para permitir que o contêiner envie mensagens para eles. Um objeto OLE sem janelas recebe mensagens de seu contêiner, através do `OnWindowMessage` método na `IOleInPlaceObjectWindowless` interface (uma extensão do [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) para suporte sem janelas). `OnWindowMessage`não leva `HWND` um parâmetro.

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>COleControl::ParentToClient

Traduz as coordenadas de *pPoint* em coordenadas de cliente.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parâmetros

*lprcBounds*<br/>
Ponteiro para os limites do controle OLE dentro do recipiente. Não a área do cliente, mas a área de todo o controle, incluindo bordas e barras de rolagem.

*Ppoint*<br/>
Ponteiro para o ponto pai (contêiner) a ser traduzido nas coordenadas da área cliente do controle.

*bHitTest*<br/>
Especifica se o teste de acerto deve ou não ser feito no ponto.

### <a name="return-value"></a>Valor retornado

Se *bHitTest* for FALSO, retorna HTNOWHERE. Se *bHitTest* for TRUE, retorne o local em que o ponto pai (contêiner) pousou na área cliente do controle OLE e é um dos seguintes valores de teste de hit do mouse:

- HTBORDER Na borda de uma janela que não tem uma borda de dimensionamento.

- HTBOTTOM Na borda horizontal inferior da janela.

- HTBOTTOMLEFT No canto inferior esquerdo da borda da janela.

- HTBOTTOMRIGHT No canto inferior direito da borda da janela.

- HTCAPTION Em uma área de barra de títulos.

- HTCLIENT Em uma área de cliente.

- HTERROR No plano de fundo da tela ou em uma linha `DefWndProc` divisória entre janelas (o mesmo que HTNOWHERE, exceto que a função Windows produz um pembeilo do sistema para indicar um erro).

- HTGROWBOX Em uma caixa de tamanho.

- HTHSCROLL Na barra de rolagem horizontal.

- HTLEFT Na borda esquerda da janela.

- HTMAXBUTTON Em um botão Maximizar.

- HTMENU Em uma área de menu.

- HTMINBUTTON Em um botão Minimizar.

- HTNOWHERE No plano de fundo da tela ou em uma linha divisória entre janelas.

- HTREDUCE Em um botão Minimizar.

- HTRIGHT Na borda direita da janela.

- HTSIZE Em uma caixa de tamanho (a mesma de HTGROWBOX).

- HTSYSMENU Em um menu Controle ou em um botão Fechar em uma janela criança.

- HTTOP Na borda horizontal superior da janela.

- HTTOPLEFT No canto superior esquerdo da borda da janela.

- HTTOPRIGHT No canto superior direito da borda da janela.

- HTTRANSPARENT Em uma janela atualmente coberta por outra janela.

- HTVSCROLL Na barra de rolagem vertical.

- HTZOOM Em um botão Maximizar.

### <a name="remarks"></a>Comentários

Na entrada *pPoint* é relativo à origem do pai (canto superior esquerdo do recipiente). Na saída *pPoint* é relativo à origem da área cliente do controle OLE (canto superior esquerdo da área do cliente do controle).

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>COleControl::PostModalDialog

Notifica o contêiner de que uma caixa de diálogo modal foi fechada.

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parâmetros

*Hwndparent*<br/>
Manuseie a janela pai da caixa de diálogo modal.

### <a name="remarks"></a>Comentários

Ligue para esta função depois de exibir qualquer caixa de diálogo modal. Você deve chamar esta função para que o contêiner possa `PreModalDialog`habilitar quaisquer janelas de nível superior desativadas por . Esta função deve ser emparelhada com uma chamada para `PreModalDialog`.

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>COleControl::PreModalDialog

Notifica o recipiente de que uma caixa de diálogo modal está prestes a ser exibida.

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parâmetros

*Hwndparent*<br/>
Manuseie a janela pai da caixa de diálogo modal.

### <a name="remarks"></a>Comentários

Chame esta função antes de exibir qualquer caixa de diálogo modal. Você deve chamar esta função para que o contêiner possa desativar todas as suas janelas de nível superior. Depois que a caixa de diálogo modal `PostModalDialog`tiver sido exibida, você deve então chamar .

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>COleControl::RecreateControlWindow

Destrói e recria a janela do controle.

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>Comentários

Isso pode ser necessário se você precisar alterar os bits de estilo da janela.

## <a name="colecontrolrefresh"></a><a name="refresh"></a>COleControl::Atualização

Força uma repintura do controle oLE.

```cpp
void Refresh();
```

### <a name="remarks"></a>Comentários

Esta função é suportada pela `COleControl` classe base como um método de estoque, chamado Refresh. Isso permite que os usuários do seu controle OLE repintem o controle em um momento específico. Para obter mais informações sobre este método, consulte o artigo [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>COleControl::Captura de lançamento

Libera a captura do mouse.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Se o controle tiver acaptura do mouse no momento, a captura será liberada. Caso contrário, esta função não tem efeito.

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>COleControl::ReleaseDC

Libera o contexto do dispositivo de exibição de um contêiner de um controle sem janelas, liberando o contexto do dispositivo para uso por outras aplicações.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Identifica o contexto do dispositivo de contêiner a ser liberado.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

A solicitação `ReleaseDC` deve chamar para cada chamada para [GetDC](#getdc).

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow

Define o pai do controle.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parâmetros

*hWndOuter*<br/>
A alça da janela de controle.

*Hwndparent*<br/>
A alça da nova janela dos pais.

### <a name="remarks"></a>Comentários

Chame esta função para reiniciar o pai da janela de controle.

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>COleControl::ResetStockProps

Inicializa o estado `COleControl` das propriedades de estoque para seus valores padrão.

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>Comentários

As propriedades são: Appearance, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, hWnd e Text. Para obter uma descrição das propriedades de estoque, consulte [ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Você pode melhorar o desempenho de inicialização `ResetStockProps` `ResetVersion` binária `COleControl::OnResetState`de um controle usando e substituir . Veja o exemplo abaixo. Para obter mais informações sobre como otimizar a inicialização, consulte [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Exemplo

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>COleControl::ResetVersion

Inicializa o número da versão para o valor especificado.

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parâmetros

*dwVersionDefault*<br/>
O número da versão a ser atribuído ao controle.

### <a name="remarks"></a>Comentários

Você pode melhorar o desempenho de inicialização `ResetVersion` `ResetStockProps` binária `COleControl::OnResetState`de um controle usando e substituir . Veja o exemplo em [ResetStockProps](#resetstockprops). Para obter mais informações sobre como otimizar a inicialização, consulte [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>COleControl::ScrollWindow

Permite que um objeto OLE sem janelas role uma área dentro de sua imagem ativa no local na tela.

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parâmetros

*xAmount*<br/>
Especifica a quantidade, em unidades do dispositivo, de rolagem horizontal. Este parâmetro deve ser um valor negativo para rolar para a esquerda.

*yAmount*<br/>
Especifica a quantidade, em unidades do dispositivo, de rolagem vertical. Este parâmetro deve ser um valor negativo para rolar para cima.

*Lprect*<br/>
Aponta para um objeto [CRect](../../atl-mfc-shared/reference/crect-class.md) ou estrutura RECT que especifica a parte da área cliente do objeto OLE para rolar, nas coordenadas do cliente da janela de contenção. Se *o lpRect* for NULL, toda a área cliente do objeto OLE será rolada.

*lpClipRect*<br/>
Aponta para `CRect` um `RECT` objeto ou estrutura que especifica o retângulo a ser clipado. Apenas os pixels dentro do retângulo são rolados. Os bits fora do retângulo não são afetados mesmo que estejam no retângulo *lpRect.* Se *lpClipRect* for NULL, nenhum recorte será realizado no retângulo de rolagem.

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>COleControl::SelectFontObject

Seleciona uma fonte em um contexto de dispositivo.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Ponteiro para um objeto de contexto do dispositivo.

*fontHolder*<br/>
Referência ao objeto [CFontHolder](../../mfc/reference/cfontholder-class.md) representando a fonte a ser selecionada.

### <a name="return-value"></a>Valor retornado

Um ponteiro para a fonte previamente selecionada. Quando o chamador tiver terminado todas as operações de desenho que usam *fontHolder,* ele deve reselecionar a fonte selecionada anteriormente, passando-a como um parâmetro para [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>COleControl::SelectStockFont

Seleciona a propriedade Stock Font em um contexto de dispositivo.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
O contexto do dispositivo no qual a fonte será selecionada.

### <a name="return-value"></a>Valor retornado

Um ponteiro para o `CFont` objeto previamente selecionado. Você deve usar [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) para selecionar esta fonte de volta ao contexto do dispositivo quando estiver concluído.

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>COleControl::SerializeExtent

Serializa ou inicializa o estado do espaço de exibição atribuído ao controle.

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parâmetros

*ar*<br/>
Um `CArchive` objeto para serializar para ou de.

### <a name="remarks"></a>Comentários

Você pode melhorar o desempenho de persistência `SerializeExtent`binária de um controle usando , `SerializeStockProps`e `SerializeVersion` para substituir `COleControl::Serialize`. Veja o exemplo abaixo. Para obter mais informações sobre como otimizar a inicialização, consulte [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Exemplo

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>COleControl::SerializeStockProps

Serializa ou inicializa o estado `COleControl` das propriedades de estoque: Aparência, BackColor, BorderStyle, Caption, Habilitado, Fonte, ForeColor e Texto.

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parâmetros

*ar*<br/>
Um `CArchive` objeto para serializar para ou de.

### <a name="remarks"></a>Comentários

Para obter uma descrição das propriedades de estoque, consulte [ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Você pode melhorar o desempenho de persistência `SerializeStockProps`binária de um controle usando , `SerializeExtent`e `SerializeVersion` para substituir `COleControl::Serialize`. Por exemplo, consulte o código em [SerializeExtent](#serializeextent). Para obter mais informações sobre como otimizar a inicialização, consulte [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>COleControl::SerializeVersion

Serializa ou inicializa o estado das informações da versão de um controle.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parâmetros

*ar*<br/>
Um `CArchive` objeto para serializar para ou de.

*dwVersionDefault*<br/>
O número da versão atual do controle.

*bConverter*<br/>
Indica se os dados persistentes devem ser convertidos para o formato mais recente quando são salvos ou mantidos no mesmo formato que tinham quando foram carregados.

### <a name="return-value"></a>Valor retornado

O número da versão do controle. Se o arquivo especificado `SerializeVersion` estiver sendo carregado, a versão será carregada a partir desse arquivo. Caso contrário, ele retorna a versão atualmente carregada.

### <a name="remarks"></a>Comentários

Você pode melhorar o desempenho de persistência `SerializeVersion`binária de um controle usando , `SerializeExtent`e `SerializeStockProps` para substituir `COleControl::Serialize`. Por exemplo, consulte o código em [SerializeExtent](#serializeextent). Para obter mais informações sobre como otimizar a inicialização, consulte [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>COleControl::SetAppearance

Define o valor de propriedade de aparência de ações do seu controle.

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parâmetros

*sAparição*<br/>
Um **valor curto** (VT_I2) a ser usado para a aparência do seu controle. Um valor de zero define a aparência do controle para plana e um valor de 1 define a aparência do controle para 3D.

### <a name="remarks"></a>Comentários

Para obter mais informações sobre propriedades de estoque, consulte [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>COleControl::SetBackColor

Define o valor de propriedade BackColor do seu controle.

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parâmetros

*dwBackColor*<br/>
Um valor OLE_COLOR a ser usado para desenho de fundo do seu controle.

### <a name="remarks"></a>Comentários

Para obter mais informações sobre o uso desta propriedade e outras propriedades relacionadas, consulte o artigo [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>COleControl::SetBorderStyle

Define o valor de propriedade BorderStyle do seu controle.

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parâmetros

*sBorderStyle*<br/>
O novo estilo de fronteira para o controle; 0 indica nenhuma borda e 1 indica uma fronteira normal.

### <a name="remarks"></a>Comentários

A janela de controle será então `OnBorderStyleChanged` recriada e chamada.

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>COleControl::SetCapture

Faz com que a janela do contêiner do controle tome posse da captura do mouse em nome do controle.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro `CWnd` para o objeto da janela que recebeu anteriormente a entrada do mouse.

### <a name="remarks"></a>Comentários

Se o controle for ativado e sem janelas, esta função faz com que a janela de contêiner do controle tome posse da captura do mouse, em nome do controle. Caso contrário, essa função faz com que o próprio `CWnd::SetCapture`controle tome posse da captura do mouse (mesmo que ).

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>COleControl::SetControlSize

Define o tamanho da janela de controle OLE e notifica o contêiner de que o local de controle está mudando.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parâmetros

*Cx*<br/>
Especifica a nova largura do controle em pixels.

*Cy*<br/>
Especifica a nova altura do controle em pixels.

### <a name="return-value"></a>Valor retornado

Não zero se a chamada foi bem sucedida; caso contrário, 0.

### <a name="remarks"></a>Comentários

Esta função não deve ser usada no construtor do seu controle.

Observe que todas as coordenadas para janelas de controle são relativas ao canto superior esquerdo do controle.

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>COleControl::SetEnabled

Define o valor de propriedade habilitado do seu controle.

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parâmetros

*bEnabled*<br/>
TRUE se o controle for habilitado; caso contrário, FALSO.

### <a name="remarks"></a>Comentários

Depois de definir `OnEnabledChange` esta propriedade, é chamado.

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>COleControl::SetFocus

Faz com que a janela de contêiner do controle tome posse do foco de entrada em nome do controle.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro `CWnd` para o objeto da janela que anteriormente tinha o foco de entrada, ou NULL se não houver tal janela.

### <a name="remarks"></a>Comentários

Se o controle for ativado e sem janelas, esta função faz com que a janela de contêiner do controle tome posse do foco de entrada, em nome do controle. O foco de entrada direciona a entrada do teclado para a janela do contêiner, e `SetFocus`o contêiner envia todas as mensagens subseqüentes do teclado para o objeto OLE que chama . Qualquer janela que anteriormente tinha o foco de entrada perde-o.

Se o controle não for sem janelas, esta função faz com `CWnd::SetFocus`que o próprio controle tome posse do foco de entrada (mesmo que ).

## <a name="colecontrolsetfont"></a><a name="setfont"></a>COleControl::SetFont

Define a propriedade font de estoque do seu controle.

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parâmetros

*pFontDisp*<br/>
Um ponteiro para uma interface de despacho de fonte.

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>COleControl::SetForeColor

Define o valor de propriedade ForeColor do seu controle.

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parâmetros

*dwForeColor*<br/>
Um valor OLE_COLOR a ser usado para o desenho em primeiro plano do seu controle.

### <a name="remarks"></a>Comentários

Para obter mais informações sobre o uso desta propriedade e outras propriedades relacionadas, consulte o artigo [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats

Chamado pelo framework para inicializar a lista de formatos de dados suportados pelo controle.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Comentários

A implementação padrão especifica dois formatos: CF_METAFILEPICT e o conjunto de propriedades persistentes.

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>COleControl::SetInitialSize

Define o tamanho de um controle OLE quando exibido pela primeira vez em um recipiente.

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parâmetros

*Cx*<br/>
A largura inicial do controle OLE em pixels.

*Cy*<br/>
A altura inicial do controle OLE em pixels.

### <a name="remarks"></a>Comentários

Chame esta função em seu construtor para definir o tamanho inicial do seu controle. O tamanho inicial é medido em unidades de dispositivos, ou pixels. Recomenda-se que esta chamada seja feita na construtora do seu controle.

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>COleControl::SetModifiedFlag

Muda o estado modificado de um controle.

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parâmetros

*bModificado*<br/>
O novo valor para a bandeira modificada do controle. TRUE indica que o estado do controle foi modificado; FALSE indica que o estado do controle acabou de ser salvo.

### <a name="remarks"></a>Comentários

Ligue para esta função sempre que ocorrer uma alteração que afete o estado persistente do seu controle. Por exemplo, se o valor de uma propriedade persistente mudar, chame essa função com *bModified* **TRUE**.

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>COleControl::SetNotAllowed

Indica que uma solicitação de edição falhou.

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>Comentários

Chame esta `BoundPropertyRequestEdit` função quando falhar. Esta função lança uma `COleDispScodeException` exceção de tipo para indicar que a operação do conjunto não era permitida.

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>COleControl::SetNotSupported

Impede a modificação do valor de propriedade de um controle pelo usuário.

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>Comentários

Chame esta função no lugar da função Definir de qualquer propriedade onde a modificação do valor da propriedade pelo usuário do controle não seja suportada. Um exemplo seria uma propriedade que é apenas lida.

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>COleControl::SetRectInContainer

Define as coordenadas do retângulo do controle em relação ao recipiente, expressas em unidades de dispositivos.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*Lprect*<br/>
Um ponteiro para um retângulo contendo as novas coordenadas do controle em relação ao recipiente.

### <a name="return-value"></a>Valor retornado

Não zero se a chamada foi bem sucedida; caso contrário, 0.

### <a name="remarks"></a>Comentários

Se o controle estiver aberto, ele será redimensionado; caso contrário, a `OnPosRectChanged` função do recipiente é chamada.

## <a name="colecontrolsettext"></a><a name="settext"></a>COleControl::SetText

Define o valor da propriedade Legenda ou Texto do seu controle.

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parâmetros

*Psztext*<br/>
Um ponteiro para uma seqüência de caracteres.

### <a name="remarks"></a>Comentários

Observe que as propriedades Legenda e Texto de estoque estão mapeadas com o mesmo valor. Isso significa que quaisquer alterações feitas em qualquer propriedade mudarão automaticamente ambas as propriedades. Em geral, um controle deve suportar a propriedade Legenda de estoque ou Texto, mas não ambos.

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>COleControl::ThrowError

Sinaliza a ocorrência de um erro no seu controle.

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parâmetros

*Sc*<br/>
O valor do código de status a ser relatado. Para obter uma lista completa de possíveis códigos, consulte o artigo [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
O ID de recurso de string da exceção a ser relatado.

*nHelpID*<br/>
A id de ajuda do tópico a ser relatada.

*pszDescrição*<br/>
Uma seqüência contendo uma explicação da exceção a ser relatada.

### <a name="remarks"></a>Comentários

Essa função só deve ser chamada de uma função Get ou Set para uma propriedade OLE ou a implementação de um método de automação OLE. Se você precisar sinalizar erros que ocorrem em outras ocasiões, você deve disparar o evento de erro de estoque.

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>COleControl::TransformCoords

Transforma valores de coordenadas entre unidades HIMETRIC e unidades nativas do contêiner.

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parâmetros

*lpptlHimétrico*<br/>
Ponteiro para `POINTL` uma estrutura contendo coordenadas em unidades HIMETRIC.

*IpptfContainer*<br/>
Ponteiro para `POINTF` uma estrutura contendo coordenadas no tamanho da unidade do recipiente.

*Sinalizadores*<br/>
Uma combinação dos seguintes valores:

- XFORMCOORDS_POSITION posição A no recipiente.

- XFORMCOORDS_SIZE tamanho A no recipiente.

- XFORMCOORDS_HIMETRICTOCONTAINER Transforme unidades HIMETRIC para as unidades do contêiner.

- XFORMCOORDS_CONTAINERTOHIMETRIC Transforme as unidades do contêiner em unidades HIMETRIC.

### <a name="remarks"></a>Comentários

As duas primeiras bandeiras, XFORMCOORDS_POSITION e XFORMCOORDS_SIZE, indicam se as coordenadas devem ser tratadas como uma posição ou tamanho. As duas bandeiras restantes indicam o rumo da transformação.

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>COleControl::TranslateColor

Converte um valor de cor do OLE_COLOR tipo de dados para o tipo de dados [COLORREF.](/windows/win32/gdi/colorref)

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parâmetros

*clrColor*<br/>
Um OLE_COLOR tipo de dados. Para obter mais informações, consulte a função [Windows OleTranslateColor.](/windows/win32/api/olectl/nf-olectl-oletranslatecolor)

*hpal*<br/>
Uma alça para uma paleta opcional; pode ser NULO.

### <a name="return-value"></a>Valor retornado

Um valor de cor RGB (vermelho, verde, azul) de 32 bits que define a cor sólida mais próxima do valor *clrColor* que o dispositivo pode representar.

### <a name="remarks"></a>Comentários

Esta função é útil para traduzir as propriedades ForeColor e BackColor de estoque para os tipos COLORREF usados pelas funções do membro [CDC.](../../mfc/reference/cdc-class.md)

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDurante carga

Determina se seu controle deve usar os valores das propriedades ambientais como valores padrão, quando ele é posteriormente carregado de seu estado persistente.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Valor retornado

Não zero indica que as propriedades ambientais serão válidas; caso contrário, as propriedades ambientais não serão válidas.

### <a name="remarks"></a>Comentários

Em alguns contêineres, seu controle pode não ter acesso às suas `COleControl::DoPropExchange`propriedades ambientais durante a chamada inicial para a substituição de . Esse é o caso se o contêiner chamar [IPersistStreamInit::Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) ou [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) antes de chamar [IOleObject::SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (isto é, se ele não honrar o OLEMISC_SETCLIENTSITEFIRST bit de status).

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>COleControl::WindowProc

Fornece um procedimento `COleControl` do Windows para um objeto.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parâmetros

*message*<br/>
Especifica a mensagem do Windows a ser processada.

*wParam*<br/>
Fornece informações adicionais usadas no processamento da mensagem. O valor do parâmetro depende da mensagem.

*lParam*<br/>
Fornece informações adicionais usadas no processamento da mensagem. O valor do parâmetro depende da mensagem.

### <a name="return-value"></a>Valor retornado

O valor de retorno da mensagem enviada.

### <a name="remarks"></a>Comentários

Chame esta função para enviar mensagens específicas através do mapa de mensagens do controle.

## <a name="see-also"></a>Confira também

[MFC Amostra CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC Amostra TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[Classe COlePropertyPage](../../mfc/reference/colepropertypage-class.md)<br/>
[Classe CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Gráfico da hierarquia](../../mfc/hierarchy-chart.md)<br/>
[Classe CFontHolder](../../mfc/reference/cfontholder-class.md)<br/>
[Classe CPictureHolder](../../mfc/reference/cpictureholder-class.md)<br/>
