---
title: Classe COleClientItem
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: c880b1fb724b533bb049666460948c6df661a03c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81376279"
---
# <a name="coleclientitem-class"></a>Classe COleClientItem

Define a interface do contêiner para itens OLE.

## <a name="syntax"></a>Sintaxe

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Membros

### <a name="public-constructors"></a>Construtores públicos

|Nome|Descrição|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Constrói um objeto `COleClientItem`.|

### <a name="public-methods"></a>Métodos públicos

|Nome|Descrição|
|----------|-----------------|
|[COleClientItem::Ativar](#activate)|Abre o item OLE para uma operação e, em seguida, executa o verbo especificado.|
|[COleClientItem::AtivarAs](#activateas)|Ativa o item como outro tipo.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Acessa os dados no objeto OLE.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Indica se um aplicativo de contêiner pode criar um objeto incorporado.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Indica se um aplicativo de contêiner pode criar um objeto vinculado.|
|[COleClientItem::CanPaste](#canpaste)|Indica se a Área de Transferência contém um item OLE incorporado ou estático.|
|[COleClientItem::CanPasteLink](#canpastelink)|Indica se a Área de Transferência contém um item OLE vinculável.|
|[COleClientItem::Fechar](#close)|Fecha um link para um servidor, mas não destrói o item OLE.|
|[COleClientItem::Convertto](#convertto)|Converte o item para outro tipo.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Copia o item OLE para a área de transferência.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Cria uma duplicata de um item existente.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Cria um item incorporado a partir da área de transferência.|
|[COleClientItem::CreateFromData](#createfromdata)|Cria um item incorporado a partir de um objeto de dados.|
|[COleClientItem::CreateFromFile](#createfromfile)|Cria um item incorporado a partir de um arquivo.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Cria um item vinculado na Área de Transferência.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Cria um item vinculado a partir de um objeto de dados.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Cria um item vinculado a partir de um arquivo.|
|[COleClientItem::CreateNewItem](#createnewitem)|Cria um novo item incorporado lançando o aplicativo do servidor.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Cria um item estático a partir da Área de Transferência.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Cria um item estático a partir de um objeto de dados.|
|[COleClientItem::Deactivate](#deactivate)|Desativa o item.|
|[COleClientItem::DeactivateUI](#deactivateui)|Restaura a interface de usuário do aplicativo de contêiner ao seu estado original.|
|[COleClientItem::Delete](#delete)|Exclui ou fecha o item OLE se for um item vinculado.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Realiza uma operação de arrastar e soltar.|
|[COleClientItem::DoVerbo](#doverb)|Executa o verbo especificado.|
|[COleClientItem::Draw](#draw)|Desenha o item OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Obtém a visão em que o item é ativado no lugar.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Retorna os limites do retângulo do item OLE.|
|[COleClientItem::GetClassID](#getclassid)|Obtém a id da classe do presente.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Obtém os dados que seriam colocados `CopyToClipboard` na Área de Transferência chamando a função de membro.|
|[COleClientItem::GetDocument](#getdocument)|Retorna `COleDocument` o objeto que contém o item presente.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Obtém a visão atual do item para renderização.|
|[COleClientItem::GetExtent](#getextent)|Retorna os limites do retângulo do item OLE.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Recupera uma alça para um ícone associado ao servidor de um CLSID específico.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Obtém o metaarquivo usado para desenhar o ícone do item.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Retorna um ponteiro para a janela de edição no local do item.|
|[COleClientItem::GetItemState](#getitemstate)|Fica com o estado atual do item.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Retorna o status da última operação OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Retorna o modo de atualização para um item vinculado (recurso avançado).|
|[COleClientItem::GetType](#gettype)|Retorna o tipo (incorporado, ligado ou estático) do item OLE.|
|[COleClientItem::GetUserType](#getusertype)|Recebe uma seqüência descrevendo o tipo do item.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Retorna TRUE se o item estiver ativo no local.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Retorna TRUE se um item vinculado estiver atualizado com seu documento de origem.|
|[COleClientItem::IsModified](#ismodified)|Retorna TRUE se o item tiver sido modificado desde que foi salvo pela última vez.|
|[COleClientItem::IsOpen](#isopen)|Retorna TRUE se o item estiver atualmente aberto no aplicativo do servidor.|
|[COleClientItem:::Está funcionando](#isrunning)|Retorna TRUE se o aplicativo do servidor do item estiver em execução.|
|[COleClientItem::OnActivate](#onactivate)|Chamado pela estrutura para notificar o item que ele está ativado.|
|[COleClientItem::OnActivateUI](#onactivateui)|Chamado pela estrutura para notificar o item que ele está ativado e deve mostrar sua interface de usuário.|
|[COleClientItem::OnChange](#onchange)|Chamado quando o servidor altera o item OLE. Implementação necessária.|
|[COleClientItem::OnDeSactivate](#ondeactivate)|Chamado pela estrutura quando um item é desativado.|
|[COleClientItem::OnDeSactivateUI](#ondeactivateui)|Chamado pela estrutura quando o servidor removeu sua interface de usuário no local.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Chamado pela estrutura para obter os dados a serem copiados para a Área de Transferência.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Chamado pela estrutura para criar um menu composto.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Chamado pela estrutura para remover os menus do contêiner de um menu composto.|
|[COleClientItem::Menu de início](#onsetmenu)|Chamado pela estrutura para instalar e remover um menu composto.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Chamado pela estrutura para mostrar e esconder barras de controle.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Chamado pelo framework para atualizar a barra de título da janela do quadro.|
|[COleClientItem::ReativarAndUndo](#reactivateandundo)|Reativa o item e desfaz a última operação de edição no local.|
|[COleClientItem::Lançamento](#release)|Libera a conexão a um item vinculado ao OLE e fecha-a se estiver aberta. Não destrói o item do cliente.|
|[COleClientItem::Recarregar](#reload)|Recarrega o item após `ActivateAs`uma chamada para .|
|[COleClientItem::Executar](#run)|Executa o aplicativo associado ao item.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Define a visão atual do item para renderização.|
|[COleClientItem::SetExtent](#setextent)|Define o retângulo delimitador do item OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Define os nomes que o servidor exibe ao editar o item OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Armazena o metaarquivo usado para desenhar o ícone do item.|
|[COleClientItem::SetItemRects](#setitemrects)|Define o retângulo delimitador do item.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Define o modo de atualização para um item vinculado (recurso avançado).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Define o dispositivo de destino de impressão para este item cliente.|
|[COleClientItem::UpdateLink](#updatelink)|Atualiza o cache de apresentação de um item.|

### <a name="protected-methods"></a>Métodos Protegidos

|Nome|Descrição|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Chamado pela estrutura para determinar se a ativação no local é permitida.|
|[COleClientItem::OnChangeItemPosição](#onchangeitemposition)|Chamado pela estrutura quando a posição de um item muda.|
|[COleClientItem::OnDeSactivateAndUndo](#ondeactivateandundo)|Chamado pela estrutura para desfazer após a ativação.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Chamado pela estrutura para descartar as informações do estado de desfazer do item.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Chamado pela estrutura para obter as coordenadas retângulo de retângulo do item.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Chamado pela estrutura para obter a posição do item em relação à exibição.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Chamado pela estrutura quando um item é ativado no lugar.|
|[COleClientItem::OnScrollBy](#onscrollby)|Chamado pela estrutura para colocar o item em exibição.|
|[COleClientItem::OnShowItem](#onshowitem)|Chamado pela estrutura para exibir o item OLE.|

## <a name="remarks"></a>Comentários

Um item OLE representa dados, criados e mantidos por um aplicativo de servidor, que podem ser "perfeitamente" incorporados em um documento para que ele pareça ser um único documento. O resultado é um "documento composto" composto pelo item OLE e um documento contendo.

Um item OLE pode ser incorporado ou ligado. Se for incorporado, seus dados são armazenados como parte do documento composto. Se ele estiver vinculado, seus dados são armazenados como parte de um arquivo separado criado pelo aplicativo do servidor, e apenas um link para esse arquivo é armazenado no documento composto. Todos os itens do OLE contêm informações especificando o aplicativo do servidor que deve ser chamado para editá-los.

`COleClientItem`define várias funções superridíveis que são chamadas em resposta às solicitações do aplicativo do servidor; esses superridables geralmente agem como notificações. Isso permite que o aplicativo do servidor informe o contêiner de alterações que o usuário faz ao editar o item OLE ou para recuperar as informações necessárias durante a edição.

`COleClientItem`pode ser usado com a classe [COleDocument,](../../mfc/reference/coledocument-class.md) [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)ou [COleServerDoc.](../../mfc/reference/coleserverdoc-class.md) Para `COleClientItem`usar, obtenha uma classe dele e implemente a função membro [OnChange,](#onchange) que define como o contêiner responde às alterações feitas no item. Para suportar a ativação no local, anule a função membro [OnGetItemPosition.](#ongetitemposition) Esta função fornece informações sobre a posição exibida do item OLE.

Para obter mais informações sobre o uso da interface do contêiner, consulte os artigos [Containers: Implementando um container](../../mfc/containers-implementing-a-container.md) e [ativação](../../mfc/activation-cpp.md).

> [!NOTE]
> O Windows SDK refere-se a itens incorporados e vinculados como "objetos" e refere-se a tipos de itens como "classes". Esta referência usa o termo "item" para distinguir a entidade OLE do objeto C++ correspondente e o termo "tipo" para distinguir a categoria OLE da classe C++.

## <a name="inheritance-hierarchy"></a>Hierarquia de herança

[Cobject](../../mfc/reference/cobject-class.md)

[Ccmdtarget](../../mfc/reference/ccmdtarget-class.md)

[Cdocitem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Requisitos

**Cabeçalho:** afxole.h

## <a name="coleclientitemactivate"></a><a name="activate"></a>COleClientItem::Ativar

Chame esta função para executar o verbo especificado em vez de [DoVerb](#doverb) para que você possa fazer seu próprio processamento quando uma exceção for lançada.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parâmetros

*Nverb*<br/>
Especifica o verbo a ser executado. Pode ser um dos seguintes:

|Valor|Significado|Símbolo|
|-----------|-------------|------------|
|- 0|Verbo primário|OLEIVERB_PRIMARY|
|- 1|Verbo secundário|(Nenhuma)|
|- 1|Display item para edição|Oleiverb_show|
|- 2|Editar item em janela separada|OLEIVERB_OPEN|
|- 3|Ocultar item|OLEIVERB_HIDE|

O valor -1 é tipicamente um pseudônimo para outro verbo. Se a edição aberta não for suportada, -2 tem o mesmo efeito que -1. Para obter valores adicionais, consulte [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) no Windows SDK.

*pVer*<br/>
Ponteiro para a janela de exibição do contêiner que contém o item OLE; isso é usado pelo aplicativo do servidor para ativação no local. Este parâmetro deve ser NULO se o recipiente não suportar a ativação no local.

*Lpmsg*<br/>
Ponteiro para a mensagem que fez com que o item fosse ativado.

### <a name="remarks"></a>Comentários

Se o aplicativo do servidor foi escrito usando a Biblioteca de Classes da `COleServerItem` Microsoft Foundation, essa função fará com que a função de membro [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) do objeto correspondente seja executada.

Se o verbo principal for Editar e zero for especificado no parâmetro *nVerb,* o aplicativo do servidor será lançado para permitir que o item OLE seja editado. Se o aplicativo de contêiner suportar a ativação no local, a edição pode ser feita no local. Se o contêiner não suportar ativação no local (ou se o verbo Aberto for especificado), o servidor será iniciado em uma janela separada e a edição pode ser feita lá. Normalmente, quando o usuário do aplicativo de contêiner clica duas vezes no item OLE, o valor para o verbo principal no parâmetro *nVerb* determina qual ação o usuário pode tomar. No entanto, se o servidor suporta apenas uma ação, ele toma essa ação, não importa qual valor seja especificado no parâmetro *nVerb.*

Para obter mais informações, consulte [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) no Windows SDK.

## <a name="coleclientitemactivateas"></a><a name="activateas"></a>COleClientItem::AtivarAs

Usa as instalações de conversão de objetos do OLE para ativar o item como se fosse um item do tipo especificado pelo *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parâmetros

*lpszUserType*<br/>
Ponteiro para uma seqüência representando o tipo de usuário alvo, como "Documento do Texto".

*Clsidold*<br/>
Uma referência ao ID de classe atual do item. O ID de classe deve representar o tipo do objeto real, como armazenado, a menos que seja um link. Nesse caso, deve ser o CLSID do item a que o link se refere. O [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) fornece automaticamente o ID de classe correto para o item.

*Clsidnew*<br/>
Uma referência à iD da classe alvo.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Isso é chamado automaticamente por [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Normalmente não é chamado diretamente.

## <a name="coleclientitemattachdataobject"></a><a name="attachdataobject"></a>COleClientItem::AttachDataObject

Chame esta função para inicializar um [COleDataObject](../../mfc/reference/coledataobject-class.md) para acessar os dados no item OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parâmetros

*rDataObject*<br/>
Faça referência `COleDataObject` a um objeto que será inicializado para permitir o acesso aos dados no item OLE.

## <a name="coleclientitemcanactivate"></a><a name="canactivate"></a>COleClientItem::CanActivate

Chamado pelo framework quando o usuário solicita a ativação no local do item OLE; o valor de retorno desta função determina se a ativação no local é permitida.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Valor retornado

Não zero se a ativação no local for permitida; caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão permite a ativação no local se o contêiner tiver uma janela válida. Anular esta função para implementar uma lógica especial para aceitar ou recusar a solicitação de ativação. Por exemplo, uma solicitação de ativação pode ser recusada se o item OLE for muito pequeno ou não estiver visível no momento.

Para obter mais informações, consulte [IOleInPlaceSite::CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) no Windows SDK.

## <a name="coleclientitemcancreatefromdata"></a><a name="cancreatefromdata"></a>COleClientItem::CanCreateFromData

Verifica se um aplicativo de contêiner pode `COleDataObject` criar um objeto incorporado a partir do objeto dado.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parâmetros

*Pdataobject*<br/>
Ponteiro para o objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) a partir do qual o item OLE deve ser criado.

### <a name="return-value"></a>Valor retornado

Não zero se o recipiente puder `COleDataObject` criar um objeto incorporado a partir do objeto; caso contrário, 0.

### <a name="remarks"></a>Comentários

A `COleDataObject` classe é usada em transferências de dados para recuperar dados em vários formatos da Área de Transferência, através de arrastar e soltar, ou de um item OLE incorporado.

Os contêineres podem usar esta função para decidir ativar ou desativar seus comandos Editar colar e editar colar comandos especiais.

Para obter mais informações, consulte o artigo [Data Objects and Data Sources (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcancreatelinkfromdata"></a><a name="cancreatelinkfromdata"></a>COleClientItem::CanCreateLinkFromData

Verifica se um aplicativo de contêiner pode `COleDataObject` criar um objeto vinculado a partir do objeto dado.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parâmetros

*Pdataobject*<br/>
Ponteiro para o objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) a partir do qual o item OLE deve ser criado.

### <a name="return-value"></a>Valor retornado

Não zero se o recipiente pode `COleDataObject` criar um objeto vinculado a partir do objeto.

### <a name="remarks"></a>Comentários

A `COleDataObject` classe é usada em transferências de dados para recuperar dados em vários formatos da Área de Transferência, através de arrastar e soltar, ou de um item OLE incorporado.

Os contêineres podem usar esta função para decidir ativar ou desativar os comandos Editar colar especial e editar colar link.

Para obter mais informações, consulte o artigo [Data Objects and Data Sources (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcanpaste"></a><a name="canpaste"></a>COleClientItem::CanPaste

Ligue para esta função para ver se um item OLE incorporado pode ser colado na Área de Transferência.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Valor retornado

Não zero se um item OLE incorporado puder ser colado na área de transferência; caso contrário, 0.

### <a name="remarks"></a>Comentários

Para obter mais informações, consulte [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) e [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) no SDK do Windows.

## <a name="coleclientitemcanpastelink"></a><a name="canpastelink"></a>COleClientItem::CanPasteLink

Ligue para esta função para ver se um item OLE vinculado pode ser colado na Área de Transferência.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Valor retornado

Não zero se um item OLE vinculado puder ser colado na área de transferência; caso contrário, 0.

### <a name="remarks"></a>Comentários

Para obter mais informações, consulte [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) e [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) no SDK do Windows.

## <a name="coleclientitemclose"></a><a name="close"></a>COleClientItem::Fechar

Chame esta função para alterar o estado de um item OLE do estado em execução para o estado carregado, ou seja, carregado com seu manipulador na memória, mas com o servidor não sendo executado.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parâmetros

*dwCloseOption*<br/>
Sinalizador especificando em que circunstâncias o item OLE é salvo quando ele retorna ao estado carregado. Pode ter um dos seguintes valores:

- OLECLOSE_SAVEIFDIRTY Salve o item OLE.

- OLECLOSE_NOSAVE Não salve o item OLE.

- OLECLOSE_PROMPTSAVE solicitar ao usuário se deve salvar o item OLE.

### <a name="remarks"></a>Comentários

Esta função não tem efeito quando o item OLE não está em execução.

Para obter mais informações, consulte [IOleObject::Fechar](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) no SDK do Windows.

## <a name="coleclientitemcoleclientitem"></a><a name="coleclientitem"></a>COleClientItem::COleClientItem

Constrói um `COleClientItem` objeto e o adiciona à coleção de itens de documento do documento do contêiner, que constrói apenas o objeto C++ e não realiza nenhuma inicialização OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parâmetros

*pContainerDoc*<br/>
Ponteiro para o documento do contêiner que conterá este item. Isso pode ser qualquer derivado [coleDocument.](../../mfc/reference/coledocument-class.md)

### <a name="remarks"></a>Comentários

Se você passar um ponteiro NULL, nenhuma adição é feita ao documento do contêiner. Você deve chamar explicitamente [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).

Você deve chamar uma das seguintes funções de membro de criação antes de usar o item OLE:

- [CriarAdoClipboard](#createfromclipboard)

- [CriarDados](#createfromdata)

- [CriarArquivo](#createfromfile)

- [CriarStaticFromClipboard](#createstaticfromclipboard)

- [CriarstaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CriarLinkFromFile](#createlinkfromfile)

- [CriarNovoItem](#createnewitem)

- [Criarclonefrom](#createclonefrom)

## <a name="coleclientitemconvertto"></a><a name="convertto"></a>COleClientItem::Convertto

Chame esta função de membro para converter o item para o tipo especificado pelo *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parâmetros

*Clsidnew*<br/>
A classe de ida do tipo alvo.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Isso é chamado automaticamente por [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Não é necessário chamá-lo diretamente.

## <a name="coleclientitemcopytoclipboard"></a><a name="copytoclipboard"></a>COleClientItem::CopyToClipboard

Chame esta função para copiar o item OLE para a Área de Transferência.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parâmetros

*bIncludeLink*<br/>
TRUE se as informações de link devem ser copiadas para a Área de Transferência, permitindo que um item vinculado seja colado; caso contrário, FALSO.

### <a name="remarks"></a>Comentários

Normalmente, você chama essa função ao escrever manipuladores de mensagens para os comandos Copiar ou Cortar no menu Editar. Você deve implementar a seleção de itens no aplicativo do contêiner se quiser implementar os comandos Copiar ou Cortar.

Para obter mais informações, consulte [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) no Windows SDK.

## <a name="coleclientitemcreateclonefrom"></a><a name="createclonefrom"></a>COleClientItem::CreateCloneFrom

Chame esta função para criar uma cópia do item OLE especificado.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parâmetros

*pSrcItem*<br/>
Ponteiro para o item OLE a ser duplicado.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

A cópia é idêntica ao item de origem. Você pode usar esta função para suportar operações de desfazer.

## <a name="coleclientitemcreatefromclipboard"></a><a name="createfromclipboard"></a>COleClientItem::CreateFromClipboard

Chame esta função para criar um item incorporado a partir do conteúdo da Área de Transferência.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*Processar*<br/>
Sinalizador especificando como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no Windows SDK.

*Cfformat*<br/>
Especifica o formato de dados da Área de Transferência a ser armazenado em cache ao criar o item OLE.

*Lpformatetc*<br/>
Pointer para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *a renderização* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para este parâmetro somente se você quiser especificar informações adicionais de formato além do formato de área de transferência especificado pelo *cfFormat*. Se você omitir este parâmetro, os valores `FORMATETC` padrão são usados para os outros campos da estrutura.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Você normalmente chama essa função do manipulador de mensagens para o comando Colar no menu Editar. (O comando Colar é habilitado pela estrutura se a função [canpaste](#canpaste) de membro retornar não zero.)

Para obter mais informações, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no Windows SDK.

## <a name="coleclientitemcreatefromdata"></a><a name="createfromdata"></a>COleClientItem::CreateFromData

Chame esta função para criar um `COleDataObject` item incorporado a partir de um objeto.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*Pdataobject*<br/>
Ponteiro para o objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) a partir do qual o item OLE deve ser criado.

*Processar*<br/>
Sinalizador especificando como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no Windows SDK.

*Cfformat*<br/>
Especifica o formato de dados da Área de Transferência a ser armazenado em cache ao criar o item OLE.

*Lpformatetc*<br/>
Pointer para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *a renderização* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para este parâmetro somente se você quiser especificar informações adicionais de formato além do formato de área de transferência especificado pelo *cfFormat*. Se você omitir este parâmetro, os valores `FORMATETC` padrão são usados para os outros campos da estrutura.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

As operações de transferência de dados, como colar a partir `COleDataObject` da Área de Transferência ou das operações de arrastar e soltar, fornecem objetos que contenham as informações oferecidas por um aplicativo de servidor. Geralmente é usado na substituição do [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).

Para obter mais informações, consulte [OleCreateFromData,](/windows/win32/api/ole2/nf-ole2-olecreatefromdata) [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no Windows SDK.

## <a name="coleclientitemcreatefromfile"></a><a name="createfromfile"></a>COleClientItem::CreateFromFile

Chame esta função para criar um item OLE incorporado a partir de um arquivo.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*lpszFileName*<br/>
Pointer para o nome do arquivo a partir do qual o item OLE deve ser criado.

*clsid*<br/>
Reservado para uso futuro.

*Processar*<br/>
Sinalizador especificando como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no Windows SDK.

*Cfformat*<br/>
Especifica o formato de dados da Área de Transferência a ser armazenado em cache ao criar o item OLE.

*Lpformatetc*<br/>
Pointer para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *a renderização* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para este parâmetro somente se você quiser especificar informações adicionais de formato além do formato de área de transferência especificado pelo *cfFormat*. Se você omitir este parâmetro, os valores `FORMATETC` padrão são usados para os outros campos da estrutura.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

A estrutura chama essa função de [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) se o usuário escolher OK na caixa de diálogo Inserir objeto quando o botão Criar de arquivo estiver selecionado.

Para obter mais informações, consulte [OleCreateFromFile,](/windows/win32/api/ole/nf-ole-olecreatefromfile) [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no Windows SDK.

## <a name="coleclientitemcreatelinkfromclipboard"></a><a name="createlinkfromclipboard"></a>COleClientItem::CreateLinkFromClipboard

Chame esta função para criar um item vinculado a partir do conteúdo da Área de Transferência.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*Processar*<br/>
Sinalizador especificando como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no Windows SDK.

*Cfformat*<br/>
Especifica o formato de dados da Área de Transferência a ser armazenado em cache ao criar o item OLE.

*Lpformatetc*<br/>
Pointer para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *a renderização* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para este parâmetro somente se você quiser especificar informações adicionais de formato além do formato de área de transferência especificado pelo *cfFormat*. Se você omitir este parâmetro, os valores `FORMATETC` padrão são usados para os outros campos da estrutura.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Você normalmente chama essa função do manipulador de mensagens para o comando Colar link no menu Editar. (O comando Colar link está ativado na implementação padrão do [COleDocument](../../mfc/reference/coledocument-class.md) se a Área de Transferência contiver um item OLE que pode ser vinculado.)

Para obter mais informações, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no Windows SDK.

## <a name="coleclientitemcreatelinkfromdata"></a><a name="createlinkfromdata"></a>COleClientItem::CreateLinkFromData

Chame esta função para criar um `COleDataObject` item vinculado a partir de um objeto.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*Pdataobject*<br/>
Ponteiro para o objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) a partir do qual o item OLE deve ser criado.

*Processar*<br/>
Sinalizador especificando como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no Windows SDK.

*Cfformat*<br/>
Especifica o formato de dados da Área de Transferência a ser armazenado em cache ao criar o item OLE.

*Lpformatetc*<br/>
Pointer para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *a renderização* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para este parâmetro somente se você quiser especificar informações adicionais de formato além do formato de área de transferência especificado pelo *cfFormat*. Se você omitir este parâmetro, os valores `FORMATETC` padrão são usados para os outros campos da estrutura.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Chame isso durante uma operação de queda quando o usuário indicar que um link deve ser criado. Ele também pode ser usado para lidar com o comando Editar colar. Ele é chamado pela `COleClientItem::CreateLinkFromClipboard` framework in and [in COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) when the Link option for select( Link)

Para obter mais informações, consulte [OleCreateLinkFromData,](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata) [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no Windows SDK.

## <a name="coleclientitemcreatelinkfromfile"></a><a name="createlinkfromfile"></a>COleClientItem::CreateLinkFromFile

Chame esta função para criar um item OLE vinculado a partir de um arquivo.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*lpszFileName*<br/>
Pointer para o nome do arquivo a partir do qual o item OLE deve ser criado.

*Processar*<br/>
Sinalizador especificando como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no Windows SDK.

*Cfformat*<br/>
Especifica o formato de dados da Área de Transferência a ser armazenado em cache ao criar o item OLE.

*Lpformatetc*<br/>
Pointer para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *a renderização* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para este parâmetro somente se você quiser especificar informações adicionais de formato além do formato de área de transferência especificado pelo *cfFormat*. Se você omitir este parâmetro, os valores `FORMATETC` padrão são usados para os outros campos da estrutura.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

A estrutura chama essa função se o usuário escolher OK na caixa de diálogo Inserir objeto quando o botão Criar de Arquivo for selecionado e a caixa de seleção de Link for verificada. Ele é chamado de [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Para obter mais informações, consulte [OleCreateLinkToFile,](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile) [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no Windows SDK.

## <a name="coleclientitemcreatenewitem"></a><a name="createnewitem"></a>COleClientItem::CreateNewItem

Chame essa função para criar um item incorporado; esta função lança o aplicativo do servidor que permite ao usuário criar o item OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*clsid*<br/>
ID que identifica exclusivamente o tipo de item OLE a ser criado.

*Processar*<br/>
Sinalizador especificando como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no Windows SDK.

*Cfformat*<br/>
Especifica o formato de dados da Área de Transferência a ser armazenado em cache ao criar o item OLE.

*Lpformatetc*<br/>
Pointer para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *a renderização* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para este parâmetro somente se você quiser especificar informações adicionais de formato além do formato de área de transferência especificado pelo *cfFormat*. Se você omitir este parâmetro, os valores `FORMATETC` padrão são usados para os outros campos da estrutura.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

A estrutura chama essa função se o usuário escolher OK na caixa de diálogo Inserir objeto quando o botão Criar novo for selecionado.

Para obter mais informações, consulte [OleCreate,](/windows/win32/api/ole/nf-ole-olecreate) [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no Windows SDK.

## <a name="coleclientitemcreatestaticfromclipboard"></a><a name="createstaticfromclipboard"></a>COleClientItem::CreateStaticFromClipboard

Chame esta função para criar um item estático a partir do conteúdo da Área de Transferência.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*Processar*<br/>
Sinalizador especificando como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no Windows SDK.

*Cfformat*<br/>
Especifica o formato de dados da Área de Transferência a ser armazenado em cache ao criar o item OLE.

*Lpformatetc*<br/>
Pointer para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *a renderização* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para este parâmetro somente se você quiser especificar informações adicionais de formato além do formato de área de transferência especificado pelo *cfFormat*. Se você omitir este parâmetro, os valores `FORMATETC` padrão são usados para os outros campos da estrutura.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Um item estático contém os dados de apresentação, mas não os dados nativos; consequentemente, não pode ser editado. Você normalmente chama essa função se a função de membro [CreateFromClipboard](#createfromclipboard) falhar.

Para obter mais informações, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no Windows SDK.

## <a name="coleclientitemcreatestaticfromdata"></a><a name="createstaticfromdata"></a>COleClientItem::CreateStaticFromData

Chame esta função para criar um `COleDataObject` item estático a partir de um objeto.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*Pdataobject*<br/>
Ponteiro para o objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) a partir do qual o item OLE deve ser criado.

*Processar*<br/>
Sinalizador especificando como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no Windows SDK.

*Cfformat*<br/>
Especifica o formato de dados da Área de Transferência a ser armazenado em cache ao criar o item OLE.

*Lpformatetc*<br/>
Pointer para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *a renderização* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para este parâmetro somente se você quiser especificar informações adicionais de formato além do formato de área de transferência especificado pelo *cfFormat*. Se você omitir este parâmetro, os valores `FORMATETC` padrão são usados para os outros campos da estrutura.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Um item estático contém os dados de apresentação, mas não os dados nativos; consequentemente, não pode ser editado. Isso é essencialmente o mesmo [que CreateStaticFromClipboard,](#createstaticfromclipboard) exceto que um `COleDataObject`item estático pode ser criado a partir de uma área arbitrária, não apenas da Área de Transferência.

Usado em [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) when Static for selected.

Para obter mais informações, consulte [OleCreateStaticFromData,](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata) [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no Windows SDK.

## <a name="coleclientitemdeactivate"></a><a name="deactivate"></a>COleClientItem::Deactivate

Chame esta função para desativar o item OLE e liberar quaisquer recursos associados.

```
void Deactivate();
```

### <a name="remarks"></a>Comentários

Você normalmente desativa um item OLE ativo no local quando o usuário clica no mouse na área do cliente fora dos limites do item. Observe que a desativação do item OLE descartará seu estado de desfazer, impossibilitando a chamada de função de membro [ReactivateAndUndo.](#reactivateandundo)

Se o seu aplicativo suportar desfazer, não ligue; `Deactivate` em vez disso, ligue [para DesativarUI](#deactivateui).

Para obter mais informações, consulte [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) no Windows SDK.

## <a name="coleclientitemdeactivateui"></a><a name="deactivateui"></a>COleClientItem::DeactivateUI

Chame esta função quando o usuário desativar um item que foi ativado no lugar.

```
void DeactivateUI();
```

### <a name="remarks"></a>Comentários

Esta função restaura a interface de usuário do aplicativo de contêiner ao seu estado original, ocultando quaisquer menus e outros controles que foram criados para ativação no local.

Esta função não libera as informações do estado de desfazer para o item. Essas informações são retidas para que [o ReactivateAndUndo](#reactivateandundo) possa ser usado posteriormente para executar um comando desfazer no aplicativo do servidor, caso o comando desfazer do contêiner seja escolhido imediatamente após a desativação do item.

Para obter mais informações, consulte [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) no Windows SDK.

## <a name="coleclientitemdelete"></a><a name="delete"></a>COleClientItem::Delete

Chame esta função para excluir o item OLE do documento do contêiner.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parâmetros

*bAutoDelete*<br/>
Especifica se o item deve ser removido do documento.

### <a name="remarks"></a>Comentários

Esta função chama a função [''Liberar](#release) membro', que por sua vez exclui o objeto C++ para o item, removendo permanentemente o item OLE do documento. Se o item OLE estiver incorporado, os dados nativos do item serão excluídos. Ele sempre fecha um servidor em execução; portanto, se o item for um link aberto, esta função o fecha.

## <a name="coleclientitemdodragdrop"></a><a name="dodragdrop"></a>COleClientItem::DoDragDrop

Ligue `DoDragDrop` para a função de membro para executar uma operação de arrastar e soltar.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parâmetros

*lpItemRect*<br/>
O retângulo do item na tela em coordenadas do cliente (pixels).

*ptOffset*<br/>
O deslocamento do *lpItemRect* onde a posição do mouse estava no momento do arrasto.

*bIncludeLink*<br/>
Defina isso como TRUE se os dados do link forem copiados para a Área de Transferência. Defina-o como FALSO se o aplicativo do servidor não suportar links.

*dwEffects*<br/>
Determina os efeitos que a fonte de arrasto permitirá na operação de arrasto.

*lpRectStartDrag*<br/>
Ponteiro para o retângulo que define onde o arrasto realmente começa. Para obter mais informações, consulte a seção Comentários a seguir.

### <a name="return-value"></a>Valor retornado

Um valor DROPEFFECT. Se for em DROPEFFECT_MOVE, os dados originais devem ser removidos.

### <a name="remarks"></a>Comentários

A operação de arrastar e soltar não começa imediatamente. Ele espera até que o cursor do mouse deixe o retângulo especificado pelo *lpRectStartDrag* ou até que um número especificado de milissegundos tenha passado. Se *lpRectStartDrag* for NULL, o tamanho do retângulo será de um pixel.

O tempo de atraso é especificado por uma configuração de chave de registro. Você pode alterar o tempo de atraso ligando para [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) ou [CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Se você não especificar o tempo de atraso, um valor padrão de 200 milissegundos será usado. O tempo de atraso do arrasto é armazenado da seguinte forma:

- O tempo de atraso do Windows NT Drag é armazenado no HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- Windows 3.x O tempo de atraso de arrastar é armazenado no WIN. Arquivo INI, na seção [Windows}.

- Windows 95/98 O tempo de atraso do arrastar é armazenado em uma versão em cache do WIN. Ini.

Para obter mais informações sobre como as informações de atraso de arrasto são armazenadas no registro ou no . Arquivo INI, consulte [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) no Windows SDK.

## <a name="coleclientitemdoverb"></a><a name="doverb"></a>COleClientItem::DoVerbo

Chamada `DoVerb` para executar o verbo especificado.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parâmetros

*Nverb*<br/>
Especifica o verbo a ser executado. Pode incluir um dos seguintes:

|Valor|Significado|Símbolo|
|-----------|-------------|------------|
|- 0|Verbo primário|OLEIVERB_PRIMARY|
|- 1|Verbo secundário|(Nenhuma)|
|- 1|Display item para edição|Oleiverb_show|
|- 2|Editar item em janela separada|OLEIVERB_OPEN|
|- 3|Ocultar item|OLEIVERB_HIDE|

O valor -1 é tipicamente um pseudônimo para outro verbo. Se a edição aberta não for suportada, -2 tem o mesmo efeito que -1. Para obter valores adicionais, consulte [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) no Windows SDK.

*pVer*<br/>
Ponteiro para a janela de exibição; isso é usado pelo servidor para ativação no local. Este parâmetro deve ser NULO se a aplicação do contêiner não permitir a ativação no local.

*Lpmsg*<br/>
Ponteiro para a mensagem que fez com que o item fosse ativado.

### <a name="return-value"></a>Valor retornado

Não zero se o verbo foi executado com sucesso; caso contrário, 0.

### <a name="remarks"></a>Comentários

Esta função chama a função [Ativar](#activate) membro para executar o verbo. Ele também captura exceções e exibe uma caixa de mensagem para o usuário se uma for jogada.

Se o verbo principal for Editar e zero for especificado no parâmetro *nVerb,* o aplicativo do servidor será lançado para permitir que o item OLE seja editado. Se o aplicativo de contêiner suportar a ativação no local, a edição pode ser feita no local. Se o contêiner não suportar ativação no local (ou se o verbo Aberto for especificado), o servidor será iniciado em uma janela separada e a edição pode ser feita lá. Normalmente, quando o usuário do aplicativo de contêiner clica duas vezes no item OLE, o valor para o verbo principal no parâmetro *nVerb* determina qual ação o usuário pode tomar. No entanto, se o servidor suporta apenas uma ação, ele toma essa ação, não importa qual valor seja especificado no parâmetro *nVerb.*

## <a name="coleclientitemdraw"></a><a name="draw"></a>COleClientItem::Draw

Chame esta função para desenhar o item OLE no retângulo delimitador especificado usando o contexto do dispositivo especificado.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Ponteiro para um objeto [CDC](../../mfc/reference/cdc-class.md) usado para desenhar o item OLE.

*Lpbounds*<br/>
Pointer para um objeto `RECT` ou estrutura [CRect](../../atl-mfc-shared/reference/crect-class.md) que define o retângulo delimitador no qual desenhar o item OLE (em unidades lógicas determinadas pelo contexto do dispositivo).

*Ndrawaspect*<br/>
Especifica o aspecto do item OLE, ou seja, como deve ser exibido. Se *nDrawAspect* for -1, o último aspecto definido usando [SetDrawAspect](#setdrawaspect) é usado. Para obter mais informações sobre possíveis valores para este sinalizador, consulte [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

A função pode usar a representação de metaarquivo do item `COleServerItem`OLE criado pela função membro [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) de .

Normalmente você `Draw` usa para exibição de tela, passando o contexto do dispositivo de tela como *pDC*. Neste caso, você precisa especificar apenas os dois primeiros parâmetros.

O parâmetro *lpBounds* identifica o retângulo no contexto do dispositivo de destino (em relação ao seu modo de mapeamento atual). A renderização pode envolver o dimensionamento da imagem e pode ser usada por aplicativos de contêiner para impor uma visão que se dimensiona entre a visualização exibida e a imagem impressa final.

Para obter mais informações, consulte [IViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) no SDK do Windows.

## <a name="coleclientitemgetactiveview"></a><a name="getactiveview"></a>COleClientItem::GetActiveView

Retorna a exibição na qual o item está ativado no local.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para a vista; caso contrário, NULL se o item não estiver ativado no local.

## <a name="coleclientitemgetcachedextent"></a><a name="getcachedextent"></a>COleClientItem::GetCachedExtent

Chame esta função para recuperar o tamanho do item OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parâmetros

*lpTamanho*<br/>
Pointer para `SIZE` uma estrutura ou um objeto [CSize](../../atl-mfc-shared/reference/csize-class.md) que receberá as informações de tamanho.

*Ndrawaspect*<br/>
Especifica o aspecto do item OLE cujos limites devem ser recuperados. Para obter valores possíveis, consulte [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; 0 se o item OLE estiver em branco.

### <a name="remarks"></a>Comentários

Esta função fornece as mesmas informações [que GetExtent](#getextent). No entanto, `GetCachedExtent` você pode ligar para obter informações de extensão durante o processamento de outros manipuladores de OLE, como [o OnChange](#onchange). As dimensões estão em unidades MM_HIMETRIC.

Isso é `GetCachedExtent` possível porque usa a interface [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) em vez de usar a interface [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) para obter a extensão deste item. O `IViewObject2` objeto COM armazena em cache as informações de extensão usadas na chamada anterior para [IViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Para obter mais informações, consulte [IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) no Windows SDK.

## <a name="coleclientitemgetclassid"></a><a name="getclassid"></a>COleClientItem::GetClassID

Retorna o ID de classe do item na memória apontada por *pClassID*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parâmetros

*Pclassid*<br/>
Ponteiro para um identificador do tipo [CLSID](/windows/win32/com/clsid-key-hklm) para recuperar o ID de classe. Para obter informações sobre clsid, consulte o Windows SDK.

### <a name="remarks"></a>Comentários

O ID de classe é um número de 128 bits que identifica exclusivamente o aplicativo que emite o item.

Para obter mais informações, consulte [IPersist::GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) no Windows SDK.

## <a name="coleclientitemgetclipboarddata"></a><a name="getclipboarddata"></a>COleClientItem::GetClipboardData

Chame esta função `COleDataSource` para obter um objeto contendo todos os dados que seriam colocados na Área de Transferência por uma chamada para a função membro [CopyToClipboard.](#copytoclipboard)

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parâmetros

*pDataSource*<br/>
Pointer para um objeto [COleDataSource](../../mfc/reference/coledatasource-class.md) que receberá os dados contidos no item OLE.

*bIncludeLink*<br/>
TRUE se os dados de link devem ser incluídos; caso contrário, FALSO.

*lpOffset*<br/>
O deslocamento do cursor do mouse da origem do objeto em pixels.

*lpTamanho*<br/>
O tamanho do objeto em pixels.

### <a name="remarks"></a>Comentários

`GetClipboardData`é chamada de implementação padrão do [OnGetClipboardData](#ongetclipboarddata). Substituir `OnGetClipboardData` somente se você quiser oferecer formatos de dados `CopyToClipboard`além daqueles oferecidos por . Coloque esses formatos `COleDataSource` no objeto `CopyToClipboard`antes ou depois `COleDataSource` da chamada e passe o objeto para a função [COleDataSource::SetClipboard.](../../mfc/reference/coledatasource-class.md#setclipboard) Por exemplo, se você quiser que a posição do item OLE em seu documento de contêiner para acompanhá-lo `COleDataSource` na `CopyToClipboard`Área de Transferência, você definirá seu próprio formato para passar essas informações e colocá-la na chamada anterior .

## <a name="coleclientitemgetdocument"></a><a name="getdocument"></a>COleClientItem::GetDocument

Chame esta função para obter um ponteiro para o documento que contém o item OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para o documento que contém o item OLE. NULO se o item não fizer parte de um documento.

### <a name="remarks"></a>Comentários

Este ponteiro permite `COleDocument` o acesso ao objeto que `COleClientItem` você passou como argumento para o construtor.

## <a name="coleclientitemgetdrawaspect"></a><a name="getdrawaspect"></a>COleClientItem::GetDrawAspect

Ligue `GetDrawAspect` para a função membro para determinar o "aspecto" atual, ou exibição, do item.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Valor retornado

Um valor da enumeração DVASPECT, cujos valores estão listados na referência para [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Comentários

O aspecto especifica como o item deve ser renderizado.

## <a name="coleclientitemgetextent"></a><a name="getextent"></a>COleClientItem::GetExtent

Chame esta função para recuperar o tamanho do item OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parâmetros

*lpTamanho*<br/>
Ponteiro para `SIZE` uma `CSize` estrutura ou um objeto que receberá as informações de tamanho.

*Ndrawaspect*<br/>
Especifica o aspecto do item OLE cujos limites devem ser recuperados. Para obter valores possíveis, consulte [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; 0 se o item OLE estiver em branco.

### <a name="remarks"></a>Comentários

Se o aplicativo do servidor foi escrito usando a Biblioteca de Classes da `COleServerItem` Microsoft Foundation, essa função fará com que a função de membro [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) do objeto correspondente seja chamada. Observe que o tamanho recuperado pode diferir do tamanho do último conjunto pela função [setExtent](#setextent) member; o tamanho especificado por `SetExtent` é tratado como uma sugestão. As dimensões estão em unidades MM_HIMETRIC.

> [!NOTE]
> Não ligue `GetExtent` durante o processamento de um manipulador OLE, como [o OnChange](#onchange). Ligue para [getcachedExtent](#getcachedextent) em vez disso.

Para obter mais informações, consulte [IOleObject::GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) no Windows SDK.

## <a name="coleclientitemgeticonfromregistry"></a><a name="geticonfromregistry"></a>COleClientItem::GetIconFromRegistry

Ligue para esta função de membro para recuperar uma alça para um recurso de ícone associado ao servidor de um CLSID específico.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parâmetros

*clsid*<br/>
Uma referência ao CLSID para o servidor associado ao ícone.

### <a name="return-value"></a>Valor retornado

Uma alça válida para o recurso de ícone, ou NULL se o ícone do servidor, ou um ícone padrão, não puder ser encontrado.

### <a name="remarks"></a>Comentários

Essa função de membro não iniciará o servidor ou obterá um ícone dinamicamente, mesmo que o servidor já esteja em execução. Em vez disso, essa função de membro abre a imagem executável do servidor e recupera o ícone estático associado ao servidor à medida que ele foi registrado.

## <a name="coleclientitemgeticonicmetafile"></a><a name="geticonicmetafile"></a>COleClientItem::GetIconicMetafile

Recupera o metaarquivo usado para desenhar o ícone do item.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Valor retornado

Uma alça para o metaarquivo se for bem sucedida; caso contrário, NULL.

### <a name="remarks"></a>Comentários

Se não houver um ícone atual, um ícone padrão será retornado. Isso é chamado automaticamente pelas diálogos MFC/OLE e geralmente não é chamado diretamente.

Essa função também chama [SetIconicMetafile](#seticonicmetafile) para fazer o cache do metaarquivo para uso posterior.

## <a name="coleclientitemgetinplacewindow"></a><a name="getinplacewindow"></a>COleClientItem::GetInPlaceWindow

Ligue `GetInPlaceWindow` para a função membro para obter um ponteiro para a janela em que o item foi aberto para edição no local.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Valor retornado

Um ponteiro para a janela de edição do item no lugar; NULL se o item não estiver ativo ou se seu servidor estiver indisponível.

### <a name="remarks"></a>Comentários

Esta função deve ser chamada apenas para itens que estejam ativos no local.

## <a name="coleclientitemgetitemstate"></a><a name="getitemstate"></a>COleClientItem::GetItemState

Ligue para esta função para obter o estado atual do item OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Valor retornado

Um `COleClientItem::ItemState` valor enumerado, que pode ser `emptyState` `loadedState`um `openState` `activeState`dos `activeUIState`seguintes: , , , . Para obter informações sobre esses estados, consulte o artigo [Containers: Client-Item States](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Comentários

Para ser notificado quando o estado do oLE mudar, use a função membro [OnChange.](#onchange)

Para obter mais informações, consulte o artigo [Containers: Client-Item States](../../mfc/containers-client-item-states.md).

## <a name="coleclientitemgetlaststatus"></a><a name="getlaststatus"></a>COleClientItem::GetLastStatus

Retorna o código de status da última operação OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Valor retornado

Um valor SCODE.

### <a name="remarks"></a>Comentários

Para funções de membro que retornam um valor BOOL de `GetLastStatus` FALSE, ou outras funções de membro que retornam NULL, retorna informações de falha mais detalhadas. Esteja ciente de que a maioria das funções de membros do OLE lançam exceções para erros mais graves. As informações específicas sobre a interpretação do SCODE dependem da chamada OLE subjacente que retornou pela última vez um valor SCODE.

Para obter mais informações sobre o SCODE, consulte [Estrutura de Códigos de erro COM](/windows/win32/com/structure-of-com-error-codes) na documentação do Windows SDK.

## <a name="coleclientitemgetlinkupdateoptions"></a><a name="getlinkupdateoptions"></a>COleClientItem::GetLinkUpdateOptions

Ligue para esta função para obter o valor atual da opção de atualização de link para o item OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Valor retornado

Um dos seguintes valores:

- OLEUPDATE_ALWAYS atualize o item vinculado sempre que possível. Esta opção suporta o botão de rádio de atualização automática de link na caixa de diálogo Links.

- OLEUPDATE_ONCALL Atualize o item vinculado somente a pedido do aplicativo de contêiner (quando a função membro [UpdateLink](#updatelink) for chamada). Esta opção suporta o botão de rádio manual de atualização de link na caixa de diálogo Links.

### <a name="remarks"></a>Comentários

Esta é uma operação avançada.

Esta função é chamada automaticamente pela classe [COleLinksDialog.](../../mfc/reference/colelinksdialog-class.md)

Para obter mais informações, consulte [IOleLink::GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) no Windows SDK.

## <a name="coleclientitemgettype"></a><a name="gettype"></a>COleClientItem::GetType

Ligue para esta função para determinar se o item OLE está incorporado ou ligado ou estático.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Valor retornado

Um inteiro não assinado com um dos seguintes valores:

- OT_LINK o item OLE é um link.

- OT_EMBEDDED o item OLE está incorporado.

- OT_STATIC o item OLE é estático, ou seja, contém apenas dados de apresentação, não dados nativos e, portanto, não pode ser editado.

## <a name="coleclientitemgetusertype"></a><a name="getusertype"></a>COleClientItem::GetUserType

Chame essa função para obter a seqüência visível do usuário descrevendo o tipo do item OLE, como "Documento do Word".

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parâmetros

*nUserClassType*<br/>
Um valor indicando a variante desejada da seqüência descrevendo o tipo do item OLE. Isso pode ter um dos seguintes valores:

- USERCLASSTYPE_FULL O nome completo do tipo exibido ao usuário.

- USERCLASSTYPE_SHORT Um nome curto (máximo de 15 caracteres) para uso em menus pop-up e na caixa de diálogo Editar links.

- USERCLASSTYPE_APPNAME Nome do aplicativo que atende a classe.

*rString*<br/>
Uma referência a um objeto [CString](../../atl-mfc-shared/reference/cstringt-class.md) ao qual a seqüência que descreve o tipo de item OLE deve ser devolvida.

### <a name="remarks"></a>Comentários

Esta é muitas vezes a entrada no banco de dados de registro do sistema.

Se o nome completo do tipo for solicitado, mas não estiver disponível, o nome curto será usado em seu lugar. Se nenhuma entrada para o tipo de item OLE for encontrada no banco de dados de registro, ou se não houver tipos de usuário registrados para o tipo de item OLE, então o tipo de usuário atualmente armazenado no item OLE é usado. Se esse nome de tipo de usuário for uma seqüência de string vazia, "Objeto Desconhecido" será usado.

Para obter mais informações, consulte [IOleObject::GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) no Windows SDK.

## <a name="coleclientitemisinplaceactive"></a><a name="isinplaceactive"></a>COleClientItem::IsInPlaceActive

Ligue para esta função para ver se o item OLE está ativo no local.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Valor retornado

Não zero se o item OLE estiver ativo no local; caso contrário, 0.

### <a name="remarks"></a>Comentários

É comum executar uma lógica diferente dependendo se o item está sendo editado no lugar. A função verifica se o estado atual `activeState` do `activeUIState`item é igual ao ou ao .

## <a name="coleclientitemislinkuptodate"></a><a name="islinkuptodate"></a>COleClientItem::IsLinkUpToDate

Ligue para esta função para ver se o item OLE está atualizado.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Valor retornado

Não zero se o item OLE estiver atualizado; caso contrário, 0.

### <a name="remarks"></a>Comentários

Um item vinculado pode estar desatualizado se seu documento de origem tiver sido atualizado. Um item incorporado que contém links dentro dele pode igualmente ficar desatualizado. A função faz uma verificação recursiva do item OLE. Observe que determinar se um item OLE está desatualizado pode ser tão caro quanto realmente realizar uma atualização.

Isso é chamado automaticamente pela implementação [COleLinksDialog.](../../mfc/reference/colelinksdialog-class.md)

Para obter mais informações, consulte [IOleObject::IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) no Windows SDK.

## <a name="coleclientitemismodified"></a><a name="ismodified"></a>COleClientItem::IsModified

Ligue para esta função para ver se o item OLE está sujo (modificado desde que foi salvo pela última vez).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Valor retornado

Não zero se o item OLE estiver sujo; caso contrário, 0.

### <a name="remarks"></a>Comentários

Para obter mais informações, consulte [IPersistStorage::IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) no Windows SDK.

## <a name="coleclientitemisopen"></a><a name="isopen"></a>COleClientItem::IsOpen

Ligue para esta função para ver se o item OLE está aberto; ou seja, aberto em uma instância do aplicativo do servidor em execução em uma janela separada.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Valor retornado

Não zero se o item OLE estiver aberto; caso contrário, 0.

### <a name="remarks"></a>Comentários

É usado para determinar quando desenhar o objeto com um padrão de eclosão. Um objeto aberto deve ter um padrão de escotilha desenhado em cima do objeto. Você pode usar um objeto [CRectTracker](../../mfc/reference/crecttracker-class.md) para conseguir isso.

## <a name="coleclientitemisrunning"></a><a name="isrunning"></a>COleClientItem:::Está funcionando

Ligue para esta função para ver se o item OLE está sendo executado; ou seja, se o item está carregado e em execução no aplicativo do servidor.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Valor retornado

Não zero se o item OLE estiver em execução; caso contrário, 0.

### <a name="remarks"></a>Comentários

Para obter mais informações, consulte [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) no SDK do Windows.

## <a name="coleclientitemonactivate"></a><a name="onactivate"></a>COleClientItem::OnActivate

Chamado pela estrutura para notificar o item que ele acaba de ser ativado no local.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Comentários

Observe que esta função é chamada para indicar que o servidor está em execução, não para indicar que sua interface de usuário foi instalada no aplicativo do contêiner. Neste ponto, o objeto não tem uma interface `activeUIState`de usuário ativa (não é ). Não instalou seus menus ou barra de ferramentas. A função de membro [OnActivateUI](#onactivateui) é chamada quando isso acontece.

A implementação padrão chama a função de membro [OnChange](#onchange) com OLE_CHANGEDSTATE como parâmetro. Substituir esta função para executar o processamento personalizado quando um item se torna ativo no local.

## <a name="coleclientitemonactivateui"></a><a name="onactivateui"></a>COleClientItem::OnActivateUI

O framework `OnActivateUI` é chamada quando o objeto entrou no estado ativo de iu.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Comentários

O objeto já instalou sua barra de ferramentas e menus.

A implementação padrão lembra o HWND do servidor para chamadas posteriores. `GetServerWindow`

## <a name="coleclientitemonchange"></a><a name="onchange"></a>COleClientItem::OnChange

Chamado pela estrutura quando o usuário modifica, salva ou fecha o item OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parâmetros

*Ncode*<br/>
A razão pela qual o servidor mudou este item. Pode ter um dos seguintes valores:

- OLE_CHANGED a aparência do item OLE mudou.

- OLE_SAVED o item OLE foi salvo.

- OLE_CLOSED o item OLE foi fechado.

- OLE_CHANGED_STATE o item OLE mudou de um estado para outro.

*Dwparam*<br/>
Se *nCode* for OLE_SAVED ou OLE_CLOSED, este parâmetro não será usado. Se *nCode* for OLE_CHANGED, este parâmetro especifica rastizará o aspecto do item OLE que foi alterado. Para obter valores possíveis, consulte o parâmetro *dwParam* de [COleClientItem::Draw](#draw). Se *nCode* for OLE_CHANGED_STATE, esse `COleClientItem::ItemState` parâmetro é um valor enumerado e descreve o estado que está sendo inserido. Pode ter um dos seguintes `loadedState` `openState`valores: `activeUIState` `emptyState`, , , `activeState`, ou .

### <a name="remarks"></a>Comentários

(Se o aplicativo do servidor for escrito usando a Biblioteca de `Notify` Classes da `COleServerDoc` `COleServerItem`Microsoft Foundation, essa função será chamada em resposta às funções de membro de ou .) A implementação padrão marca o documento do contêiner como modificado se *o nCode* for OLE_CHANGED ou OLE_SAVED.

Para OLE_CHANGED_STATE, o estado atual retornou do [Estado de GetItem](#getitemstate) ainda será o estado antigo, ou seja, o estado que estava atual antes dessa mudança de estado.

Anular esta função para responder a alterações no estado do item OLE. Normalmente, você atualiza a aparência do item invalidando a área em que o item é exibido. Ligue para a implementação da classe base no início da sua substituição.

## <a name="coleclientitemonchangeitemposition"></a><a name="onchangeitemposition"></a>COleClientItem::OnChangeItemPosição

Chamado pela estrutura para notificar o contêiner de que a extensão do item OLE foi alterada durante a ativação no local.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parâmetros

*rectPos*<br/>
Indica a posição do item em relação à área cliente do aplicativo de contêiner.

### <a name="return-value"></a>Valor retornado

Não zero se a posição do item for alterada com sucesso; caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão determina o novo retângulo visível do item OLE e chama [SetItemRects](#setitemrects) com os novos valores. A implementação padrão calcula o retângulo visível para o item e repassa essas informações para o servidor.

Substituir esta função para aplicar regras especiais à operação de redimensionamento/movimento. Se o aplicativo estiver gravado no MFC, essa chamada será cancelada porque o servidor chamado [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

## <a name="coleclientitemondeactivate"></a><a name="ondeactivate"></a>COleClientItem::OnDeSactivate

Chamado pelo framework quando o item OLE passa do `activeState`estado ativo no local ( ) para o estado carregado, o que significa que ele é desativado após uma ativação no local.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Comentários

Observe que esta função é chamada para indicar que o item OLE está fechado, não que sua interface de usuário tenha sido removida do aplicativo do contêiner. Quando isso acontece, a função [membro OnDeactivateUI](#ondeactivateui) é chamada.

A implementação padrão chama a função de membro [OnChange](#onchange) com OLE_CHANGEDSTATE como parâmetro. Substituir esta função para executar o processamento personalizado quando um item ativo no local é desativado. Por exemplo, se você suportar o comando desfazer no aplicativo do contêiner, você pode substituir esta função para descartar o estado de desfazer, indicando que a última operação realizada no item OLE não pode ser desfeita uma vez que o item é desativado.

## <a name="coleclientitemondeactivateandundo"></a><a name="ondeactivateandundo"></a>COleClientItem::OnDeSactivateAndUndo

Chamado pela estrutura quando o usuário invoca o comando desfazer depois de ativar o item OLE no lugar.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Comentários

A implementação padrão chama [DesativarUI](#deactivateui) para desativar a interface de usuário do servidor. Anular esta função se você estiver implementando o comando desfazer no aplicativo do contêiner. Em sua substituição, chame a versão de classe base da função e, em seguida, desfaça o último comando executado em seu aplicativo.

Para obter mais informações, consulte [IOleInPlaceSite::DeactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) no Windows SDK.

## <a name="coleclientitemondeactivateui"></a><a name="ondeactivateui"></a>COleClientItem::OnDeSactivateUI

Chamado quando o usuário desativa um item que foi ativado no local.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parâmetros

*bUndoable*<br/>
Especifica se as alterações de edição são inviáveis.

### <a name="remarks"></a>Comentários

Esta função restaura a interface de usuário do aplicativo de contêiner ao seu estado original, ocultando quaisquer menus e outros controles que foram criados para ativação no local.

Se *bUndoable* for FALSE, o contêiner deve desativar o comando dedesfazer, descartando o estado de desfazer do contêiner, pois indica que a última operação realizada pelo servidor não é intransável.

## <a name="coleclientitemondiscardundostate"></a><a name="ondiscardundostate"></a>COleClientItem::OnDiscardUndoState

Chamado pelo framework quando o usuário executa uma ação que descarta o estado de desfazer ao editar o item OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Comentários

A implementação padrão não faz nada. Anular esta função se você estiver implementando o comando desfazer no aplicativo do contêiner. Em sua substituição, descarte o estado de desfaça-se da aplicação do contêiner.

Se o servidor foi gravado com a Biblioteca de Classes da Microsoft Foundation, o servidor pode fazer com que essa função seja chamada [chamando COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Para obter mais informações, consulte [IOleInPlaceSite::DiscardUndoState](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) no Windows SDK.

## <a name="coleclientitemongetclipboarddata"></a><a name="ongetclipboarddata"></a>COleClientItem::OnGetClipboardData

Chamado pela estrutura para `COleDataSource` obter um objeto contendo todos os dados que seriam colocados na Área de Transferência por uma chamada para a [Copia-Clipboard](#copytoclipboard) ou para a função membro [DoDragDrop.](#dodragdrop)

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parâmetros

*bIncludeLink*<br/>
Defina isso como TRUE se os dados do link forem copiados para a Área de Transferência. Defina isso como FALSO se o aplicativo do servidor não suportar links.

*lpOffset*<br/>
Ponteiro para o deslocamento do cursor do mouse a partir da origem do objeto em pixels.

*lpTamanho*<br/>
Ponteiro para o tamanho do objeto em pixels.

### <a name="return-value"></a>Valor retornado

Um ponteiro para um objeto [COleDataSource](../../mfc/reference/coledatasource-class.md) contendo os dados da Área de Transferência.

### <a name="remarks"></a>Comentários

A implementação padrão desta função chama [GetClipboardData](#getclipboarddata).

## <a name="coleclientitemongetcliprect"></a><a name="ongetcliprect"></a>COleClientItem::OnGetClipRect

A estrutura `OnGetClipRect` chama a função de membro para obter as coordenadas retângulo de recorte do item que está sendo editado no lugar.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parâmetros

*rClipRect*<br/>
Ponteiro para um objeto da classe [CRect](../../atl-mfc-shared/reference/crect-class.md) que irá conter as coordenadas retângulo de recorte do item.

### <a name="remarks"></a>Comentários

As coordenadas estão em pixels relativos à área cliente da janela do aplicativo de contêiner.

A implementação padrão simplesmente retorna o retângulo cliente da exibição em que o item está ativo no local.

## <a name="coleclientitemongetitemposition"></a><a name="ongetitemposition"></a>COleClientItem::OnGetItemPosition

O framework `OnGetItemPosition` chama a função de membro para obter as coordenadas do item que está sendo editado no lugar.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parâmetros

*Rposition*<br/>
Faça referência ao objeto [CRect](../../atl-mfc-shared/reference/crect-class.md) que conterá as coordenadas de posição do item.

### <a name="remarks"></a>Comentários

As coordenadas estão em pixels relativos à área cliente da janela do aplicativo de contêiner.

A implementação padrão desta função não faz nada. Aplicativos que suportam edição no local exigem sua implementação.

## <a name="coleclientitemongetwindowcontext"></a><a name="ongetwindowcontext"></a>COleClientItem::OnGetWindowContext

Chamado pela estrutura quando um item é ativado no lugar.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parâmetros

*ppMainFrame*<br/>
Ponteiro para um ponteiro para a janela do quadro principal.

*ppDocFrame*<br/>
Ponteiro para um ponteiro para a janela do quadro de documentos.

*lpFrameInfo*<br/>
Pointer para uma estrutura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) que receberá informações da janela do quadro.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Esta função é usada para recuperar informações sobre a janela pai do item OLE.

Se o contêiner for um aplicativo MDI, a implementação padrão reacircunda um ponteiro para o objeto [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) no *ppMainFrame* e um ponteiro para o objeto [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) ativo no *ppDocFrame*. Se o contêiner for um aplicativo SDI, a implementação padrão retorna um ponteiro para o objeto [CFrameWnd](../../mfc/reference/cframewnd-class.md) no *ppMainFrame* e retorna NULL no *ppDocFrame*. A implementação padrão também preenche os membros do *lpFrameInfo*.

Substituir essa função somente se a implementação padrão não se adequar ao seu aplicativo; por exemplo, se o seu aplicativo tiver um paradigma de interface de usuário que difere do SDI ou MDI. Este é um avançado super-rididável.

Para obter mais informações, consulte [IOleInPlaceSite::GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) e a estrutura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) no SDK do Windows.

## <a name="coleclientitemoninsertmenus"></a><a name="oninsertmenus"></a>COleClientItem::OnInsertMenus

Chamado pela estrutura durante a ativação no local para inserir os menus do aplicativo de contêiner em um menu vazio.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parâmetros

*pMenuShared*<br/>
Aponta para um menu vazio.

*lpMenuWidths*<br/>
Aponta para uma matriz de seis valores LONG indicando quantos menus estão em cada um dos seguintes grupos de menus: Arquivo, Editar, Contêiner, Objeto, Janela, Ajuda. A aplicação do contêiner é responsável pelos grupos de menu Arquivo, Contêiner e Janela, correspondentes aos elementos 0, 2 e 4 desta matriz.

### <a name="remarks"></a>Comentários

Esse menu é então passado para o servidor, que insere seus próprios menus, criando um menu composto. Esta função pode ser chamada repetidamente para construir vários menus compostos.

A implementação padrão é inserida no *pMenuShared* os menus de contêiner no local; ou seja, os grupos de menu Arquivo, Contêiner e Janela. [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) é usado para definir esse recurso de menu. A implementação padrão também atribui os valores apropriados aos elementos 0, 2 e 4 em *lpMenuWidths*, dependendo do recurso do menu. Anular essa função se a implementação padrão não for apropriada para o seu aplicativo; por exemplo, se o aplicativo não usar modelos de documentos para associar recursos com tipos de documentos. Se você substituir essa função, você também deve substituir [Menus](#onsetmenu) de entrada e [menus onRemove](#onremovemenus). Este é um avançado super-rididável.

Para obter mais informações, consulte [IOleInPlaceFrame::InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) no Windows SDK.

## <a name="coleclientitemonremovemenus"></a><a name="onremovemenus"></a>COleClientItem::OnRemoveMenus

Chamado pela estrutura para remover os menus do contêiner do menu composto especificado quando a ativação no local terminar.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parâmetros

*pMenuShared*<br/>
Aponta para o menu composto construído por chamadas para a função membro [OnInsertMenus.](#oninsertmenus)

### <a name="remarks"></a>Comentários

A implementação padrão remove do *pMenuShared* os menus de contêiner no local, ou seja, os grupos de menus Arquivo, Contêiner e Janela. Anular essa função se a implementação padrão não for apropriada para o seu aplicativo; por exemplo, se o aplicativo não usar modelos de documentos para associar recursos com tipos de documentos. Se você substituir essa função, você provavelmente deve substituir [OnInsertMenus](#oninsertmenus) e [OnSetMenu](#onsetmenu) também. Este é um avançado super-rididável.

Os submenus no *pMenuShared* podem ser compartilhados por mais de `OnInsertMenus`um menu composto se o servidor tiver chamado repetidamente . Portanto, você não deve excluir quaisquer submenus em sua substituição de `OnRemoveMenus`; você só deve desacoplá-los.

Para obter mais informações, consulte [IOleInPlaceFrame::RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) no Windows SDK.

## <a name="coleclientitemonscrollby"></a><a name="onscrollby"></a>COleClientItem::OnScrollBy

Chamado pela estrutura para rolar o item OLE em resposta às solicitações do servidor.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parâmetros

*tamanhoExtensão*<br/>
Especifica as distâncias, em pixels, para rolar nas direções x e y.

### <a name="return-value"></a>Valor retornado

Não zero se o item foi rolado; 0 se o item não pudesse ser rolado.

### <a name="remarks"></a>Comentários

Por exemplo, se o item OLE estiver parcialmente visível e o usuário se mover para fora da região visível durante a execução da edição no local, essa função será chamada para manter o cursor visível. A implementação padrão não faz nada. Substituir esta função para rolar o item pela quantidade especificada. Observe que, como resultado da rolagem, a parte visível do item OLE pode mudar. Ligue [para SetItemRects](#setitemrects) para atualizar o retângulo visível do item.

Para obter mais informações, consulte [IOleInPlaceSite::Role](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) no SDK do Windows.

## <a name="coleclientitemonsetmenu"></a><a name="onsetmenu"></a>COleClientItem::Menu de início

Chamado pelo quadro duas vezes quando a ativação no local começa e termina; a primeira vez para instalar o menu composto e a segunda vez (com *menu de furo* igual a NULL) para removê-lo.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parâmetros

*pMenuShared*<br/>
Ponteiro para o menu composto construído por chamadas para a `InsertMenu` função membro [OnInsertMenus](#oninsertmenus) e a função.

*menu buraco*<br/>
Manuseie o descritor do `OleCreateMenuDescriptor` menu retornado pela função ou NULL se o código de expedição for removido.

*hwndActiveObject*<br/>
Manuseie a janela de edição do item OLE. Esta é a janela que receberá comandos de edição do OLE.

### <a name="remarks"></a>Comentários

A implementação padrão instala ou remove o menu composto e, em seguida, chama a função [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) para instalar ou remover o código de expedição. Anular essa função se a implementação padrão não for apropriada para o seu aplicativo. Se você substituir essa função, você provavelmente deve substituir [OnInsertMenus](#oninsertmenus) e [OnRemoveMenus](#onremovemenus) também. Este é um avançado super-rididável.

Para obter mais informações, consulte [OleCreateMenuDescriptor,](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor) [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)e [IOleInPlaceFrame::SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) no Windows SDK.

## <a name="coleclientitemonshowcontrolbars"></a><a name="onshowcontrolbars"></a>COleClientItem::OnShowControlBars

Chamado pela estrutura para mostrar e ocultar as barras de controle do aplicativo de contêiner.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parâmetros

*pFrameWnd*<br/>
Ponteiro para a janela de quadro do aplicativo do contêiner. Isso pode ser uma janela de quadro principal ou uma janela de criança MDI.

*Bshow*<br/>
Especifica se as barras de controle devem ser mostradas ou ocultas.

### <a name="return-value"></a>Valor retornado

Não zero se a chamada de função causar uma alteração no estado das barras de controle; 0 se a chamada não causar alteração ou se *pFrameWnd* não apontar para a janela do quadro do contêiner.

### <a name="remarks"></a>Comentários

Esta função retorna 0 se as barras de controle já estiverem no estado especificado pelo *bShow.* Isso ocorreria, por exemplo, se as barras de controle estiverem ocultas e *o bShow* for FALSO.

A implementação padrão remove a barra de ferramentas da janela de quadro de nível superior.

## <a name="coleclientitemonshowitem"></a><a name="onshowitem"></a>COleClientItem::OnShowItem

Chamado pela estrutura para exibir o item OLE, tornando-o totalmente visível durante a edição.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Comentários

Ele é usado quando o aplicativo de contêiner suporta links para itens incorporados (isto é, se você tiver derivado sua classe de documentos do [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Essa função é chamada durante a ativação no local ou quando o item OLE é uma fonte de link e o usuário deseja editá-la. A implementação padrão ativa a primeira visualização no documento do contêiner. Anular esta função para rolar o documento para que o item OLE seja visível.

## <a name="coleclientitemonupdateframetitle"></a><a name="onupdateframetitle"></a>COleClientItem::OnUpdateFrameTitle

Chamado pelo framework durante a ativação no local para atualizar a barra de título da janela do quadro.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Valor retornado

Não zero se esta função atualizou com sucesso o título do quadro, caso contrário, zero.

### <a name="remarks"></a>Comentários

A implementação padrão não altera o título da janela de quadro. Anular esta função se você quiser um título de quadro diferente para o seu aplicativo, por exemplo , "*item do* *aplicativo* - do servidor em *docname*" (como em, "Microsoft Excel - planilha em RELATÓRIO. DOC"). Este é um avançado super-rididável.

## <a name="coleclientitemreactivateandundo"></a><a name="reactivateandundo"></a>COleClientItem::ReativarAndUndo

Chame esta função para reativar o item OLE e desfazer a última operação realizada pelo usuário durante a edição no local.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Se o aplicativo de contêiner suportar o comando desfazer, chame esta função se o usuário escolher o comando desfazer imediatamente após desativar o item OLE.

Se o aplicativo do servidor estiver escrito com as Bibliotecas de Classe da Microsoft Foundation, essa função fará com que o servidor ligue para [coleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Para obter mais informações, consulte [IOleInPlaceObject::ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) no Windows SDK.

## <a name="coleclientitemrelease"></a><a name="release"></a>COleClientItem::Lançamento

Chame esta função para limpar os recursos usados pelo item OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parâmetros

*dwCloseOption*<br/>
Sinalizador especificando em que circunstâncias o item OLE é salvo quando ele retorna ao estado carregado. Para obter uma lista de valores possíveis, consulte [COleClientItem::Close](#close).

### <a name="remarks"></a>Comentários

`Release`é chamado `COleClientItem` pelo destruidor.

Para obter mais informações, consulte [IUnknown::Lançamento](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) no Windows SDK.

## <a name="coleclientitemreload"></a><a name="reload"></a>COleClientItem::Recarregar

Fecha e recarrega o item.

```
BOOL Reload();
```

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Ligue `Reload` a função depois de ativar o item como um item de outro tipo por uma chamada para [ActivateAs](#activateas).

## <a name="coleclientitemrun"></a><a name="run"></a>COleClientItem::Executar

Executa o aplicativo associado a este item.

```
void Run();
```

### <a name="remarks"></a>Comentários

Ligue `Run` para a função de membro para iniciar o aplicativo do servidor antes de ativar o item. Isso é feito automaticamente por [Ativar](#activate) e [DoVerb,](#doverb)por isso geralmente não é necessário chamar essa função. Chame esta função se for necessário executar o servidor para definir um atributo de item, como [SetExtent](#setextent), antes de executar [o DoVerb](#doverb).

## <a name="coleclientitemsetdrawaspect"></a><a name="setdrawaspect"></a>COleClientItem::SetDrawAspect

Chame `SetDrawAspect` a função de membro para definir o "aspecto", ou exibição, do item.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parâmetros

*Ndrawaspect*<br/>
Um valor da enumeração DVASPECT. Esse parâmetro pode ter um dos seguintes valores:

- DVASPECT_CONTENT Item é representado de tal forma que pode ser exibido como um objeto incorporado dentro de seu recipiente.

- DVASPECT_THUMBNAIL Item é renderizado em uma representação "miniatura" para que possa ser exibido em uma ferramenta de navegação.

- DVASPECT_ICON Item é representado por um ícone.

- DVASPECT_DOCPRINT Item é representado como se fosse impresso usando o comando Imprimir no menu Arquivo.

### <a name="remarks"></a>Comentários

O aspecto especifica como o item deve ser renderizado por [Draw](#draw) quando o valor padrão para o argumento *nDrawAspect* dessa função é usado.

Essa função é chamada automaticamente pelo Ícone de Alteração (e outros diálogos que chamam diretamente a caixa de diálogo Ícone de alteração) para ativar o aspecto de exibição icônico quando solicitado pelo usuário.

## <a name="coleclientitemsetextent"></a><a name="setextent"></a>COleClientItem::SetExtent

Ligue para esta função para especificar quanto espaço está disponível para o item OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parâmetros

*Tamanho*<br/>
Um objeto [CSize](../../atl-mfc-shared/reference/csize-class.md) que contém as informações de tamanho.

*Ndrawaspect*<br/>
Especifica o aspecto do item OLE cujos limites devem ser definidos. Para obter valores possíveis, consulte [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Comentários

Se o aplicativo do servidor foi escrito usando a Biblioteca de Classes `COleServerItem` da Microsoft Foundation, isso fará com que a função membro [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) do objeto correspondente seja chamada. O item OLE pode então ajustar seu display de acordo. As dimensões devem estar em MM_HIMETRIC unidades. Chame esta função quando o usuário redimensionar o item OLE ou se você suportar alguma forma de negociação de layout.

Para obter mais informações, consulte [IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) no Windows SDK.

## <a name="coleclientitemsethostnames"></a><a name="sethostnames"></a>COleClientItem::SetHostNames

Chame esta função para especificar o nome do aplicativo do contêiner e o nome do contêiner para um item OLE incorporado.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parâmetros

*lpszHost*<br/>
Ponteiro para o nome visível do usuário do aplicativo do contêiner.

*lpszHostObj*<br/>
Ponteiro para uma seqüência de identificação do recipiente que contém o item OLE.

### <a name="remarks"></a>Comentários

Se o aplicativo do servidor foi escrito usando a Biblioteca de Classes da `COleServerDoc` Microsoft Foundation, essa função chamará a função de membro [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) do documento que contém o item OLE. Essas informações são usadas em títulos de janela quando o item OLE está sendo editado. Cada vez que um documento de contêiner é carregado, o framework chama essa função para todos os itens OLE no documento. `SetHostNames`é aplicável apenas a itens incorporados. Não é necessário chamar essa função cada vez que um item OLE incorporado é ativado para edição.

Isso também é chamado automaticamente com o nome do aplicativo e o nome do documento quando um objeto é carregado ou quando um arquivo é salvo sob um nome diferente. Assim, normalmente não é necessário chamar essa função diretamente.

Para obter mais informações, consulte [IOleObject::SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) no Windows SDK.

## <a name="coleclientitemseticonicmetafile"></a><a name="seticonicmetafile"></a>COleClientItem::SetIconicMetafile

Armazena o metaarquivo usado para desenhar o ícone do item.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parâmetros

*hMetaPict*<br/>
Uma alça para o metaarquivo usado para desenhar o ícone do item.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Use [GetIconicMetafile](#geticonicmetafile) para recuperar o metaarquivo.

O parâmetro *hMetaPict* é copiado para o item; portanto, *hMetaPict* deve ser liberado pelo chamador.

## <a name="coleclientitemsetitemrects"></a><a name="setitemrects"></a>COleClientItem::SetItemRects

Chame esta função para definir o retângulo delimitador ou o retângulo visível do item OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parâmetros

*lprcPosRect*<br/>
Ponteiro para o retângulo contendo os limites do item OLE em relação à sua janela pai, nas coordenadas do cliente.

*lprcClipRect*<br/>
Ponteiro para o retângulo contendo os limites da parte visível do item OLE em relação à sua janela pai, em coordenadas do cliente.

### <a name="return-value"></a>Valor retornado

Não zero se bem sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Essa função é chamada pela implementação padrão da função membro [OnChangeItemPosition.](#onchangeitemposition) Você deve chamar esta função sempre que a posição ou parte visível do item OLE for alterado. Normalmente, isso significa que você o chama das funções de membro [OnSize](../../mfc/reference/cwnd-class.md#onsize) e [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) da sua exibição.

Para obter mais informações, consulte [IOleInPlaceObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) no Windows SDK.

## <a name="coleclientitemsetlinkupdateoptions"></a><a name="setlinkupdateoptions"></a>COleClientItem::SetLinkUpdateOptions

Chame esta função para definir a opção de atualização de link para a apresentação do item vinculado especificado.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parâmetros

*dwUpdateOpt*<br/>
O valor da opção de atualização de link para este item. Este valor deve ser um dos seguintes:

- OLEUPDATE_ALWAYS atualize o item vinculado sempre que possível. Esta opção suporta o botão de rádio de atualização automática de link na caixa de diálogo Links.

- OLEUPDATE_ONCALL Atualize o item vinculado somente a pedido do aplicativo de contêiner (quando a função membro [UpdateLink](#updatelink) for chamada). Esta opção suporta o botão de rádio manual de atualização de link na caixa de diálogo Links.

### <a name="remarks"></a>Comentários

Normalmente, você não deve alterar as opções de atualização escolhidas pelo usuário na caixa de diálogo Links.

Para obter mais informações, consulte [IOleLink::SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) no Windows SDK.

## <a name="coleclientitemsetprintdevice"></a><a name="setprintdevice"></a>COleClientItem::SetPrintDevice

Chame esta função para alterar o dispositivo de destino de impressão para este item.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parâmetros

*Ptd*<br/>
Ponteiro para uma estrutura de dados [DVTARGETDEVICE,](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) que contém informações sobre o novo dispositivo de destino de impressão. Pode ser NULL.

*Ppd*<br/>
Ponteiro para uma estrutura de dados [PRINTDLG,](/windows/win32/api/commdlg/ns-commdlg-printdlga) que contém informações sobre o novo dispositivo de destino de impressão. Pode ser NULL.

### <a name="return-value"></a>Valor retornado

Não zero se a função foi bem sucedida; caso contrário, 0.

### <a name="remarks"></a>Comentários

Esta função atualiza o dispositivo de destino de impressão para o item, mas não atualiza o cache de apresentação. Para atualizar o cache de apresentação de um item, ligue para [UpdateLink](#updatelink).

Os argumentos para esta função contêm informações que o sistema OLE usa para identificar o dispositivo de destino. A `PRINTDLG` estrutura contém informações que o Windows usa para inicializar a caixa de diálogo Imprimir comum. Depois que o usuário fecha a caixa de diálogo, o Windows retorna informações sobre as seleções do usuário nesta estrutura. O `m_pd` membro de um objeto `PRINTDLG` [CPrintDialog](../../mfc/reference/cprintdialog-class.md) é uma estrutura.

Para obter mais informações sobre essa estrutura, consulte [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) no Windows SDK.

Para obter mais informações, consulte [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) no Windows SDK.

## <a name="coleclientitemupdatelink"></a><a name="updatelink"></a>COleClientItem::UpdateLink

Chame esta função para atualizar os dados de apresentação do item OLE imediatamente.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Valor retornado

Não zero no sucesso; caso contrário, 0.

### <a name="remarks"></a>Comentários

Para itens vinculados, a função encontra a fonte de link para obter uma nova apresentação para o item OLE. Esse processo pode envolver a execução de um ou mais aplicativos de servidor, o que pode ser demorado. Para itens incorporados, a função funciona de forma recursiva, verificando se o item incorporado contém links que podem estar desatualizados e atualizá-los. O usuário também pode atualizar manualmente links individuais usando a caixa de diálogo Links.

Para obter mais informações, consulte [IOleLink::Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) no Windows SDK.

## <a name="see-also"></a>Confira também

[MFC Amostra MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[MFC Amostra OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[Classe CDocItem](../../mfc/reference/cdocitem-class.md)<br/>
[Gráfico da hierarquia](../../mfc/hierarchy-chart.md)<br/>
[Classe COleServerItem](../../mfc/reference/coleserveritem-class.md)
